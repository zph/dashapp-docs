<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
  <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css"/><a class="dashingAutolink" name="autolink-52"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Replica%20Set%20Considerations%20and%20Behaviors%20for%20Applications%20and%20Development%20%E2%80%94%20MongoDB%20Manual"></a><title>Replica Set Considerations and Behaviors for Applications and Development &mdash; MongoDB Manual</title><link rel="shortcut icon" href="https://www.mongodb.com/docs/assets/favicon.ico"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
      <link rel="canonical" href="https://www.mongodb.com/docs/manual/applications/replication/"/><meta name="robots" content="index"/>
  <meta name="release" content="2.2.7"/>
  <meta name="version" content="2.2"/>
  <meta name="DC.Source" content="https://github.com/mongodb/docs/blob/v2.2/source/applications/replication.txt"/>
  <meta property="og:image" content="http://s3.amazonaws.com/info-mongodb-com/_com_assets/cms/mongodb-for-giant-ideas-bbab5c3cf8.png"/>
  <meta property="og:image:secure_url" content="https://webassets.mongodb.com/_com_assets/cms/mongodb-for-giant-ideas-bbab5c3cf8.png"/>
  
   <link rel="stylesheet" href="../_static/mongodb-docs.css" type="text/css"/>
   <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
   <link rel="stylesheet" href="../_static/css/navbar.min.css?t=nocache" type="text/css"/>
    
    <script type="text/javascript" src="../_static/lib/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/lib/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/controller.js"></script>
      <link rel="search" type="application/opensearchdescription+xml" href="https://www.mongodb.com/docs/osd.xml" title="MongoDB Help"/>
<link rel="author" title="About these documents" href="../about.html"/>
<!-- <link rel="index" title="Index" href="../genindex.html" /> -->
<link rel="search" title="Search" href="../search.html"/>
<link rel="top" title="MongoDB Manual" href="../index.html"/>
<link rel="up" title="Replication" href="../replication.html"/>
<link rel="next" title="Replica Set Internals and Behaviors" href="../core/replication-internals.html"/>
<link rel="prev" title="Replica Set Architectures and Deployment Patterns" href="../administration/replica-set-architectures.html"/><script type="text/javascript">
   var gptadslots=[];
   var googletag = googletag || {};
   googletag.cmd = googletag.cmd || [];
   (function(){ var gads = document.createElement('script');
      gads.async = true; gads.type = 'text/javascript';
      var useSSL = 'https:' == document.location.protocol;
      gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
      var node = document.getElementsByTagName('script')[0];
      node.parentNode.insertBefore(gads, node);
   })();
</script>

<script type="text/javascript">
   googletag.cmd.push(function() {

      var pathname = location.href;
      
      if ( (pathname.indexOf("auth") >= 0) || (pathname.indexOf("security") >= 0) ) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/security', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if ( (pathname.indexOf("crud") >= 0) ||  (pathname.indexOf("query") >= 0) || (pathname.indexOf("insert") >= 0) || (pathname.indexOf("update") >= 0) || (pathname.indexOf("remove") >= 0) || (pathname.indexOf("delete") >= 0) || (pathname.indexOf("aggregation") >= 0) ) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/crud', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("shard") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/sharding', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("replica") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/replication', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("model") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/data-modeling', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("administration") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/support', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("install-mongodb-on-windows") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/install-mongodb-on-windows', [160, 600], 'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("tutorial/getting-started") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/docs_server_gettingstarted', [160, 600], 'mongodb-docs-1').addService(googletag.pubads());
      } else {
         //Adslot 1 declaration
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      }
      googletag.pubads().enableSingleRequest();
      googletag.pubads().enableAsyncRendering();
      googletag.enableServices();
   });
</script></head>
<body data-project="manual" data-project-title="MongoDB Manual" data-branch="v2.2" data-enable-marian="1" data-eol="True">
  <!-- Google Tag Manager -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-GDFN"
                    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
  {'gtm.start':new Date().getTime(),event:'gtm.js'}
  );var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-GDFN');
  </script>
  <!-- End Google Tag Manager -->
      <script>
        window.googleSearchCx = "017213726194841070573:WMX6838984"
	window.googleSearchPlaceholder = "Search Documentation"
        window.googleSearchResultsUrl = "https://www.mongodb.com/docs/manual/search/"
      </script><div class="content" style="margin-top: 0;">

   <div id="left-column">
         <aside id="sidebar" class="sidebar">
             
  <div class="sphinxsidebar" id="sphinxsidebar">
    <div id="sphinxsidebarwrapper" class="sphinxsidebarwrapper"><a href="javascript:void(0)" class="closeNav" id="closeNav">Close &times;</a>


<h3>
  <a class="index-link" href="../index.html">MongoDB Manual</a>
</h3>


    <div class="btn-group version-sidebar">
      
        <button type="button" class="version-button dropdown-toggle" data-toggle="dropdown" disabled="" aria-disabled="disabled">
          
          
          Version 2.2
        </button>
        <a href="https://www.mongodb.com/docs/legacy">&larr; Return to Documentation</a>
      
    </div>


<ul class="current"><li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing MongoDB</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-red-hat-centos-or-fedora-linux.html">Install MongoDB on Red Hat Enterprise, CentOS, or Fedora</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-ubuntu.html">Install MongoDB on Ubuntu</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-debian.html">Install MongoDB on Debian</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-linux.html">Install MongoDB on Linux Systems</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-os-x.html">Install MongoDB on OS X</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-windows.html">Install MongoDB on Windows</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/getting-started.html">Getting Started with MongoDB Development</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a><ul><li class="toctree-l2"><a class="reference internal" href="../administration/configuration.html">Run-time Database Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/operational-segregation.html">Operational Segregation in MongoDB Operations and Deployments</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/journaling.html">Journaling</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/ssl.html">Use MongoDB with SSL Connections</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/snmp.html">Use MongoDB with SNMP Monitoring</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/monitoring.html">Monitoring Database Systems</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/import-export.html">Importing and Exporting MongoDB Data</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/backups.html">Backup Strategies for MongoDB Systems</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/ulimit.html">UNIX <code class="docutils literal"><span class="pre">ulimit</span></code> Settings</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/production-notes.html">Production Notes</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a><ul><li class="toctree-l2"><a class="reference internal" href="../administration/security.html">Security Practices and Management</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/vulnerability-notification.html">Vulnerability Notification</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-linux-iptables-firewall.html">Configure Linux <code class="docutils literal"><span class="pre">iptables</span></code> Firewall for MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-windows-netsh-firewall.html">Configure Windows <code class="docutils literal"><span class="pre">netsh</span></code> Firewall for MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/control-access-to-mongodb-with-authentication.html">Control Access to MongoDB Instances with Authentication</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../crud.html">Core MongoDB Operations (CRUD)</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/read-operations.html">Read Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../core/write-operations.html">Write Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../core/data-modeling.html">Data Modeling Considerations for MongoDB Applications</a></li><li class="toctree-l2"><a class="reference internal" href="../core/document.html">BSON Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../core/object-id.html">ObjectId</a></li><li class="toctree-l2"><a class="reference internal" href="database-references.html">Database References</a></li><li class="toctree-l2"><a class="reference internal" href="gridfs.html">GridFS</a></li><li class="toctree-l2"><a class="reference internal" href="create.html">Create</a></li><li class="toctree-l2"><a class="reference internal" href="read.html">Read</a></li><li class="toctree-l2"><a class="reference internal" href="update.html">Update</a></li><li class="toctree-l2"><a class="reference internal" href="delete.html">Delete</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-embedded-one-to-one-relationships-between-documents.html">Model Embedded One-to-One Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-embedded-one-to-many-relationships-between-documents.html">Model Embedded One-to-Many Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-referenced-one-to-many-relationships-between-documents.html">Model Referenced One-to-Many Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-data-for-atomic-operations.html">Model Data for Atomic Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-parent-references.html">Model Tree Structures with Parent References</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-child-references.html">Model Tree Structures with Child References</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-ancestors-array.html">Model Tree Structures with an Array of Ancestors</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-materialized-paths.html">Model Tree Structures with Materialized Paths</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-nested-sets.html">Model Tree Structures with Nested Sets</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-data-for-keyword-search.html">Model Data to Support Keyword Search</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../aggregation.html">Aggregation</a><ul><li class="toctree-l2"><a class="reference internal" href="aggregation.html">Aggregation Framework</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/aggregation-examples.html">Aggregation Framework Examples</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/aggregation.html">Aggregation Framework Reference</a></li><li class="toctree-l2"><a class="reference internal" href="map-reduce.html">Map-Reduce</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/simple-aggregation.html">Simple Aggregation Methods and Commands</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../indexes.html">Indexes</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/indexes.html">Indexing Overview</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/indexes.html">Indexing Operations</a></li><li class="toctree-l2"><a class="reference internal" href="indexes.html">Indexing Strategies</a></li><li class="toctree-l2"><a class="reference internal" href="geospatial-indexes.html">Geospatial Queries with <code class="docutils literal"><span class="pre">2d</span></code> Indexes</a></li><li class="toctree-l2"><a class="reference internal" href="../core/geospatial-indexes.html"><code class="docutils literal"><span class="pre">2d</span></code> Geospatial Indexes</a></li></ul></li><li class="toctree-l1 current"><a class="reference internal" href="../replication.html">Replication</a><ul class="current"><li class="toctree-l2"><a class="reference internal" href="../core/replication.html">Replica Set Fundamental Concepts</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/replica-sets.html">Replica Set Operation and Management</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/replica-set-architectures.html">Replica Set Architectures and Deployment Patterns</a></li><li class="toctree-l2 current"><a class="reference internal current" href="">Replica Set Considerations and Behaviors for Applications and Development</a></li><li class="toctree-l2"><a class="reference internal" href="../core/replication-internals.html">Replica Set Internals and Behaviors</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/master-slave.html">Master Slave Replication</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-replica-set.html">Deploy a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-standalone-to-replica-set.html">Convert a Standalone to a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/expand-replica-set.html">Add Members to a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-geographically-distributed-replica-set.html">Deploy a Geographically Distributed Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/change-oplog-size.html">Change the Size of the Oplog</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/force-member-to-be-primary.html">Force a Member to Become Primary</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/change-hostnames-in-a-replica-set.html">Change Hostnames in a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-secondary-into-arbiter.html">Convert a Secondary to an Arbiter</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/reconfigure-replica-set-with-unavailable-members.html">Reconfigure a Replica Set with Unavailable Members</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/recover-data-following-unexpected-shutdown.html">Recover MongoDB Data following Unexpected Shutdown</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replica-commands.html">Replica Set Commands</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/replica-set-features.html">Replica Set Features and Version Compatibility</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../sharding.html">Sharding</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/sharded-clusters.html">Sharded Cluster Overview</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/sharded-clusters.html">Sharded Cluster Administration</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/sharded-cluster-architectures.html">Sharded Cluster Architectures</a></li><li class="toctree-l2"><a class="reference internal" href="../core/sharded-cluster-internals.html">Sharded Cluster Internals and Behaviors</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-shard-cluster.html">Deploy a Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/add-shards-to-shard-cluster.html">Add Shards to a Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/view-sharded-cluster-configuration.html">View Cluster Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-sharded-cluster-config-server.html">Manage the Config Servers</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-chunks-in-sharded-cluster.html">Manage Chunks in a Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-sharded-cluster-balancer.html">Configure Behavior of Balancer Process in Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-sharded-cluster-balancer.html">Manage Sharded Cluster Balancer</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/remove-shards-from-cluster.html">Remove Shards from an Existing Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-small-sharded-cluster-with-mongodump.html">Backup a Small Sharded Cluster with <code class="docutils literal"><span class="pre">mongodump</span></code></a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-sharded-cluster-with-filesystem-snapshots.html">Create Backup of a Sharded Cluster with Filesystem Snapshots</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-sharded-cluster-with-database-dumps.html">Create Backup of a Sharded Cluster with Database Dumps</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/restore-single-shard.html">Restore a Single Shard</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/restore-sharded-cluster.html">Restore Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/schedule-backup-window-for-sharded-clusters.html">Schedule Backup Window for Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/tag-aware-sharding.html">Tag Aware Sharding</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/enforce-unique-keys-for-sharded-collections.html">Enforce Unique Keys for Sharded Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-replica-set-to-replicated-shard-cluster.html">Convert a Replica Set to a Replicated Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/sharding-commands.html">Sharding Commands</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../applications.html">Application Development</a><ul><li class="toctree-l2"><a class="reference internal" href="drivers.html">MongoDB Drivers and Client Libraries</a></li><li class="toctree-l2"><a class="reference internal" href="optimization.html">Optimization Strategies for MongoDB Applications</a></li><li class="toctree-l2"><a class="reference internal" href="server-side-javascript.html">Server-side JavaScript</a></li><li class="toctree-l2"><a class="reference internal" href="../core/capped-collections.html">Capped Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/perform-two-phase-commits.html">Perform Two Phase Commits</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/create-tailable-cursor.html">Create Tailable Cursor</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/isolate-sequence-of-operations.html">Isolate Sequence of Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/create-an-auto-incrementing-field.html">Create an Auto-Incrementing Sequence Field</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/expire-data.html">Expire Data from Collections by Setting TTL</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../mongo.html">Using the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/getting-started-with-the-mongo-shell.html">Getting Started with the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../core/shell-types.html">Data Types in the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/access-mongo-shell-help.html">Access the <code class="docutils literal"><span class="pre">mongo</span></code> Shell Help Information</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/write-scripts-for-the-mongo-shell.html">Write Scripts for the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/mongo-shell.html"><code class="docutils literal"><span class="pre">mongo</span></code> Shell Quick Reference</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../tutorial.html">MongoDB Tutorials</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/use-database-commands.html">Use Database Commands</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/recover-data-following-unexpected-shutdown.html">Recover MongoDB Data following Unexpected Shutdown</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-mongodb-processes.html">Manage <code class="docutils literal"><span class="pre">mongod</span></code> Processes</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-replica-set-to-replicated-shard-cluster.html">Convert a Replica Set to a Replicated Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/copy-databases-between-instances.html">Copy Databases Between Instances</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-databases-with-binary-database-dumps.html">Use <code class="docutils literal"><span class="pre">mongodump</span></code> and <code class="docutils literal"><span class="pre">mongorestore</span></code> to Backup and Restore MongoDB Databases</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-databases-with-filesystem-snapshots.html">Use Filesystem Snapshots to Backup and Restore MongoDB Databases</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-the-database-profiler.html">Analyze Performance of Database Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/rotate-log-files.html">Rotate Log Files</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/roll-back-to-v1.8-index.html">Build Old Style Indexes</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a><ul><li class="toctree-l2"><a class="reference internal" href="../faq/fundamentals.html">FAQ: MongoDB Fundamentals</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/developers.html">FAQ: MongoDB for Application Developers</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/mongo.html">FAQ: The <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/concurrency.html">FAQ: Concurrency</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/sharding.html">FAQ: Sharding with MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/replica-sets.html">FAQ: Replica Sets and Replication in MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/storage.html">FAQ: MongoDB Storage</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/indexes.html">FAQ: Indexes</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/diagnostics.html">FAQ: MongoDB Diagnostics</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a><ul><li class="toctree-l2"><a class="reference internal" href="../reference/operator.html">Query, Update, Projection, and Aggregation Operators</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/all.html">$all</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/and.html">$and</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/box.html">$box</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/center.html">$center</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/centerSphere.html">$centerSphere</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/elemMatch.html">$elemMatch (query)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/exists.html">$exists</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/gt.html">$gt</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/gte.html">$gte</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/in.html">$in</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/lt.html">$lt</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/lte.html">$lte</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/maxDistance.html">$maxDistance</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/mod.html">$mod</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/ne.html">$ne</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/near.html">$near</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/nearSphere.html">$nearSphere</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/nin.html">$nin</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/nor.html">$nor</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/not.html">$not</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/or.html">$or</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/polygon.html">$polygon</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/regex.html">$regex</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/size.html">$size</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/type.html">$type</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/uniqueDocs.html">$uniqueDocs</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/where.html">$where</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/within.html">$within</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/addToSet.html">$addToSet</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/bit.html">$bit</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/each.html">$each</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/inc.html">$inc</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/isolated.html">$isolated</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pop.html">$pop</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/positional.html">$ (update)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pull.html">$pull</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pullAll.html">$pullAll</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/push.html">$push</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pushAll.html">$pushAll</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/rename.html">$rename</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/set.html">$set</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/unset.html">$unset</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/projection/elemMatch.html">$elemMatch (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/projection/positional.html">$ (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/projection/slice.html">$slice (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/comment.html">$comment</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/explain.html">$explain</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/hint.html">$hint</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/max.html">$max</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/maxScan.html">$maxScan</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/min.html">$min</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/natural.html">$natural</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/orderby.html">$orderby</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/query.html">$query</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/returnKey.html">$returnKey</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/showDiskLoc.html">$showDiskLoc</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/snapshot.html">$snapshot</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/add.html">$add (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/addToSet.html">$addToSet (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/and.html">$and (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/avg.html">$avg (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/cmp.html">$cmp (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/cond.html">$cond (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/dayOfMonth.html">$dayOfMonth (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/dayOfWeek.html">$dayOfWeek (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/dayOfYear.html">$dayOfYear (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/divide.html">$divide (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/eq.html">$eq (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/first.html">$first (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/group.html">$group (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/gt.html">$gt (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/gte.html">$gte (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/hour.html">$hour (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/ifNull.html">$ifNull (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/last.html">$last (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/limit.html">$limit (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/lt.html">$lt (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/lte.html">$lte (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/match.html">$match (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/max.html">$max (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/min.html">$min (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/minute.html">$minute (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/mod.html">$mod (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/month.html">$month (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/multiply.html">$multiply (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/ne.html">$ne (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/not.html">$not (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/or.html">$or (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/project.html">$project (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/push.html">$push (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/second.html">$second (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/skip.html">$skip (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/sort.html">$sort (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/strcasecmp.html">$strcasecmp (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/substr.html">$substr (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/subtract.html">$subtract (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/sum.html">$sum (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/toLower.html">$toLower (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/toUpper.html">$toUpper (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/unwind.html">$unwind (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/week.html">$week (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/year.html">$year (aggregation)</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/command.html">Database Commands</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/command/addShard.html">addShard</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/aggregate.html">aggregate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/applyOps.html">applyOps (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/authenticate.html">authenticate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/availableQueryOptions.html">availableQueryOptions (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/buildInfo.html">buildInfo</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/checkShardingIndex.html">checkShardingIndex (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/clean.html">clean (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/clone.html">clone</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/cloneCollection.html">cloneCollection</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/cloneCollectionAsCapped.html">cloneCollectionAsCapped</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/closeAllDatabases.html">closeAllDatabases (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/collMod.html">collMod</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/collStats.html">collStats</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/compact.html">compact</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/connPoolStats.html">connPoolStats</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/connPoolSync.html">connPoolSync (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/convertToCapped.html">convertToCapped</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/copydb.html">copydb</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/copydbgetnonce.html">copydbgetnonce (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/count.html">count</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/create.html">create</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/cursorInfo.html">cursorInfo</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dataSize.html">dataSize</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dbHash.html">dbHash (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dbStats.html">dbStats</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/diagLogging.html">diagLogging (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/distinct.html">distinct</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/driverOIDTest.html">driverOIDTest (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/drop.html">drop</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dropDatabase.html">dropDatabase</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dropIndexes.html">dropIndexes</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/enableSharding.html">enableSharding</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/eval.html">eval</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/features.html">features (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/filemd5.html">filemd5</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/findAndModify.html">findAndModify</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/flushRouterConfig.html">flushRouterConfig</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/fsync.html">fsync</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/geoNear.html">geoNear</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/geoSearch.html">geoSearch</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/geoWalk.html">geoWalk</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getCmdLineOpts.html">getCmdLineOpts</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getLastError.html">getLastError</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getLog.html">getLog</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getParameter.html">getParameter</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getPrevError.html">getPrevError</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getShardMap.html">getShardMap (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getShardVersion.html">getShardVersion (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getnonce.html">getnonce (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getoptime.html">getoptime (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/group.html">group</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/isMaster.html">isMaster</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/isSelf.html">isSelf (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/isdbgrid.html">isdbgrid</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/listCommands.html">listCommands</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/listDatabases.html">listDatabases</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/listShards.html">listShards</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/logRotate.html">logRotate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/logout.html">logout</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/mapReduce.html">mapReduce</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/medianKey.html">medianKey (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/moveChunk.html">moveChunk</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/movePrimary.html">movePrimary</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/netstat.html">netstat (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/ping.html">ping</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/profile.html">profile</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/reIndex.html">reIndex</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/removeShard.html">removeShard</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/renameCollection.html">renameCollection</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/repairDatabase.html">repairDatabase</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetFreeze.html">replSetFreeze</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetGetStatus.html">replSetGetStatus</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetInitiate.html">replSetInitiate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetMaintenance.html">replSetMaintenance</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetReconfig.html">replSetReconfig</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetStepDown.html">replSetStepDown</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetSyncFrom.html">replSetSyncFrom</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/resetError.html">resetError</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/resync.html">resync</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/serverStatus.html">serverStatus</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/setParameter.html">setParameter</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/setShardVersion.html">setShardVersion</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/shardCollection.html">shardCollection</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/shardingState.html">shardingState</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/shutdown.html">shutdown</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/split.html">split</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/splitChunk.html">splitChunk</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/splitVector.html">splitVector</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/top.html">top</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/touch.html">touch</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/unsetSharding.html">unsetSharding (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/validate.html">validate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/whatsmyuri.html">whatsmyuri (internal)</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/method.html">JavaScript Methods</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/method/Date.html">Date()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/Mongo.html">Mongo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/Mongo.getDB.html">Mongo.getDB()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ObjectId.getTimestamp.html">ObjectId.getTimestamp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ObjectId.toString.html">ObjectId.toString()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ObjectId.valueOf.html">ObjectId.valueOf()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cat.html">cat()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cd.html">cd()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/connect.html">connect()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/copyDbpath.html">copyDbpath()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.addOption.html">cursor.addOption()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.batchSize.html">cursor.batchSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.count.html">cursor.count()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.explain.html">cursor.explain()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.forEach.html">cursor.forEach()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.hasNext.html">cursor.hasNext()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.hint.html">cursor.hint()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.limit.html">cursor.limit()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.map.html">cursor.map()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.max.html">cursor.max()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.min.html">cursor.min()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.next.html">cursor.next()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.objsLeftInBatch.html">cursor.objsLeftInBatch()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.readPref.html">cursor.readPref()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.showDiskLoc.html">cursor.showDiskLoc()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.size.html">cursor.size()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.skip.html">cursor.skip()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.snapshot.html">cursor.snapshot()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.sort.html">cursor.sort()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.toArray.html">cursor.toArray()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.addUser.html">db.addUser()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.auth.html">db.auth()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.cloneCollection.html">db.cloneCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.cloneDatabase.html">db.cloneDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.aggregate.html">db.collection.aggregate()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.copyTo.html">db.collection.copyTo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.count.html">db.collection.count()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.createIndex.html">db.collection.createIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.dataSize.html">db.collection.dataSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.distinct.html">db.collection.distinct()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.drop.html">db.collection.drop()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.dropIndex.html">db.collection.dropIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.dropIndexes.html">db.collection.dropIndexes()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.ensureIndex.html">db.collection.ensureIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.find.html">db.collection.find()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.findAndModify.html">db.collection.findAndModify()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.findOne.html">db.collection.findOne()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.getIndexes.html">db.collection.getIndexes()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.getShardDistribution.html">db.collection.getShardDistribution()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.getShardVersion.html">db.collection.getShardVersion()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.group.html">db.collection.group()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.insert.html">db.collection.insert()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.isCapped.html">db.collection.isCapped()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.mapReduce.html">db.collection.mapReduce()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.reIndex.html">db.collection.reIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.remove.html">db.collection.remove()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.renameCollection.html">db.collection.renameCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.save.html">db.collection.save()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.stats.html">db.collection.stats()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.storageSize.html">db.collection.storageSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.totalIndexSize.html">db.collection.totalIndexSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.totalSize.html">db.collection.totalSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.update.html">db.collection.update()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.validate.html">db.collection.validate()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.commandHelp.html">db.commandHelp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.copyDatabase.html">db.copyDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.createCollection.html">db.createCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.currentOp.html">db.currentOp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.dropDatabase.html">db.dropDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.eval.html">db.eval()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.fsyncLock.html">db.fsyncLock()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.fsyncUnlock.html">db.fsyncUnlock()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getCollection.html">db.getCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getCollectionNames.html">db.getCollectionNames()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getLastError.html">db.getLastError()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getLastErrorObj.html">db.getLastErrorObj()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getMongo.html">db.getMongo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getName.html">db.getName()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getPrevError.html">db.getPrevError()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getProfilingLevel.html">db.getProfilingLevel()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getProfilingStatus.html">db.getProfilingStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getReplicationInfo.html">db.getReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getSiblingDB.html">db.getSiblingDB()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.help.html">db.help()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.isMaster.html">db.isMaster()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.killOp.html">db.killOp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.listCommands.html">db.listCommands()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.loadServerScripts.html">db.loadServerScripts()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.logout.html">db.logout()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printCollectionStats.html">db.printCollectionStats()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printReplicationInfo.html">db.printReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printShardingStatus.html">db.printShardingStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printSlaveReplicationInfo.html">db.printSlaveReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.removeUser.html">db.removeUser()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.repairDatabase.html">db.repairDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.resetError.html">db.resetError()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.runCommand.html">db.runCommand()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.serverBuildInfo.html">db.serverBuildInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.serverStatus.html">db.serverStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.setProfilingLevel.html">db.setProfilingLevel()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.shutdownServer.html">db.shutdownServer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.stats.html">db.stats()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.version.html">db.version()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/fuzzFile.html">fuzzFile()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/getHostName.html">getHostName()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/getMemInfo.html">getMemInfo</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/hostname.html">hostname()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/isWindows.html">_isWindows()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/listFiles.html">listFiles()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/load.html">load()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ls.html">ls()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/md5sumFile.html">md5sumFile()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/mkdir.html">mkdir()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/pwd.html">pwd()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/quit.html">quit()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rand.html">rand()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/removeFile.html">removeFile()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/resetDbpath.html">resetDbpath()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.add.html">rs.add()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.addArb.html">rs.addArb()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.conf.html">rs.conf()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.freeze.html">rs.freeze()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.help.html">rs.help()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.initiate.html">rs.initiate()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.reconfig.html">rs.reconfig()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.remove.html">rs.remove()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.status.html">rs.status()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.stepDown.html">rs.stepDown()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.syncFrom.html">rs.syncFrom()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.addShard.html">sh.addShard()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.addShardTag.html">sh.addShardTag()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.addTagRange.html">sh.addTagRange()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.disableBalancing.html">sh.disableBalancing()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.enableBalancing.html">sh.enableBalancing()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.enableSharding.html">sh.enableSharding()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.getBalancerHost.html">sh.getBalancerHost()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.getBalancerState.html">sh.getBalancerState()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.help.html">sh.help()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.isBalancerRunning.html">sh.isBalancerRunning()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.moveChunk.html">sh.moveChunk()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.removeShardTag.html">sh.removeShardTag()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.setBalancerState.html">sh.setBalancerState()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.shardCollection.html">sh.shardCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.splitAt.html">sh.splitAt()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.splitFind.html">sh.splitFind()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.startBalancer.html">sh.startBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.status.html">sh.status()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.stopBalancer.html">sh.stopBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.waitForBalancer.html">sh.waitForBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.waitForBalancerOff.html">sh.waitForBalancerOff()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.waitForPingChange.html">sh.waitForPingChange()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/srand.html">_srand()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/version.html">version()</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/sql-comparison.html">SQL to MongoDB Mapping Chart</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/sql-aggregation-comparison.html">SQL to Aggregation Mapping Chart</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/operators.html">Query, Update, and Projection Operators Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/meta-query-operators.html">Meta Query Operator Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/commands.html">Database Commands Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/javascript.html"><code class="docutils literal"><span class="pre">mongo</span></code> Shell JavaScript Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/components.html">MongoDB Package Components</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/mongod.html"><code class="docutils literal"><span class="pre">mongod</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongos.html"><code class="docutils literal"><span class="pre">mongos</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongo.html"><code class="docutils literal"><span class="pre">mongo</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongod.exe.html"><code class="docutils literal"><span class="pre">mongod.exe</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongos.exe.html"><code class="docutils literal"><span class="pre">mongos.exe</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongodump.html"><code class="docutils literal"><span class="pre">mongodump</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongorestore.html"><code class="docutils literal"><span class="pre">mongorestore</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/bsondump.html"><code class="docutils literal"><span class="pre">bsondump</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongooplog.html"><code class="docutils literal"><span class="pre">mongooplog</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongoimport.html"><code class="docutils literal"><span class="pre">mongoimport</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongoexport.html"><code class="docutils literal"><span class="pre">mongoexport</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongostat.html"><code class="docutils literal"><span class="pre">mongostat</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongotop.html"><code class="docutils literal"><span class="pre">mongotop</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongosniff.html"><code class="docutils literal"><span class="pre">mongosniff</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongoperf.html"><code class="docutils literal"><span class="pre">mongoperf</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongofiles.html"><code class="docutils literal"><span class="pre">mongofiles</span></code></a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/configuration-options.html">Configuration File Options</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/connection-string.html">Connection String URI Format</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/server-status-index.html">Server Status Output Index</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/server-status.html">Server Status Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/database-statistics.html">Database Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/collection-statistics.html">Collection Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/collection-validation.html">Collection Validation Data</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/connection-pool-stats.html">Connection Pool Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replica-status.html">Replica Set Status Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replica-configuration.html">Replica Set Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replication-info.html">Replication Info Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/current-op.html">Current Operation Reporting</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/database-profiler.html">Database Profiler Output</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/explain.html">Explain Output</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/exit-codes.html">Exit Codes and Statuses</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/config-database.html">Config Database Contents</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/local-database.html">The <code class="docutils literal"><span class="pre">local</span></code> Database</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/system-collections.html">System Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/limits.html">MongoDB Limits and Thresholds</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/mongodb-extended-json.html">MongoDB Extended JSON</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/glossary.html">Glossary</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/2.2.html">Release Notes for MongoDB 2.2</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/2.0.html">Release Notes for MongoDB 2.0</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.8.html">Release Notes for MongoDB 1.8</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.6.html">Release Notes for MongoDB 1.6</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.4.html">Release Notes for MongoDB 1.4</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.2.html">Release Notes for MongoDB 1.2.x</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/drivers-write-concern.html">Default Write Concern Change</a></li></ul></li></ul>


    </div>
  </div>
           
         </aside>

   </div>

    <div id="main-column" class="main-column">

    <span id="showNav" class="showNav">Navigation</span>

      
            <div class="alert alert-warning">
              <span class="alert-message">This version of the documentation is archived and no longer supported.</span>
            </div>
      
        <div class="document">
            <div class="documentwrapper"><div class="bodywrapper">
              <div class="body" data-pagename="applications/replication">
                   <a class="edit-link" href="https://github.com/mongodb/docs/blob/v2.2/source/applications/replication.txt" target="_blank" title="Edit applications/replication.txt on GitHub">
    
      <span class="icon-edit"></span>
    
  </a>
                

                
  <div class="bc">
    
      <ul>
          <li><a href="../replication.html">Replication</a><span class="bcpoint"> &gt; </span></li>
            <li>Replica Set Considerations and Behaviors for Applications and Development</li> 
      </ul>
    
    
  </div>
                
                  <div class="section" id="replica-set-considerations-and-behaviors-for-applications-and-development">
<h1>Replica Set Considerations and Behaviors for Applications and Development<a class="headerlink" href="#replica-set-considerations-and-behaviors-for-applications-and-development" title="Permalink to this headline">&para;</a></h1>
<div class="contents singlecol local topic" id="on-this-page">
<p class="topic-title first">On this page</p>
<ul class="simple">
<li><a class="reference internal" href="#write-concern" id="id7">Write Concern</a></li>
<li><a class="reference internal" href="#read-preference" id="id8">Read Preference</a></li>
</ul>
</div>
<p>From the perspective of a client application, whether a MongoDB
instance is running as a single server (i.e. &ldquo;standalone&rdquo;) or a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>
is transparent. However, replica sets
offer some configuration options for write and read operations. <a class="footnote-reference" href="#sharded-clusters" id="id1">[1]</a>
This document describes those options and their implications.</p>
<table class="docutils footnote" frame="void" id="sharded-clusters" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td><a class="reference internal" href="../reference/glossary.html#term-sharded-cluster"><span class="xref std std-term">Sharded clusters</span></a> where the
shards are also replica sets provide the same configuration options
with regards to write and read operations.</td></tr>
</tbody>
</table>
<div class="section" id="write-concern">
<span id="replica-set-write-concern"></span><h2>Write Concern<a class="headerlink" href="#write-concern" title="Permalink to this headline">&para;</a></h2>
<p>MongoDB&rsquo;s built-in <a class="reference internal" href="../reference/glossary.html#term-write-concern"><span class="xref std std-term">write concern</span></a> confirms the success of write
operations to a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set&rsquo;s</span></a> <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>.
Write concern uses the <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></code></a> command after write
operations to return an object with error information or confirmation
that there are no errors.</p>
<p>After the <a class="reference internal" href="../release-notes/drivers-write-concern.html"><span class="doc">driver write concern change</span></a> all officially supported
MongoDB drivers enable write concern by default.</p>
<div class="section" id="verify-write-operations">
<h3>Verify Write Operations<a class="headerlink" href="#verify-write-operations" title="Permalink to this headline">&para;</a></h3>
<p>The default write concern confirms write operations only on the
primary.  You can configure write concern to confirm write operations
to additional replica set members as well by issuing the
<a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></code></a> command with the <code class="docutils literal"><span class="pre">w</span></code> option.</p>
<p>The <code class="docutils literal"><span class="pre">w</span></code> option confirms that write operations have replicated to the
specified number of replica set members, including the primary. You can
either specify a number or specify <code class="docutils literal"><span class="pre">majority</span></code>, which ensures the write
propagates to a majority of set members. The following example ensures
the operation has replicated to two members (the primary and one other
member):</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">2</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<p>The following example ensures the write operation has replicated to a
majority of the configured members of the set.</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="s2">&#34;majority&#34;</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you specify a <code class="docutils literal"><span class="pre">w</span></code> value greater than the number of members that
hold a copy of the data (i.e., greater than the number of
non-<a class="reference internal" href="../reference/glossary.html#term-arbiter"><span class="xref std std-term">arbiter</span></a> members), the operation blocks until those members
become available. This can cause the operation to block forever. To
specify a timeout threshold for the <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></code></a> operation,
use the <code class="docutils literal"><span class="pre">wtimeout</span></code> argument. The following example sets the timeout to
5000 milliseconds:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="nx">wtimeout</span><span class="o">:</span><span class="mi">5000</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="modify-default-write-concern">
<h3>Modify Default Write Concern<a class="headerlink" href="#modify-default-write-concern" title="Permalink to this headline">&para;</a></h3>
<p>You can configure your own &ldquo;default&rdquo; <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></code></a>
behavior for a replica set. Use the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></code></a> setting in
the <a class="reference internal" href="../reference/replica-configuration.html"><span class="doc">replica set configuration</span></a>. The following sequence of
commands creates a configuration that waits for the write operation to
complete on a majority of the set members before returning:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{}</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">getLastErrorDefaults</span> <span class="o">=</span> <span class="p">{</span><span class="nx">w</span><span class="o">:</span> <span class="s2">&#34;majority&#34;</span><span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></code></a>
setting affects only those <a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></code></a> commands that
have <em>no</em> other arguments.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use of insufficient write concern can lead to <a class="reference internal" href="../core/replication.html#replica-set-rollbacks"><span class="std std-ref">rollbacks</span></a> in the case of <a class="reference internal" href="../administration/replica-sets.html#replica-set-failover"><span class="std std-ref">replica set failover</span></a>. Always ensure that your operations have
specified the required write concern for your application.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../core/write-operations.html#write-operations-write-concern"><span class="std std-ref">Write Concern</span></a> and
<a class="reference internal" href="../reference/connection-string.html#connections-write-concern"><span class="std std-ref">Write Concern Options</span></a></p>
</div>
</div>
<div class="section" id="custom-write-concerns">
<h3>Custom Write Concerns<a class="headerlink" href="#custom-write-concerns" title="Permalink to this headline">&para;</a></h3>
<p>You can use replica set tags to create custom write concerns using the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></code></a> and
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorModes" title="local.system.replset.settings.getLastErrorModes"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorModes</span></code></a> replica set
settings.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Custom write concern modes specify the field name and a number of
<em>distinct</em> values for that field. By contrast, read preferences use
the value of fields in the tag document to direct read operations.</p>
<p class="last">In some cases, you may be able to use the same tags for read
preferences and write concerns; however, you may need to create
additional tags for write concerns depending on the requirements of
your application.</p>
</div>
<div class="section" id="single-tag-write-concerns">
<h4>Single Tag Write Concerns<a class="headerlink" href="#single-tag-write-concerns" title="Permalink to this headline">&para;</a></h4>
<p>Consider a five member replica set, where each member has one of the
following tag sets:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;backup&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;application&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;application&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;application&#34;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>You could create a custom write concern mode that will ensure that
applicable write operations will not return until members with two
different values of the <code class="docutils literal"><span class="pre">use</span></code> tag have acknowledged the write
operation. Create the mode with the following sequence of operations
in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">getLastErrorModes</span><span class="o">:</span> <span class="p">{</span> <span class="nx">use2</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="mi">2</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To use this mode pass the string <code class="docutils literal"><span class="pre">multiUse</span></code> to the <code class="docutils literal"><span class="pre">w</span></code> option of
<a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></code></a> as follows:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="nx">use2</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="specific-custom-write-concerns">
<h4>Specific Custom Write Concerns<a class="headerlink" href="#specific-custom-write-concerns" title="Permalink to this headline">&para;</a></h4>
<p>If you have a three member replica with the following tag sets:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;san&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;spinning&#34;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>You cannot specify a custom
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorModes" title="local.system.replset.settings.getLastErrorModes"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorModes</span></code></a> value to
ensure that the write propagates to the <code class="docutils literal"><span class="pre">san</span></code> before
returning. However, you may implement this write concern policy by
creating the following additional tags, so that the set resembles the
following:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;san&#34;</span><span class="p">,</span> <span class="s2">&#34;disk.san&#34;</span><span class="o">:</span> <span class="s2">&#34;san&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;spinning&#34;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>Then, create a custom
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorModes" title="local.system.replset.settings.getLastErrorModes"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorModes</span></code></a> value, as
follows:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">getLastErrorModes</span><span class="o">:</span> <span class="p">{</span> <span class="nx">san</span><span class="o">:</span> <span class="p">{</span> <span class="s2">&#34;disk.san&#34;</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To use this mode pass the string <code class="docutils literal"><span class="pre">san</span></code> to the <code class="docutils literal"><span class="pre">w</span></code> option of
<a class="reference internal" href="../reference/command/getLastError.html#dbcmd.getLastError" title="getLastError"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">getLastError</span></code></a> as follows:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">getLastError</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="nx">w</span><span class="o">:</span> <span class="nx">san</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<p>This operation will not return until a replica set member with the tag
<code class="docutils literal"><span class="pre">disk.san</span></code> returns.</p>
<p>You may set a custom write concern mode as the default write concern
mode using <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.getLastErrorDefaults" title="local.system.replset.settings.getLastErrorDefaults"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">getLastErrorDefaults</span></code></a>
replica set as in the following setting:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">getLastErrorDefaults</span> <span class="o">=</span> <span class="p">{</span> <span class="nx">ssd</span><span class="o">:</span><span class="mi">1</span> <span class="p">}</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../reference/replica-configuration.html#replica-set-configuration-tag-sets"><span class="std std-ref">Tag Sets</span></a> for further
information about replica set reconfiguration and tag sets.</p>
</div>
</div>
</div>
</div>
<div class="section" id="read-preference">
<span id="replica-set-read-preference"></span><span id="index-0"></span><span id="id2"></span><h2>Read Preference<a class="headerlink" href="#read-preference" title="Permalink to this headline">&para;</a></h2>
<p>Read preference describes how MongoDB clients route read operations to
members of a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>.</p>
<div class="section" id="background">
<span id="replica-set-read-preference-background"></span><span id="index-1"></span><h3>Background<a class="headerlink" href="#background" title="Permalink to this headline">&para;</a></h3>
<p>By default, an application directs its read operations to the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>
member in a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>. Reading from the primary guarantees that
read operations reflect the latest version of a document. However,
for an application that does not require fully up-to-date data, you
can improve read throughput, or reduce latency, by distributing some or all
reads to secondary members of the replica set.</p>
<p>The following are use cases where you might use secondary reads:</p>
<ul class="simple">
<li>Running systems operations that do not affect the front-end
application, operations such as backups and reports.</li>
<li>Providing low-latency queries for geographically distributed
deployments. If one secondary is closer to an application server
than the primary, you may see better
performance for that application if you use secondary reads.</li>
<li>Providing graceful degradation in <a class="reference internal" href="../administration/replica-sets.html#replica-set-failover"><span class="std std-ref">failover</span></a> situations where a set has <em>no</em> primary for 10
seconds or more. In this use case, you should give the application the
<a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a> read preference, which prevents the
application from performing reads if the set has no primary.</li>
</ul>
<p>MongoDB <a class="reference internal" href="../reference/glossary.html#term-driver"><span class="xref std std-term">drivers</span></a> allow client applications to configure
a <a class="reference internal" href="../reference/glossary.html#term-read-preference"><span class="xref std std-term">read preference</span></a> on a per-connection, per-collection, or
per-operation basis. For more information about secondary read
operations in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell, see the <a class="reference internal" href="../reference/method/cursor.readPref.html#cursor.readPref" title="cursor.readPref()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">readPref()</span></code></a>
method. For more information about a driver&rsquo;s read preference
configuration, see the appropriate <a class="reference internal" href="drivers.html#driver"><span class="std std-ref">MongoDB Drivers and Client Libraries</span></a> API documentation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Read preferences affect how an application selects which member
to use for read operations. As a result read
preferences dictate if the application receives stale or
current data from MongoDB. Use appropriate <a class="reference internal" href="../reference/glossary.html#term-write-concern"><span class="xref std std-term">write concern</span></a>
policies to ensure proper data
replication and consistency.</p>
<p class="last">If read operations account for a large percentage of your
application&rsquo;s traffic, distributing reads to secondary members can
improve read throughput. However, in most cases <a class="reference internal" href="../core/sharded-clusters.html"><span class="doc">sharding</span></a> provides better support for larger scale
operations, as clusters can distribute read and write
operations across a group of machines.</p>
</div>
<span class="target" id="replica-set-read-preference-semantics"><span id="index-2"></span></span></div>
<div class="section" id="read-preference-modes">
<span id="replica-set-read-preference-modes"></span><span id="index-3"></span><h3>Read Preference Modes<a class="headerlink" href="#read-preference-modes" title="Permalink to this headline">&para;</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.</span></p>
</div>
<p>MongoDB <a class="reference internal" href="drivers.html"><span class="doc">drivers</span></a> support five
read preference modes:</p>
<ul class="simple">
<li><a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a></li>
<li><a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a></li>
<li><a class="reference internal" href="#secondary" title="secondary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondary</span></code></a></li>
<li><a class="reference internal" href="#secondaryPreferred" title="secondaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondaryPreferred</span></code></a></li>
<li><a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a></li>
</ul>
<p>You can specify a read preference mode on connection objects, database object,
collection object, or per-operation. The syntax for specifying the read
preference mode is <a class="reference external" href="https://api.mongodb.com/">specific to the driver and to the idioms of the host language</a>.</p>
<p>Read preference modes are also available to clients connecting to a
<a class="reference internal" href="../reference/glossary.html#term-sharded-cluster"><span class="xref std std-term">sharded cluster</span></a> through a <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a>. The
<a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> instance obeys specified read preferences when
connecting to the <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> that provides each <a class="reference internal" href="../reference/glossary.html#term-shard"><span class="xref std std-term">shard</span></a>
in the cluster.</p>
<p>In the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell, the
<a class="reference internal" href="../reference/method/cursor.readPref.html#cursor.readPref" title="cursor.readPref()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">readPref()</span></code></a> cursor method
provides access to read preferences.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>All read preference modes except <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> may return
stale data as <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondaries</span></a> replicate operations
from the primary with some delay.</p>
<p class="last">Ensure that your application can tolerate stale data if you choose
to use a non-<a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> mode.</p>
</div>
<p>For more information, see <a class="reference internal" href="#replica-set-read-preference-background"><span class="std std-ref">read preference background</span></a> and <a class="reference internal" href="#replica-set-read-preference-behavior"><span class="std std-ref">read preference
behavior</span></a>. See also the
<a class="reference external" href="https://api.mongodb.com/">documentation for your driver</a>.</p>
<dl class="readmode">
<dt id="primary">
<code class="descname">primary</code><a class="dashingAutolink" name="autolink-47"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#primary" title="Permalink to this definition">&para;</a></dt>
<dd><p>All read operations use only the current replica set <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>.
This is the default. If the primary is unavailable,
read operations produce an error or throw an exception.</p>
<p>The <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> read preference mode is not compatible with
read preference modes that use <a class="reference internal" href="#replica-set-read-preference-tag-sets"><span class="std std-ref">tag sets</span></a>. If you specify a tag set
with <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a>, the driver will produce an error.</p>
</dd></dl>

<dl class="readmode">
<dt id="primaryPreferred">
<code class="descname">primaryPreferred</code><a class="dashingAutolink" name="autolink-48"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#primaryPreferred" title="Permalink to this definition">&para;</a></dt>
<dd><p>In most situations, operations read from the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> member
of the set. However, if the primary is unavailable, as is the case
during <a class="reference internal" href="../reference/glossary.html#term-failover"><span class="xref std std-term">failover</span></a> situations, operations read from secondary
members.</p>
<p>When the read preference includes a <a class="reference internal" href="#replica-set-read-preference-tag-sets"><span class="std std-ref">tag set</span></a>, the client reads first from
the primary, if available, and then from <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondaries</span></a> that match the specified tags. If no secondaries have
matching tags, the read operation produces an error.</p>
<p>Since the application may receive data from a secondary, read
operations using the <a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a> mode may return
stale data in some situations.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.2: </span><a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> added full support for read preferences.</p>
</div>
<p class="last">When connecting to a <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> instance older than 2.2,
using a client that supports read preference modes,
<a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a> will send queries to secondaries.</p>
</div>
</dd></dl>

<dl class="readmode">
<dt id="secondary">
<code class="descname">secondary</code><a class="dashingAutolink" name="autolink-49"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#secondary" title="Permalink to this definition">&para;</a></dt>
<dd><p>Operations read <em>only</em> from the <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> members of the set.
If no secondaries are available, then this read operation produces an
error or exception.</p>
<p>Most sets have at least one secondary, but there are situations
where there may be no available secondary. For example, a set
with a primary, a secondary, and an <a class="reference internal" href="../reference/glossary.html#term-arbiter"><span class="xref std std-term">arbiter</span></a> may not have
any secondaries if a member is in recovering state or unavailable.</p>
<p>When the read preference includes a <a class="reference internal" href="#replica-set-read-preference-tag-sets"><span class="std std-ref">tag set</span></a>, the client attempts to find
secondary members that match the specified tag set and directs reads
to a random secondary from among the <a class="reference internal" href="#replica-set-read-preference-behavior-nearest"><span class="std std-ref">nearest group</span></a>. If no secondaries
have matching tags, the read operation produces an error. <a class="footnote-reference" href="#capacity-planning" id="id3">[2]</a></p>
<p>Read operations using the <a class="reference internal" href="#secondary" title="secondary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondary</span></code></a> mode may return stale data.</p>
</dd></dl>

<dl class="readmode">
<dt id="secondaryPreferred">
<code class="descname">secondaryPreferred</code><a class="dashingAutolink" name="autolink-50"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#secondaryPreferred" title="Permalink to this definition">&para;</a></dt>
<dd><p>In most situations, operations read from <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> members,
but in situations where the set consists of a single
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> (and no other members,) the read operation will use
the set&rsquo;s primary.</p>
<p>When the read preference includes a <a class="reference internal" href="#replica-set-read-preference-tag-sets"><span class="std std-ref">tag set</span></a>, the client attempts to find
a secondary member that matches the specified tag set and directs
reads to a random secondary from among the <a class="reference internal" href="#replica-set-read-preference-behavior-nearest"><span class="std std-ref">nearest group</span></a>. If no secondaries
have matching tags, the read operation produces an error.</p>
<p>Read operations using the <a class="reference internal" href="#secondaryPreferred" title="secondaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondaryPreferred</span></code></a> mode may return stale data.</p>
</dd></dl>

<dl class="readmode">
<dt id="nearest">
<code class="descname">nearest</code><a class="dashingAutolink" name="autolink-51"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#nearest" title="Permalink to this definition">&para;</a></dt>
<dd><p>The driver reads from the <em>nearest</em> member of the <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">set</span></a> according to the <a class="reference internal" href="#replica-set-read-preference-behavior-nearest"><span class="std std-ref">member selection</span></a> process. Reads in
the <a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a> mode do not consider the member&rsquo;s
<em>type</em>. Reads in <a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a> mode may read from both
primaries and secondaries.</p>
<p>Set this mode to minimize the effect of network latency
on read operations without preference for current or stale data.</p>
<p>If you specify a <a class="reference internal" href="#replica-set-read-preference-tag-sets"><span class="std std-ref">tag set</span></a>,
the client attempts to find a replica set member that matches the
specified tag set and directs reads to an arbitrary member from
among the <a class="reference internal" href="#replica-set-read-preference-behavior-nearest"><span class="std std-ref">nearest group</span></a>.</p>
<p>Read operations using the <a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a> mode may return stale data.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>All operations read from a member of the nearest group of the
replica set that matches the specified read preference mode. The
<a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a> mode prefers low latency reads over a
member&rsquo;s <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> status.</p>
<p class="last">For <a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a>, the client assembles a list of
acceptable hosts based on tag set and then narrows that list to
the host with the shortest ping time and all other members of
the set that are within the &ldquo;local threshold,&rdquo; or acceptable
latency. See <a class="reference internal" href="#replica-set-read-preference-behavior-nearest"><span class="std std-ref">Member Selection</span></a>
for more information.</p>
</div>
</dd></dl>

<table class="docutils footnote" frame="void" id="capacity-planning" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id3">[2]</a></td><td>If your set has more than one secondary, and
you use the <a class="reference internal" href="#secondary" title="secondary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondary</span></code></a> read preference mode, consider
the following effect. If you have a <a class="reference internal" href="../administration/replica-set-architectures.html#replica-set-three-members"><span class="std std-ref">three member replica set</span></a> with a primary and two secondaries,
and if one secondary becomes unavailable, all <a class="reference internal" href="#secondary" title="secondary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondary</span></code></a>
queries must target the remaining secondary. This will double the
load on this secondary. Plan and provide capacity to support this
as needed.</td></tr>
</tbody>
</table>
<span class="target" id="index-4"></span></div>
<div class="section" id="tag-sets">
<span id="replica-set-read-preference-tag-sets"></span><span id="index-5"></span><h3>Tag Sets<a class="headerlink" href="#tag-sets" title="Permalink to this headline">&para;</a></h3>
<p>Tag sets allow you to specify custom <a class="reference internal" href="#replica-set-read-preference"><span class="std std-ref">read preferences</span></a>
and <a class="reference internal" href="../core/write-operations.html#write-operations-write-concern"><span class="std std-ref">write concerns</span></a>
so that your application can target
operations to specific members, based on custom parameters.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>Consider the following properties of read preferences:</p>
<ul class="last simple">
<li>Custom read preferences and write concerns evaluate tags sets in
different ways.</li>
<li>Read preferences consider the value of a tag when selecting a
member to read from.</li>
<li>Write concerns ignore the value of a tag to when selecting a
member <em>except</em> to consider whether or not the value is unique.</li>
</ul>
</div>
<p>A tag set for a read operation may resemble the following document:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>To fulfill the request, a member would need to have both of these tags.
Therefore the following tag sets, would satisfy this
requirement:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span><span class="p">,</span> <span class="s2">&#34;rack&#34;</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span><span class="p">,</span> <span class="s2">&#34;rack&#34;</span><span class="o">:</span> <span class="mi">4</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span><span class="p">,</span> <span class="s2">&#34;mem&#34;</span><span class="o">:</span> <span class="s2">&#34;64&#34;</span><span class="p">}</span>
</pre></div>
</div>
</div>
<p>However, the following tag sets would <em>not</em> be able to fulfill this query:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;production&#34;</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;ssd&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;production&#34;</span><span class="p">,</span> <span class="s2">&#34;rack&#34;</span><span class="o">:</span> <span class="mi">3</span> <span class="p">}</span>
<span class="p">{</span> <span class="s2">&#34;disk&#34;</span><span class="o">:</span> <span class="s2">&#34;spinning&#34;</span><span class="p">,</span> <span class="s2">&#34;use&#34;</span><span class="o">:</span> <span class="s2">&#34;reporting&#34;</span><span class="p">,</span> <span class="s2">&#34;mem&#34;</span><span class="o">:</span> <span class="s2">&#34;32&#34;</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>Therefore, tag sets make it possible to ensure that read operations
target specific members in a particular data center or
<a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instances designated for a particular class of
operations, such as reporting or analytics.
For information on configuring tag sets, see
<a class="reference internal" href="../reference/replica-configuration.html#replica-set-configuration-tag-sets"><span class="std std-ref">Tag Sets</span></a> in the
<a class="reference internal" href="../reference/replica-configuration.html"><span class="doc">Replica Set Configuration</span></a> document.
You can specify tag sets with the following read preference modes:</p>
<ul class="simple">
<li><a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a></li>
<li><a class="reference internal" href="#secondary" title="secondary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondary</span></code></a></li>
<li><a class="reference internal" href="#secondaryPreferred" title="secondaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondaryPreferred</span></code></a></li>
<li><a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a></li>
</ul>
<p>You cannot specify tag sets with the <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> read preference mode.</p>
<p>Tags are not compatible with <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> and only apply when
<a class="reference internal" href="#replica-set-read-preference-behavior-member-selection"><span class="std std-ref">selecting</span></a>
a <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> member of a set for a read operation. However, the
<a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a> read mode, when combined with a tag set will
select the nearest member that matches the specified tag set, which
may be a primary or secondary.</p>
<p>All interfaces use the same <a class="reference internal" href="#replica-set-read-preference-behavior-member-selection"><span class="std std-ref">member selection logic</span></a> to choose the
member to which to direct read operations, basing the choice on read
preference mode and tag sets.</p>
<p>For more information on how read preference <a class="reference internal" href="#replica-set-read-preference-modes"><span class="std std-ref">modes</span></a> interact with tag sets, see the
documentation for each read preference mode.</p>
</div>
<div class="section" id="behavior">
<span id="replica-set-read-preference-behavior"></span><span id="index-6"></span><h3>Behavior<a class="headerlink" href="#behavior" title="Permalink to this headline">&para;</a></h3>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.2.</span></p>
</div>
<div class="section" id="auto-retry">
<span id="replica-set-read-preference-behavior-retry"></span><h4>Auto-Retry<a class="headerlink" href="#auto-retry" title="Permalink to this headline">&para;</a></h4>
<p>Connection between MongoDB drivers and <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instances in
a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> must balance two concerns:</p>
<ol class="arabic simple">
<li>The client should attempt to prefer current results, and any
connection should read from the same member of the replica set as
much as possible.</li>
<li>The client should minimize the amount of time that the database is
inaccessible as the result of a connection issue, networking
problem, or <a class="reference internal" href="../reference/glossary.html#term-failover"><span class="xref std std-term">failover</span></a> in a replica set.</li>
</ol>
<p>As a result, MongoDB drivers and <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a>:</p>
<ul>
<li><p class="first">Reuse a connection to specific <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> for as long as
possible after establishing a connection to that instance. This
connection is <em>pinned</em> to this <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a>.</p>
</li>
<li><p class="first">Attempt to reconnect to a new member, obeying existing <a class="reference internal" href="#replica-set-read-preference-modes"><span class="std std-ref">read
preference modes</span></a>, if the connection
to <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> is lost.</p>
<p>Reconnections are transparent to the application itself. If
the connection permits reads from <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> members, after
reconnecting, the application can receive two sequential reads
returning from different secondaries. Depending on the state of the
individual secondary member&rsquo;s replication, the documents can reflect
the state of your database at different moments.</p>
</li>
<li><p class="first">Return an error <em>only</em> after attempting to connect to three members
of the set that match the <a class="reference internal" href="#replica-set-read-preference-modes"><span class="std std-ref">read preference mode</span></a>
and <a class="reference internal" href="#replica-set-read-preference-tag-sets"><span class="std std-ref">tag set</span></a>.
If there are fewer than three members of the set, the
client will error after connecting to all existing members of the
set.</p>
<p>After this error, the driver selects a new member using the
specified read preference mode. In the absence of a specified read
preference, the driver uses <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a>.</p>
</li>
<li><p class="first">After detecting a failover situation, <a class="footnote-reference" href="#fn-failover" id="id4">[3]</a> the driver
attempts to refresh the state of the replica set as quickly as
possible.</p>
</li>
</ul>
<table class="docutils footnote" frame="void" id="fn-failover" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id4">[3]</a></td><td>When a <a class="reference internal" href="../reference/glossary.html#term-failover"><span class="xref std std-term">failover</span></a> occurs, all members of the set
close all client connections that produce a socket error in the
driver. This behavior prevents or minimizes <a class="reference internal" href="../reference/glossary.html#term-rollback"><span class="xref std std-term">rollback</span></a>.</td></tr>
</tbody>
</table>
</div>
<div class="section" id="request-association">
<span id="replica-set-read-preference-behavior-requests"></span><h4>Request Association<a class="headerlink" href="#request-association" title="Permalink to this headline">&para;</a></h4>
<p>Reads from <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> may reflect the state of the data set at
different points in time because <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> members of a
<a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> may lag behind the current state of the primary by
different amounts. To prevent subsequent reads from jumping around in
time, the driver can associate application threads to a specific member
of the set after the first read. The thread will continue to read from
the same member until:</p>
<ul class="simple">
<li>The application performs a read with a different read preference.</li>
<li>The thread terminates.</li>
<li>The client receives a socket exception, as is
the case when there&rsquo;s a network error or when
the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> closes connections during a <a class="reference internal" href="../reference/glossary.html#term-failover"><span class="xref std std-term">failover</span></a>.
This triggers a <a class="reference internal" href="#replica-set-read-preference-behavior-retry"><span class="std std-ref">retry</span></a>, which may be
transparent to the application.</li>
</ul>
<p>If an application thread issues a query with the
<a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a> mode while the primary is inaccessible,
the thread will carry the association with that secondary for the
lifetime of the thread. The thread will associate with the primary, if
available, only after issuing a query with a different read
preference, even if a primary becomes available. By extension, if a
thread issues a read with the <a class="reference internal" href="#secondaryPreferred" title="secondaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondaryPreferred</span></code></a> when all
secondaries are down, it will carry an association with the
primary. This application thread will continue to read from the
primary even if a secondary becomes available later in the thread&rsquo;s
lifetime.</p>
<span class="target" id="index-7"></span><span class="target" id="index-8"></span></div>
<div class="section" id="member-selection">
<span id="replica-set-read-preference-behavior-member-selection"></span><span id="replica-set-read-preference-behavior-nearest"></span><span id="replica-set-read-preference-behavior-ping-time"></span><span id="index-9"></span><h4>Member Selection<a class="headerlink" href="#member-selection" title="Permalink to this headline">&para;</a></h4>
<p>Clients, by way of their drivers, and <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> instances for
sharded clusters periodically update their view of the replica set&rsquo;s state:
which members are up or down, which member is primary, and the latency to each
<a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance.</p>
<p>For any operation that targets a member <em>other</em> than the
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>, the driver:</p>
<ol class="arabic simple">
<li>Assembles a list of suitable members, taking into account member type
(i.e. secondary, primary, or all members.)</li>
<li>Excludes members not matching the tag sets, if specified.</li>
<li>Determines which suitable member is the closest to the
client in absolute terms.</li>
<li>Builds a list of members that are within a defined ping distance (in
milliseconds) of the &ldquo;absolute nearest&rdquo; member. <a class="footnote-reference" href="#acceptable-secondary-latency" id="id5">[4]</a></li>
<li>Selects a member from these hosts at random. The member receives the read operation.</li>
</ol>
<p>Once the application selects a member of the set to use for read
operations, the driver continues to use this connection for read
preference until the application specifies a new read preference or
something interrupts the connection. See <a class="reference internal" href="#replica-set-read-preference-behavior-requests"><span class="std std-ref">Request Association</span></a>
for more information.</p>
<table class="docutils footnote" frame="void" id="acceptable-secondary-latency" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[4]</a></td><td>Applications can configure the
threshold used in this stage. The default &ldquo;acceptable latency&rdquo; is
15 milliseconds, which you can override in the drivers with their own
<code class="docutils literal"><span class="pre">secondaryAcceptableLatencyMS</span></code> option.
For <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> you can use the <a class="reference internal" href="../reference/mongos.html#cmdoption-mongos-localthreshold"><code class="xref std std-option docutils literal"><span class="pre">--localThreshold</span></code></a> or
<a class="reference internal" href="../reference/configuration-options.html#localThreshold" title="localThreshold"><code class="xref mongodb mongodb-setting docutils literal"><span class="pre">localThreshold</span></code></a> runtime options to set this value.</td></tr>
</tbody>
</table>
<span class="target" id="index-10"></span></div>
<div class="section" id="sharding-and-mongos">
<span id="replica-set-read-preference-behavior-mongos"></span><span id="replica-set-read-preference-behavior-sharding"></span><span id="index-11"></span><h4>Sharding and <code class="docutils literal"><span class="pre">mongos</span></code><a class="headerlink" href="#sharding-and-mongos" title="Permalink to this headline">&para;</a></h4>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.2: </span>Before version 2.2, <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> did not support the
<a class="reference internal" href="#replica-set-read-preference-modes"><span class="std std-ref">read preference mode semantics</span></a>.</p>
</div>
<p>In most <a class="reference internal" href="../reference/glossary.html#term-sharded-cluster"><span class="xref std std-term">sharded clusters</span></a>, a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>
provides each shard where read preferences are also applicable. Read
operations in a sharded cluster, with regard to read preference, are
identical to unsharded replica sets.</p>
<p>Unlike simple replica sets, in sharded clusters, all interactions with
the shards pass from the clients to the <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> instances
that are actually connected to the set members. <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> is
responsible for the application of the read preferences, which is
transparent to applications.</p>
<p>There are no configuration changes required for full support of read
preference modes in sharded environments, as long as the
<a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> is at least version 2.2. All <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a>
maintain their own connection pool to the replica set members. As a
result:</p>
<ul>
<li><p class="first">A request without a specified preference has
<a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a>, the default, unless, the <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a>
reuses an existing connection that has a different mode set.</p>
<p>Always explicitly set your read preference mode to prevent
confusion.</p>
</li>
<li><p class="first">All <a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a> and latency calculations reflect the
connection between the <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> and the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a>
instances, not the client and the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instances.</p>
<p>This produces the desired result, because all results must pass
through the <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> before returning to the client.</p>
</li>
</ul>
</div>
<div class="section" id="database-commands">
<h4>Database Commands<a class="headerlink" href="#database-commands" title="Permalink to this headline">&para;</a></h4>
<p>Because some <a class="reference internal" href="../reference/glossary.html#term-database-command"><span class="xref std std-term">database commands</span></a> read and
return data from the database, all of the official drivers support
full <a class="reference internal" href="#replica-set-read-preference-modes"><span class="std std-ref">read preference mode semantics</span></a>
for the following commands:</p>
<ul class="simple">
<li><a class="reference internal" href="../reference/command/group.html#dbcmd.group" title="group"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">group</span></code></a></li>
<li><a class="reference internal" href="../reference/command/mapReduce.html#dbcmd.mapReduce" title="mapReduce"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">mapReduce</span></code></a> <a class="footnote-reference" href="#inline-map-reduce" id="id6">[5]</a></li>
<li><a class="reference internal" href="../reference/command/aggregate.html#dbcmd.aggregate" title="aggregate"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">aggregate</span></code></a></li>
<li><a class="reference internal" href="../reference/command/collStats.html#dbcmd.collStats" title="collStats"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">collStats</span></code></a></li>
<li><a class="reference internal" href="../reference/command/dbStats.html#dbcmd.dbStats" title="dbStats"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">dbStats</span></code></a></li>
<li><a class="reference internal" href="../reference/command/count.html#dbcmd.count" title="count"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">count</span></code></a></li>
<li><a class="reference internal" href="../reference/command/distinct.html#dbcmd.distinct" title="distinct"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">distinct</span></code></a></li>
<li><a class="reference internal" href="../reference/command/geoNear.html#dbcmd.geoNear" title="geoNear"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">geoNear</span></code></a></li>
<li><a class="reference internal" href="../reference/command/geoSearch.html#dbcmd.geoSearch" title="geoSearch"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">geoSearch</span></code></a></li>
<li><a class="reference internal" href="../reference/command/geoWalk.html#dbcmd.geoWalk" title="geoWalk"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">geoWalk</span></code></a></li>
</ul>
<table class="docutils footnote" frame="void" id="inline-map-reduce" rules="none">
<colgroup><col class="label"/><col/></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[5]</a></td><td>Only &ldquo;inline&rdquo; <a class="reference internal" href="../reference/command/mapReduce.html#dbcmd.mapReduce" title="mapReduce"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">mapReduce</span></code></a>
operations that do not write data support read preference,
otherwise these operations must run on the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>
members.</td></tr>
</tbody>
</table>
<p><a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> currently does not route commands using read
preferences; clients send all commands to shards&rsquo; primaries. See
<a class="reference external" href="https://jira.mongodb.org/browse/SERVER-7423">SERVER-7423</a>.</p>
</div>
</div>
<div class="section" id="uses-for-non-primary-read-preferences">
<h3>Uses for non-Primary Read Preferences<a class="headerlink" href="#uses-for-non-primary-read-preferences" title="Permalink to this headline">&para;</a></h3>
<p>You must exercise care when specifying read preferences: modes other
than <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> can <em>and will</em> return stale data. These
secondary queries will not
include the most recent write operations to the replica set&rsquo;s
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. Nevertheless, there are several common use cases for
using non-<a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> read preference modes:</p>
<ul>
<li><p class="first">Reporting and analytics workloads.</p>
<p>Having these queries target a <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> helps distribute
load and prevent these operations from affecting the main workload
of the primary.</p>
<p>Also consider using <a class="reference internal" href="#secondary" title="secondary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondary</span></code></a> in conjunction with a
direct connection to a <a class="reference internal" href="../administration/replica-sets.html#replica-set-hidden-members"><span class="std std-ref">hidden member</span></a> of the set.</p>
</li>
<li><p class="first">Providing local reads for geographically distributed applications.</p>
<p>If you have application servers in multiple data centers, you may
consider having a <a class="reference internal" href="../administration/replica-set-architectures.html#replica-set-geographical-distribution"><span class="std std-ref">geographically distributed replica set</span></a> and using a non primary
read preference or the <a class="reference internal" href="#nearest" title="nearest"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">nearest</span></code></a> to avoid network
latency.</p>
</li>
<li><p class="first">Maintaining availability during a failover.</p>
<p>Use <a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a> if you want your application to do
consistent reads from the primary under normal circumstances, but to
allow stale reads from secondaries in an emergency. This provides a
&ldquo;read-only mode&rdquo; for your application during a failover.</p>
</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>In some situations using <a class="reference internal" href="#secondaryPreferred" title="secondaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondaryPreferred</span></code></a> to
distribute read load to replica sets may carry significant
operational risk: if all secondaries are unavailable and your set
has enough <a class="reference internal" href="../reference/glossary.html#term-arbiter"><span class="xref std std-term">arbiters</span></a> to prevent the primary from
stepping down, then the primary will receive all traffic from
clients.</p>
<p class="last">For this reason, use <a class="reference internal" href="#secondary" title="secondary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondary</span></code></a> to distribute read load
to replica sets, not <a class="reference internal" href="#secondaryPreferred" title="secondaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">secondaryPreferred</span></code></a>.</p>
</div>
<p>Using read modes other than <a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> and
<a class="reference internal" href="#primaryPreferred" title="primaryPreferred"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primaryPreferred</span></code></a> to provide extra capacity is not in and
of itself justification for non-<a class="reference internal" href="#primary" title="primary"><code class="xref mongodb mongodb-readmode docutils literal"><span class="pre">primary</span></code></a> in many
cases. Furthermore, <a class="reference internal" href="../sharding.html"><span class="doc">sharding</span></a> increases read and
write capacity by distributing read and write operations across a
group of machines.</p>
</div>
</div>
</div>

                
    <div id="btnv">
      <span class="btn-arrow-left">&larr; &nbsp;</span>
      <a class="btn-prev-text" href="../administration/replica-set-architectures.html" title="Previous Section: Replica Set Architectures and Deployment Patterns"><span>Replica Set Architectures and Deployment Patterns</span></a>
      <a class="btn-next-text" href="../core/replication-internals.html" title="Next Section: Replica Set Internals and Behaviors"><span>Replica Set Internals and Behaviors</span></a>
      <span class="btn-arrow-right">&nbsp;&rarr;</span>
    </div>
                  <div class="footer">
                    <div class="copyright">
                      <p>&copy; MongoDB, Inc 2008-present. MongoDB, Mongo, and the leaf logo are registered trademarks of MongoDB, Inc.</p>
                    </div>
                  </div>
              </div></div>
            </div>
        </div>
    </div>
    <div class="right-column">
      <div class="wrapper"> <div id="mongodb-docs-1">
   <script type="text/javascript">
      googletag.cmd.push(function() { googletag.display('mongodb-docs-1'); });
   </script>
</div>
            <div class="social">
               <a class="slack-icon" href="https://slackpass.io/mongo-db?jmp=docs" title="https://slackpass.io/mongo-db?jmp=docs"><i class="fab fa-slack" aria-hidden="true"></i></a>
               <a class="twitter-icon" href="https://twitter.com/MongoDB" title="https://twitter.com/MongoDB"><i class="fab fa-twitter-square"></i></a>
               <a class="youtube-icon" href="https://www.youtube.com/user/MongoDB" title="https://www.youtube.com/user/MongoDB"><i class="fab fa-youtube-square"></i></a>
               <a class="facebook-icon" href="https://www.facebook.com/mongodb" title="https://www.facebook.com/mongodb"><i class="fab fa-facebook-square"></i></a>
               <a class="stack-overflow-icon" href="https://stackoverflow.com/tags/mongodb/info" title="https://stackoverflow.com/tags/mongodb/info"><i class="fab fa-stack-overflow" aria-hidden="true"></i></a>
            </div>
        

      </div>
    </div>
    
      <div id="rating-panel"></div>
    
    <div class="clearfix"></div>
  </div>
<div id="navbar" data-navprops="{&#34;links&#34;: [{&#34;url&#34;: &#34;https://www.mongodb.com/docs/manual/&#34;,&#34;text&#34;: &#34;Server&#34;,&#34;active&#34;: true},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/drivers/&#34;,&#34;text&#34;: &#34;Drivers&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/cloud/&#34;,&#34;text&#34;: &#34;Cloud&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/tools/&#34;,&#34;text&#34;: &#34;Tools&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/guides/&#34;,&#34;text&#34;: &#34;Guides&#34;}], &#34;baseUrl&#34;: &#34;https://www.mongodb.com/docs&#34;}"></div>

  

  

  <script type="text/javascript">
  // Bootstrap array of links that should trigger a full page reload
  window.docsExcludedNav = [];
  </script>
</body></html>