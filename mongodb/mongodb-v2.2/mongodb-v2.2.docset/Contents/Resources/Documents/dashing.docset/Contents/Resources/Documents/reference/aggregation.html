<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
  <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css"/></head><body data-project="manual" data-project-title="MongoDB Manual" data-branch="v2.2" data-enable-marian="1" data-eol="True"><a class="dashingAutolink" name="autolink-106"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Aggregation%20Framework%20Reference%20%E2%80%94%20MongoDB%20Manual"></a><a class="dashingAutolink" name="autolink-222"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Aggregation%20Framework%20Reference%20%E2%80%94%20MongoDB%20Manual"></a><title>Aggregation Framework Reference &mdash; MongoDB Manual</title><link rel="shortcut icon" href="https://www.mongodb.com/docs/assets/favicon.ico"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
      <link rel="canonical" href="https://www.mongodb.com/docs/manual/reference/aggregation/"/><meta name="robots" content="index"/>
  <meta name="release" content="2.2.7"/>
  <meta name="version" content="2.2"/>
  <meta name="DC.Source" content="https://github.com/mongodb/docs/blob/v2.2/source/reference/aggregation.txt"/>
  <meta property="og:image" content="http://s3.amazonaws.com/info-mongodb-com/_com_assets/cms/mongodb-for-giant-ideas-bbab5c3cf8.png"/>
  <meta property="og:image:secure_url" content="https://webassets.mongodb.com/_com_assets/cms/mongodb-for-giant-ideas-bbab5c3cf8.png"/>
  
   <link rel="stylesheet" href="../_static/mongodb-docs.css" type="text/css"/>
   <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
   <link rel="stylesheet" href="../_static/css/navbar.min.css?t=nocache" type="text/css"/>
    
    <script type="text/javascript" src="../_static/lib/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/lib/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/controller.js"></script>
      <link rel="search" type="application/opensearchdescription+xml" href="https://www.mongodb.com/docs/osd.xml" title="MongoDB Help"/>
<link rel="author" title="About these documents" href="../about.html"/>
<!-- <link rel="index" title="Index" href="../genindex.html" /> -->
<link rel="search" title="Search" href="../search.html"/>
<link rel="top" title="MongoDB Manual" href="../index.html"/>
<link rel="up" title="Aggregation" href="../aggregation.html"/>
<link rel="next" title="Map-Reduce" href="../applications/map-reduce.html"/>
<link rel="prev" title="Aggregation Framework Examples" href="../tutorial/aggregation-examples.html"/><script type="text/javascript">
   var gptadslots=[];
   var googletag = googletag || {};
   googletag.cmd = googletag.cmd || [];
   (function(){ var gads = document.createElement('script');
      gads.async = true; gads.type = 'text/javascript';
      var useSSL = 'https:' == document.location.protocol;
      gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
      var node = document.getElementsByTagName('script')[0];
      node.parentNode.insertBefore(gads, node);
   })();
</script>

<script type="text/javascript">
   googletag.cmd.push(function() {

      var pathname = location.href;
      
      if ( (pathname.indexOf("auth") >= 0) || (pathname.indexOf("security") >= 0) ) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/security', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if ( (pathname.indexOf("crud") >= 0) ||  (pathname.indexOf("query") >= 0) || (pathname.indexOf("insert") >= 0) || (pathname.indexOf("update") >= 0) || (pathname.indexOf("remove") >= 0) || (pathname.indexOf("delete") >= 0) || (pathname.indexOf("aggregation") >= 0) ) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/crud', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("shard") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/sharding', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("replica") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/replication', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("model") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/data-modeling', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("administration") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/support', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("install-mongodb-on-windows") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/install-mongodb-on-windows', [160, 600], 'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("tutorial/getting-started") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/docs_server_gettingstarted', [160, 600], 'mongodb-docs-1').addService(googletag.pubads());
      } else {
         //Adslot 1 declaration
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      }
      googletag.pubads().enableSingleRequest();
      googletag.pubads().enableAsyncRendering();
      googletag.enableServices();
   });
</script>

  <!-- Google Tag Manager -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-GDFN"
                    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
  {'gtm.start':new Date().getTime(),event:'gtm.js'}
  );var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-GDFN');
  </script>
  <!-- End Google Tag Manager -->
      <script>
        window.googleSearchCx = "017213726194841070573:WMX6838984"
	window.googleSearchPlaceholder = "Search Documentation"
        window.googleSearchResultsUrl = "https://www.mongodb.com/docs/manual/search/"
      </script><div class="content" style="margin-top: 0;">

   <div id="left-column">
         <aside id="sidebar" class="sidebar">
             
  <div class="sphinxsidebar" id="sphinxsidebar">
    <div id="sphinxsidebarwrapper" class="sphinxsidebarwrapper"><a href="javascript:void(0)" class="closeNav" id="closeNav">Close &times;</a>


<h3>
  <a class="index-link" href="../index.html">MongoDB Manual</a>
</h3>


    <div class="btn-group version-sidebar">
      
        <button type="button" class="version-button dropdown-toggle" data-toggle="dropdown" disabled="" aria-disabled="disabled">
          
          
          Version 2.2
        </button>
        <a href="https://www.mongodb.com/docs/legacy">&larr; Return to Documentation</a>
      
    </div>


<ul class="current"><li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing MongoDB</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-red-hat-centos-or-fedora-linux.html">Install MongoDB on Red Hat Enterprise, CentOS, or Fedora</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-ubuntu.html">Install MongoDB on Ubuntu</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-debian.html">Install MongoDB on Debian</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-linux.html">Install MongoDB on Linux Systems</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-os-x.html">Install MongoDB on OS X</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-windows.html">Install MongoDB on Windows</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/getting-started.html">Getting Started with MongoDB Development</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a><ul><li class="toctree-l2"><a class="reference internal" href="../administration/configuration.html">Run-time Database Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/operational-segregation.html">Operational Segregation in MongoDB Operations and Deployments</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/journaling.html">Journaling</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/ssl.html">Use MongoDB with SSL Connections</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/snmp.html">Use MongoDB with SNMP Monitoring</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/monitoring.html">Monitoring Database Systems</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/import-export.html">Importing and Exporting MongoDB Data</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/backups.html">Backup Strategies for MongoDB Systems</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/ulimit.html">UNIX <code class="docutils literal"><span class="pre">ulimit</span></code> Settings</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/production-notes.html">Production Notes</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a><ul><li class="toctree-l2"><a class="reference internal" href="../administration/security.html">Security Practices and Management</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/vulnerability-notification.html">Vulnerability Notification</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-linux-iptables-firewall.html">Configure Linux <code class="docutils literal"><span class="pre">iptables</span></code> Firewall for MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-windows-netsh-firewall.html">Configure Windows <code class="docutils literal"><span class="pre">netsh</span></code> Firewall for MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/control-access-to-mongodb-with-authentication.html">Control Access to MongoDB Instances with Authentication</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../crud.html">Core MongoDB Operations (CRUD)</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/read-operations.html">Read Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../core/write-operations.html">Write Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../core/data-modeling.html">Data Modeling Considerations for MongoDB Applications</a></li><li class="toctree-l2"><a class="reference internal" href="../core/document.html">BSON Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../core/object-id.html">ObjectId</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/database-references.html">Database References</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/gridfs.html">GridFS</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/create.html">Create</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/read.html">Read</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/update.html">Update</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/delete.html">Delete</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-embedded-one-to-one-relationships-between-documents.html">Model Embedded One-to-One Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-embedded-one-to-many-relationships-between-documents.html">Model Embedded One-to-Many Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-referenced-one-to-many-relationships-between-documents.html">Model Referenced One-to-Many Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-data-for-atomic-operations.html">Model Data for Atomic Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-parent-references.html">Model Tree Structures with Parent References</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-child-references.html">Model Tree Structures with Child References</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-ancestors-array.html">Model Tree Structures with an Array of Ancestors</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-materialized-paths.html">Model Tree Structures with Materialized Paths</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-nested-sets.html">Model Tree Structures with Nested Sets</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-data-for-keyword-search.html">Model Data to Support Keyword Search</a></li></ul></li><li class="toctree-l1 current"><a class="reference internal" href="../aggregation.html">Aggregation</a><ul class="current"><li class="toctree-l2"><a class="reference internal" href="../applications/aggregation.html">Aggregation Framework</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/aggregation-examples.html">Aggregation Framework Examples</a></li><li class="toctree-l2 current"><a class="reference internal current" href="">Aggregation Framework Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/map-reduce.html">Map-Reduce</a></li><li class="toctree-l2"><a class="reference internal" href="simple-aggregation.html">Simple Aggregation Methods and Commands</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../indexes.html">Indexes</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/indexes.html">Indexing Overview</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/indexes.html">Indexing Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/indexes.html">Indexing Strategies</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/geospatial-indexes.html">Geospatial Queries with <code class="docutils literal"><span class="pre">2d</span></code> Indexes</a></li><li class="toctree-l2"><a class="reference internal" href="../core/geospatial-indexes.html"><code class="docutils literal"><span class="pre">2d</span></code> Geospatial Indexes</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../replication.html">Replication</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/replication.html">Replica Set Fundamental Concepts</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/replica-sets.html">Replica Set Operation and Management</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/replica-set-architectures.html">Replica Set Architectures and Deployment Patterns</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/replication.html">Replica Set Considerations and Behaviors for Applications and Development</a></li><li class="toctree-l2"><a class="reference internal" href="../core/replication-internals.html">Replica Set Internals and Behaviors</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/master-slave.html">Master Slave Replication</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-replica-set.html">Deploy a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-standalone-to-replica-set.html">Convert a Standalone to a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/expand-replica-set.html">Add Members to a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-geographically-distributed-replica-set.html">Deploy a Geographically Distributed Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/change-oplog-size.html">Change the Size of the Oplog</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/force-member-to-be-primary.html">Force a Member to Become Primary</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/change-hostnames-in-a-replica-set.html">Change Hostnames in a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-secondary-into-arbiter.html">Convert a Secondary to an Arbiter</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/reconfigure-replica-set-with-unavailable-members.html">Reconfigure a Replica Set with Unavailable Members</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/recover-data-following-unexpected-shutdown.html">Recover MongoDB Data following Unexpected Shutdown</a></li><li class="toctree-l2"><a class="reference internal" href="replica-commands.html">Replica Set Commands</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/replica-set-features.html">Replica Set Features and Version Compatibility</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../sharding.html">Sharding</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/sharded-clusters.html">Sharded Cluster Overview</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/sharded-clusters.html">Sharded Cluster Administration</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/sharded-cluster-architectures.html">Sharded Cluster Architectures</a></li><li class="toctree-l2"><a class="reference internal" href="../core/sharded-cluster-internals.html">Sharded Cluster Internals and Behaviors</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-shard-cluster.html">Deploy a Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/add-shards-to-shard-cluster.html">Add Shards to a Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/view-sharded-cluster-configuration.html">View Cluster Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-sharded-cluster-config-server.html">Manage the Config Servers</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-chunks-in-sharded-cluster.html">Manage Chunks in a Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-sharded-cluster-balancer.html">Configure Behavior of Balancer Process in Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-sharded-cluster-balancer.html">Manage Sharded Cluster Balancer</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/remove-shards-from-cluster.html">Remove Shards from an Existing Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-small-sharded-cluster-with-mongodump.html">Backup a Small Sharded Cluster with <code class="docutils literal"><span class="pre">mongodump</span></code></a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-sharded-cluster-with-filesystem-snapshots.html">Create Backup of a Sharded Cluster with Filesystem Snapshots</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-sharded-cluster-with-database-dumps.html">Create Backup of a Sharded Cluster with Database Dumps</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/restore-single-shard.html">Restore a Single Shard</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/restore-sharded-cluster.html">Restore Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/schedule-backup-window-for-sharded-clusters.html">Schedule Backup Window for Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../administration/tag-aware-sharding.html">Tag Aware Sharding</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/enforce-unique-keys-for-sharded-collections.html">Enforce Unique Keys for Sharded Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-replica-set-to-replicated-shard-cluster.html">Convert a Replica Set to a Replicated Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="sharding-commands.html">Sharding Commands</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../applications.html">Application Development</a><ul><li class="toctree-l2"><a class="reference internal" href="../applications/drivers.html">MongoDB Drivers and Client Libraries</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/optimization.html">Optimization Strategies for MongoDB Applications</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/server-side-javascript.html">Server-side JavaScript</a></li><li class="toctree-l2"><a class="reference internal" href="../core/capped-collections.html">Capped Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/perform-two-phase-commits.html">Perform Two Phase Commits</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/create-tailable-cursor.html">Create Tailable Cursor</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/isolate-sequence-of-operations.html">Isolate Sequence of Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/create-an-auto-incrementing-field.html">Create an Auto-Incrementing Sequence Field</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/expire-data.html">Expire Data from Collections by Setting TTL</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../mongo.html">Using the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/getting-started-with-the-mongo-shell.html">Getting Started with the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../core/shell-types.html">Data Types in the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/access-mongo-shell-help.html">Access the <code class="docutils literal"><span class="pre">mongo</span></code> Shell Help Information</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/write-scripts-for-the-mongo-shell.html">Write Scripts for the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="mongo-shell.html"><code class="docutils literal"><span class="pre">mongo</span></code> Shell Quick Reference</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../tutorial.html">MongoDB Tutorials</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/use-database-commands.html">Use Database Commands</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/recover-data-following-unexpected-shutdown.html">Recover MongoDB Data following Unexpected Shutdown</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-mongodb-processes.html">Manage <code class="docutils literal"><span class="pre">mongod</span></code> Processes</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-replica-set-to-replicated-shard-cluster.html">Convert a Replica Set to a Replicated Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/copy-databases-between-instances.html">Copy Databases Between Instances</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-databases-with-binary-database-dumps.html">Use <code class="docutils literal"><span class="pre">mongodump</span></code> and <code class="docutils literal"><span class="pre">mongorestore</span></code> to Backup and Restore MongoDB Databases</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-databases-with-filesystem-snapshots.html">Use Filesystem Snapshots to Backup and Restore MongoDB Databases</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-the-database-profiler.html">Analyze Performance of Database Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/rotate-log-files.html">Rotate Log Files</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/roll-back-to-v1.8-index.html">Build Old Style Indexes</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a><ul><li class="toctree-l2"><a class="reference internal" href="../faq/fundamentals.html">FAQ: MongoDB Fundamentals</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/developers.html">FAQ: MongoDB for Application Developers</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/mongo.html">FAQ: The <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/concurrency.html">FAQ: Concurrency</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/sharding.html">FAQ: Sharding with MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/replica-sets.html">FAQ: Replica Sets and Replication in MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/storage.html">FAQ: MongoDB Storage</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/indexes.html">FAQ: Indexes</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/diagnostics.html">FAQ: MongoDB Diagnostics</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a><ul><li class="toctree-l2"><a class="reference internal" href="operator.html">Query, Update, Projection, and Aggregation Operators</a><ul><li class="toctree-l3"><a class="reference internal" href="operator/query/all.html">$all</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/and.html">$and</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/box.html">$box</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/center.html">$center</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/centerSphere.html">$centerSphere</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/elemMatch.html">$elemMatch (query)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/exists.html">$exists</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/gt.html">$gt</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/gte.html">$gte</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/in.html">$in</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/lt.html">$lt</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/lte.html">$lte</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/maxDistance.html">$maxDistance</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/mod.html">$mod</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/ne.html">$ne</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/near.html">$near</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/nearSphere.html">$nearSphere</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/nin.html">$nin</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/nor.html">$nor</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/not.html">$not</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/or.html">$or</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/polygon.html">$polygon</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/regex.html">$regex</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/size.html">$size</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/type.html">$type</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/uniqueDocs.html">$uniqueDocs</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/where.html">$where</a></li><li class="toctree-l3"><a class="reference internal" href="operator/query/within.html">$within</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/addToSet.html">$addToSet</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/bit.html">$bit</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/each.html">$each</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/inc.html">$inc</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/isolated.html">$isolated</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/pop.html">$pop</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/positional.html">$ (update)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/pull.html">$pull</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/pullAll.html">$pullAll</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/push.html">$push</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/pushAll.html">$pushAll</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/rename.html">$rename</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/set.html">$set</a></li><li class="toctree-l3"><a class="reference internal" href="operator/update/unset.html">$unset</a></li><li class="toctree-l3"><a class="reference internal" href="operator/projection/elemMatch.html">$elemMatch (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/projection/positional.html">$ (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/projection/slice.html">$slice (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/comment.html">$comment</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/explain.html">$explain</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/hint.html">$hint</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/max.html">$max</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/maxScan.html">$maxScan</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/min.html">$min</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/natural.html">$natural</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/orderby.html">$orderby</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/query.html">$query</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/returnKey.html">$returnKey</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/showDiskLoc.html">$showDiskLoc</a></li><li class="toctree-l3"><a class="reference internal" href="operator/meta/snapshot.html">$snapshot</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/add.html">$add (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/addToSet.html">$addToSet (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/and.html">$and (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/avg.html">$avg (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/cmp.html">$cmp (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/cond.html">$cond (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/dayOfMonth.html">$dayOfMonth (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/dayOfWeek.html">$dayOfWeek (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/dayOfYear.html">$dayOfYear (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/divide.html">$divide (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/eq.html">$eq (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/first.html">$first (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/group.html">$group (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/gt.html">$gt (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/gte.html">$gte (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/hour.html">$hour (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/ifNull.html">$ifNull (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/last.html">$last (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/limit.html">$limit (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/lt.html">$lt (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/lte.html">$lte (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/match.html">$match (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/max.html">$max (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/min.html">$min (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/minute.html">$minute (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/mod.html">$mod (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/month.html">$month (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/multiply.html">$multiply (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/ne.html">$ne (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/not.html">$not (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/or.html">$or (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/project.html">$project (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/push.html">$push (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/second.html">$second (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/skip.html">$skip (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/sort.html">$sort (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/strcasecmp.html">$strcasecmp (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/substr.html">$substr (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/subtract.html">$subtract (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/sum.html">$sum (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/toLower.html">$toLower (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/toUpper.html">$toUpper (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/unwind.html">$unwind (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/week.html">$week (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="operator/aggregation/year.html">$year (aggregation)</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="command.html">Database Commands</a><ul><li class="toctree-l3"><a class="reference internal" href="command/addShard.html">addShard</a></li><li class="toctree-l3"><a class="reference internal" href="command/aggregate.html">aggregate</a></li><li class="toctree-l3"><a class="reference internal" href="command/applyOps.html">applyOps (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/authenticate.html">authenticate</a></li><li class="toctree-l3"><a class="reference internal" href="command/availableQueryOptions.html">availableQueryOptions (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/buildInfo.html">buildInfo</a></li><li class="toctree-l3"><a class="reference internal" href="command/checkShardingIndex.html">checkShardingIndex (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/clean.html">clean (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/clone.html">clone</a></li><li class="toctree-l3"><a class="reference internal" href="command/cloneCollection.html">cloneCollection</a></li><li class="toctree-l3"><a class="reference internal" href="command/cloneCollectionAsCapped.html">cloneCollectionAsCapped</a></li><li class="toctree-l3"><a class="reference internal" href="command/closeAllDatabases.html">closeAllDatabases (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/collMod.html">collMod</a></li><li class="toctree-l3"><a class="reference internal" href="command/collStats.html">collStats</a></li><li class="toctree-l3"><a class="reference internal" href="command/compact.html">compact</a></li><li class="toctree-l3"><a class="reference internal" href="command/connPoolStats.html">connPoolStats</a></li><li class="toctree-l3"><a class="reference internal" href="command/connPoolSync.html">connPoolSync (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/convertToCapped.html">convertToCapped</a></li><li class="toctree-l3"><a class="reference internal" href="command/copydb.html">copydb</a></li><li class="toctree-l3"><a class="reference internal" href="command/copydbgetnonce.html">copydbgetnonce (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/count.html">count</a></li><li class="toctree-l3"><a class="reference internal" href="command/create.html">create</a></li><li class="toctree-l3"><a class="reference internal" href="command/cursorInfo.html">cursorInfo</a></li><li class="toctree-l3"><a class="reference internal" href="command/dataSize.html">dataSize</a></li><li class="toctree-l3"><a class="reference internal" href="command/dbHash.html">dbHash (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/dbStats.html">dbStats</a></li><li class="toctree-l3"><a class="reference internal" href="command/diagLogging.html">diagLogging (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/distinct.html">distinct</a></li><li class="toctree-l3"><a class="reference internal" href="command/driverOIDTest.html">driverOIDTest (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/drop.html">drop</a></li><li class="toctree-l3"><a class="reference internal" href="command/dropDatabase.html">dropDatabase</a></li><li class="toctree-l3"><a class="reference internal" href="command/dropIndexes.html">dropIndexes</a></li><li class="toctree-l3"><a class="reference internal" href="command/enableSharding.html">enableSharding</a></li><li class="toctree-l3"><a class="reference internal" href="command/eval.html">eval</a></li><li class="toctree-l3"><a class="reference internal" href="command/features.html">features (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/filemd5.html">filemd5</a></li><li class="toctree-l3"><a class="reference internal" href="command/findAndModify.html">findAndModify</a></li><li class="toctree-l3"><a class="reference internal" href="command/flushRouterConfig.html">flushRouterConfig</a></li><li class="toctree-l3"><a class="reference internal" href="command/fsync.html">fsync</a></li><li class="toctree-l3"><a class="reference internal" href="command/geoNear.html">geoNear</a></li><li class="toctree-l3"><a class="reference internal" href="command/geoSearch.html">geoSearch</a></li><li class="toctree-l3"><a class="reference internal" href="command/geoWalk.html">geoWalk</a></li><li class="toctree-l3"><a class="reference internal" href="command/getCmdLineOpts.html">getCmdLineOpts</a></li><li class="toctree-l3"><a class="reference internal" href="command/getLastError.html">getLastError</a></li><li class="toctree-l3"><a class="reference internal" href="command/getLog.html">getLog</a></li><li class="toctree-l3"><a class="reference internal" href="command/getParameter.html">getParameter</a></li><li class="toctree-l3"><a class="reference internal" href="command/getPrevError.html">getPrevError</a></li><li class="toctree-l3"><a class="reference internal" href="command/getShardMap.html">getShardMap (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/getShardVersion.html">getShardVersion (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/getnonce.html">getnonce (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/getoptime.html">getoptime (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/group.html">group</a></li><li class="toctree-l3"><a class="reference internal" href="command/isMaster.html">isMaster</a></li><li class="toctree-l3"><a class="reference internal" href="command/isSelf.html">isSelf (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/isdbgrid.html">isdbgrid</a></li><li class="toctree-l3"><a class="reference internal" href="command/listCommands.html">listCommands</a></li><li class="toctree-l3"><a class="reference internal" href="command/listDatabases.html">listDatabases</a></li><li class="toctree-l3"><a class="reference internal" href="command/listShards.html">listShards</a></li><li class="toctree-l3"><a class="reference internal" href="command/logRotate.html">logRotate</a></li><li class="toctree-l3"><a class="reference internal" href="command/logout.html">logout</a></li><li class="toctree-l3"><a class="reference internal" href="command/mapReduce.html">mapReduce</a></li><li class="toctree-l3"><a class="reference internal" href="command/medianKey.html">medianKey (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/moveChunk.html">moveChunk</a></li><li class="toctree-l3"><a class="reference internal" href="command/movePrimary.html">movePrimary</a></li><li class="toctree-l3"><a class="reference internal" href="command/netstat.html">netstat (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/ping.html">ping</a></li><li class="toctree-l3"><a class="reference internal" href="command/profile.html">profile</a></li><li class="toctree-l3"><a class="reference internal" href="command/reIndex.html">reIndex</a></li><li class="toctree-l3"><a class="reference internal" href="command/removeShard.html">removeShard</a></li><li class="toctree-l3"><a class="reference internal" href="command/renameCollection.html">renameCollection</a></li><li class="toctree-l3"><a class="reference internal" href="command/repairDatabase.html">repairDatabase</a></li><li class="toctree-l3"><a class="reference internal" href="command/replSetFreeze.html">replSetFreeze</a></li><li class="toctree-l3"><a class="reference internal" href="command/replSetGetStatus.html">replSetGetStatus</a></li><li class="toctree-l3"><a class="reference internal" href="command/replSetInitiate.html">replSetInitiate</a></li><li class="toctree-l3"><a class="reference internal" href="command/replSetMaintenance.html">replSetMaintenance</a></li><li class="toctree-l3"><a class="reference internal" href="command/replSetReconfig.html">replSetReconfig</a></li><li class="toctree-l3"><a class="reference internal" href="command/replSetStepDown.html">replSetStepDown</a></li><li class="toctree-l3"><a class="reference internal" href="command/replSetSyncFrom.html">replSetSyncFrom</a></li><li class="toctree-l3"><a class="reference internal" href="command/resetError.html">resetError</a></li><li class="toctree-l3"><a class="reference internal" href="command/resync.html">resync</a></li><li class="toctree-l3"><a class="reference internal" href="command/serverStatus.html">serverStatus</a></li><li class="toctree-l3"><a class="reference internal" href="command/setParameter.html">setParameter</a></li><li class="toctree-l3"><a class="reference internal" href="command/setShardVersion.html">setShardVersion</a></li><li class="toctree-l3"><a class="reference internal" href="command/shardCollection.html">shardCollection</a></li><li class="toctree-l3"><a class="reference internal" href="command/shardingState.html">shardingState</a></li><li class="toctree-l3"><a class="reference internal" href="command/shutdown.html">shutdown</a></li><li class="toctree-l3"><a class="reference internal" href="command/split.html">split</a></li><li class="toctree-l3"><a class="reference internal" href="command/splitChunk.html">splitChunk</a></li><li class="toctree-l3"><a class="reference internal" href="command/splitVector.html">splitVector</a></li><li class="toctree-l3"><a class="reference internal" href="command/top.html">top</a></li><li class="toctree-l3"><a class="reference internal" href="command/touch.html">touch</a></li><li class="toctree-l3"><a class="reference internal" href="command/unsetSharding.html">unsetSharding (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="command/validate.html">validate</a></li><li class="toctree-l3"><a class="reference internal" href="command/whatsmyuri.html">whatsmyuri (internal)</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="method.html">JavaScript Methods</a><ul><li class="toctree-l3"><a class="reference internal" href="method/Date.html">Date()</a></li><li class="toctree-l3"><a class="reference internal" href="method/Mongo.html">Mongo()</a></li><li class="toctree-l3"><a class="reference internal" href="method/Mongo.getDB.html">Mongo.getDB()</a></li><li class="toctree-l3"><a class="reference internal" href="method/ObjectId.getTimestamp.html">ObjectId.getTimestamp()</a></li><li class="toctree-l3"><a class="reference internal" href="method/ObjectId.toString.html">ObjectId.toString()</a></li><li class="toctree-l3"><a class="reference internal" href="method/ObjectId.valueOf.html">ObjectId.valueOf()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cat.html">cat()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cd.html">cd()</a></li><li class="toctree-l3"><a class="reference internal" href="method/connect.html">connect()</a></li><li class="toctree-l3"><a class="reference internal" href="method/copyDbpath.html">copyDbpath()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.addOption.html">cursor.addOption()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.batchSize.html">cursor.batchSize()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.count.html">cursor.count()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.explain.html">cursor.explain()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.forEach.html">cursor.forEach()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.hasNext.html">cursor.hasNext()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.hint.html">cursor.hint()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.limit.html">cursor.limit()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.map.html">cursor.map()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.max.html">cursor.max()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.min.html">cursor.min()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.next.html">cursor.next()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.objsLeftInBatch.html">cursor.objsLeftInBatch()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.readPref.html">cursor.readPref()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.showDiskLoc.html">cursor.showDiskLoc()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.size.html">cursor.size()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.skip.html">cursor.skip()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.snapshot.html">cursor.snapshot()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.sort.html">cursor.sort()</a></li><li class="toctree-l3"><a class="reference internal" href="method/cursor.toArray.html">cursor.toArray()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.addUser.html">db.addUser()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.auth.html">db.auth()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.cloneCollection.html">db.cloneCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.cloneDatabase.html">db.cloneDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.aggregate.html">db.collection.aggregate()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.copyTo.html">db.collection.copyTo()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.count.html">db.collection.count()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.createIndex.html">db.collection.createIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.dataSize.html">db.collection.dataSize()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.distinct.html">db.collection.distinct()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.drop.html">db.collection.drop()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.dropIndex.html">db.collection.dropIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.dropIndexes.html">db.collection.dropIndexes()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.ensureIndex.html">db.collection.ensureIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.find.html">db.collection.find()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.findAndModify.html">db.collection.findAndModify()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.findOne.html">db.collection.findOne()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.getIndexes.html">db.collection.getIndexes()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.getShardDistribution.html">db.collection.getShardDistribution()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.getShardVersion.html">db.collection.getShardVersion()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.group.html">db.collection.group()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.insert.html">db.collection.insert()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.isCapped.html">db.collection.isCapped()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.mapReduce.html">db.collection.mapReduce()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.reIndex.html">db.collection.reIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.remove.html">db.collection.remove()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.renameCollection.html">db.collection.renameCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.save.html">db.collection.save()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.stats.html">db.collection.stats()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.storageSize.html">db.collection.storageSize()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.totalIndexSize.html">db.collection.totalIndexSize()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.totalSize.html">db.collection.totalSize()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.update.html">db.collection.update()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.collection.validate.html">db.collection.validate()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.commandHelp.html">db.commandHelp()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.copyDatabase.html">db.copyDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.createCollection.html">db.createCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.currentOp.html">db.currentOp()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.dropDatabase.html">db.dropDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.eval.html">db.eval()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.fsyncLock.html">db.fsyncLock()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.fsyncUnlock.html">db.fsyncUnlock()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getCollection.html">db.getCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getCollectionNames.html">db.getCollectionNames()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getLastError.html">db.getLastError()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getLastErrorObj.html">db.getLastErrorObj()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getMongo.html">db.getMongo()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getName.html">db.getName()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getPrevError.html">db.getPrevError()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getProfilingLevel.html">db.getProfilingLevel()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getProfilingStatus.html">db.getProfilingStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getReplicationInfo.html">db.getReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.getSiblingDB.html">db.getSiblingDB()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.help.html">db.help()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.isMaster.html">db.isMaster()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.killOp.html">db.killOp()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.listCommands.html">db.listCommands()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.loadServerScripts.html">db.loadServerScripts()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.logout.html">db.logout()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.printCollectionStats.html">db.printCollectionStats()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.printReplicationInfo.html">db.printReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.printShardingStatus.html">db.printShardingStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.printSlaveReplicationInfo.html">db.printSlaveReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.removeUser.html">db.removeUser()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.repairDatabase.html">db.repairDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.resetError.html">db.resetError()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.runCommand.html">db.runCommand()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.serverBuildInfo.html">db.serverBuildInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.serverStatus.html">db.serverStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.setProfilingLevel.html">db.setProfilingLevel()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.shutdownServer.html">db.shutdownServer()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.stats.html">db.stats()</a></li><li class="toctree-l3"><a class="reference internal" href="method/db.version.html">db.version()</a></li><li class="toctree-l3"><a class="reference internal" href="method/fuzzFile.html">fuzzFile()</a></li><li class="toctree-l3"><a class="reference internal" href="method/getHostName.html">getHostName()</a></li><li class="toctree-l3"><a class="reference internal" href="method/getMemInfo.html">getMemInfo</a></li><li class="toctree-l3"><a class="reference internal" href="method/hostname.html">hostname()</a></li><li class="toctree-l3"><a class="reference internal" href="method/isWindows.html">_isWindows()</a></li><li class="toctree-l3"><a class="reference internal" href="method/listFiles.html">listFiles()</a></li><li class="toctree-l3"><a class="reference internal" href="method/load.html">load()</a></li><li class="toctree-l3"><a class="reference internal" href="method/ls.html">ls()</a></li><li class="toctree-l3"><a class="reference internal" href="method/md5sumFile.html">md5sumFile()</a></li><li class="toctree-l3"><a class="reference internal" href="method/mkdir.html">mkdir()</a></li><li class="toctree-l3"><a class="reference internal" href="method/pwd.html">pwd()</a></li><li class="toctree-l3"><a class="reference internal" href="method/quit.html">quit()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rand.html">rand()</a></li><li class="toctree-l3"><a class="reference internal" href="method/removeFile.html">removeFile()</a></li><li class="toctree-l3"><a class="reference internal" href="method/resetDbpath.html">resetDbpath()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.add.html">rs.add()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.addArb.html">rs.addArb()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.conf.html">rs.conf()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.freeze.html">rs.freeze()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.help.html">rs.help()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.initiate.html">rs.initiate()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.reconfig.html">rs.reconfig()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.remove.html">rs.remove()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.status.html">rs.status()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.stepDown.html">rs.stepDown()</a></li><li class="toctree-l3"><a class="reference internal" href="method/rs.syncFrom.html">rs.syncFrom()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.addShard.html">sh.addShard()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.addShardTag.html">sh.addShardTag()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.addTagRange.html">sh.addTagRange()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.disableBalancing.html">sh.disableBalancing()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.enableBalancing.html">sh.enableBalancing()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.enableSharding.html">sh.enableSharding()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.getBalancerHost.html">sh.getBalancerHost()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.getBalancerState.html">sh.getBalancerState()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.help.html">sh.help()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.isBalancerRunning.html">sh.isBalancerRunning()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.moveChunk.html">sh.moveChunk()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.removeShardTag.html">sh.removeShardTag()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.setBalancerState.html">sh.setBalancerState()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.shardCollection.html">sh.shardCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.splitAt.html">sh.splitAt()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.splitFind.html">sh.splitFind()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.startBalancer.html">sh.startBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.status.html">sh.status()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.stopBalancer.html">sh.stopBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.waitForBalancer.html">sh.waitForBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.waitForBalancerOff.html">sh.waitForBalancerOff()</a></li><li class="toctree-l3"><a class="reference internal" href="method/sh.waitForPingChange.html">sh.waitForPingChange()</a></li><li class="toctree-l3"><a class="reference internal" href="method/srand.html">_srand()</a></li><li class="toctree-l3"><a class="reference internal" href="method/version.html">version()</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="sql-comparison.html">SQL to MongoDB Mapping Chart</a></li><li class="toctree-l2"><a class="reference internal" href="sql-aggregation-comparison.html">SQL to Aggregation Mapping Chart</a></li><li class="toctree-l2"><a class="reference internal" href="operators.html">Query, Update, and Projection Operators Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="meta-query-operators.html">Meta Query Operator Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="commands.html">Database Commands Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="javascript.html"><code class="docutils literal"><span class="pre">mongo</span></code> Shell JavaScript Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="components.html">MongoDB Package Components</a><ul><li class="toctree-l3"><a class="reference internal" href="mongod.html"><code class="docutils literal"><span class="pre">mongod</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongos.html"><code class="docutils literal"><span class="pre">mongos</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongo.html"><code class="docutils literal"><span class="pre">mongo</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongod.exe.html"><code class="docutils literal"><span class="pre">mongod.exe</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongos.exe.html"><code class="docutils literal"><span class="pre">mongos.exe</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongodump.html"><code class="docutils literal"><span class="pre">mongodump</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongorestore.html"><code class="docutils literal"><span class="pre">mongorestore</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="bsondump.html"><code class="docutils literal"><span class="pre">bsondump</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongooplog.html"><code class="docutils literal"><span class="pre">mongooplog</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongoimport.html"><code class="docutils literal"><span class="pre">mongoimport</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongoexport.html"><code class="docutils literal"><span class="pre">mongoexport</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongostat.html"><code class="docutils literal"><span class="pre">mongostat</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongotop.html"><code class="docutils literal"><span class="pre">mongotop</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongosniff.html"><code class="docutils literal"><span class="pre">mongosniff</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongoperf.html"><code class="docutils literal"><span class="pre">mongoperf</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="mongofiles.html"><code class="docutils literal"><span class="pre">mongofiles</span></code></a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="configuration-options.html">Configuration File Options</a></li><li class="toctree-l2"><a class="reference internal" href="connection-string.html">Connection String URI Format</a></li><li class="toctree-l2"><a class="reference internal" href="server-status-index.html">Server Status Output Index</a></li><li class="toctree-l2"><a class="reference internal" href="server-status.html">Server Status Reference</a></li><li class="toctree-l2"><a class="reference internal" href="database-statistics.html">Database Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="collection-statistics.html">Collection Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="collection-validation.html">Collection Validation Data</a></li><li class="toctree-l2"><a class="reference internal" href="connection-pool-stats.html">Connection Pool Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="replica-status.html">Replica Set Status Reference</a></li><li class="toctree-l2"><a class="reference internal" href="replica-configuration.html">Replica Set Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="replication-info.html">Replication Info Reference</a></li><li class="toctree-l2"><a class="reference internal" href="current-op.html">Current Operation Reporting</a></li><li class="toctree-l2"><a class="reference internal" href="database-profiler.html">Database Profiler Output</a></li><li class="toctree-l2"><a class="reference internal" href="explain.html">Explain Output</a></li><li class="toctree-l2"><a class="reference internal" href="exit-codes.html">Exit Codes and Statuses</a></li><li class="toctree-l2"><a class="reference internal" href="config-database.html">Config Database Contents</a></li><li class="toctree-l2"><a class="reference internal" href="local-database.html">The <code class="docutils literal"><span class="pre">local</span></code> Database</a></li><li class="toctree-l2"><a class="reference internal" href="system-collections.html">System Collections</a></li><li class="toctree-l2"><a class="reference internal" href="limits.html">MongoDB Limits and Thresholds</a></li><li class="toctree-l2"><a class="reference internal" href="mongodb-extended-json.html">MongoDB Extended JSON</a></li><li class="toctree-l2"><a class="reference internal" href="glossary.html">Glossary</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/2.2.html">Release Notes for MongoDB 2.2</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/2.0.html">Release Notes for MongoDB 2.0</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.8.html">Release Notes for MongoDB 1.8</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.6.html">Release Notes for MongoDB 1.6</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.4.html">Release Notes for MongoDB 1.4</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.2.html">Release Notes for MongoDB 1.2.x</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/drivers-write-concern.html">Default Write Concern Change</a></li></ul></li></ul>


    </div>
  </div>
           
         </aside>

   </div>

    <div id="main-column" class="main-column">

    <span id="showNav" class="showNav">Navigation</span>

      
            <div class="alert alert-warning">
              <span class="alert-message">This version of the documentation is archived and no longer supported.</span>
            </div>
      
        <div class="document">
            <div class="documentwrapper"><div class="bodywrapper">
              <div class="body" data-pagename="reference/aggregation">
                   <a class="edit-link" href="https://github.com/mongodb/docs/blob/v2.2/source/reference/aggregation.txt" target="_blank" title="Edit reference/aggregation.txt on GitHub">
    
      <span class="icon-edit"></span>
    
  </a>
                

                
  <div class="bc">
    
      <ul>
          <li><a href="../aggregation.html">Aggregation</a><span class="bcpoint"> &gt; </span></li>
            <li>Aggregation Framework Reference</li> 
      </ul>
    
    
  </div>
                
                  <div class="section" id="aggregation-framework-reference">
<h1>Aggregation Framework Reference<a class="headerlink" href="#aggregation-framework-reference" title="Permalink to this headline">&para;</a></h1>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.1.0.</span></p>
</div>
<div class="contents singlecol local topic" id="on-this-page">
<p class="topic-title first">On this page</p>
<ul class="simple">
<li><a class="reference internal" href="#pipeline" id="id46">Pipeline</a></li>
<li><a class="reference internal" href="#expressions" id="id47">Expressions</a></li>
</ul>
</div>
<p>The aggregation framework provides the ability to project, process,
and/or control the output of the query, without using <a class="reference internal" href="glossary.html#term-map-reduce"><span class="xref std std-term">map-reduce</span></a>.
Aggregation uses a syntax that resembles the same syntax and
form as &ldquo;regular&rdquo; MongoDB database queries.</p>
<p>These aggregation operations are all accessible by way of the
<a class="reference internal" href="method/db.collection.aggregate.html#db.collection.aggregate" title="db.collection.aggregate()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">aggregate()</span></code></a> method. While all examples in this document use this
method, <a class="reference internal" href="method/db.collection.aggregate.html#db.collection.aggregate" title="db.collection.aggregate()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">aggregate()</span></code></a> is merely a wrapper around the
<a class="reference internal" href="glossary.html#term-database-command"><span class="xref std std-term">database command</span></a> <a class="reference internal" href="command/aggregate.html#dbcmd.aggregate" title="aggregate"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">aggregate</span></code></a>. The
following prototype aggregation operations are equivalent:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span> <span class="o">&lt;</span><span class="nx">pipeline</span><span class="o">&gt;</span> <span class="p">)</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">people</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">pipeline</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">)</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">runCommand</span><span class="p">(</span> <span class="p">{</span> <span class="nx">aggregate</span><span class="o">:</span> <span class="s2">&#34;people&#34;</span><span class="p">,</span> <span class="nx">pipeline</span><span class="o">:</span> <span class="p">[</span><span class="o">&lt;</span><span class="nx">pipeline</span><span class="o">&gt;</span><span class="p">]</span> <span class="p">}</span> <span class="p">)</span>
</pre></div>
</div>
</div>
<p>These operations perform aggregation routines on the
collection named <code class="docutils literal"><span class="pre">people</span></code>. <code class="docutils literal"><span class="pre">&lt;pipeline&gt;</span></code> is a placeholder for the
aggregation <a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a> definition. <a class="reference internal" href="method/db.collection.aggregate.html#db.collection.aggregate" title="db.collection.aggregate()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">aggregate()</span></code></a>
accepts the stages of the pipeline (i.e. <code class="docutils literal"><span class="pre">&lt;pipeline&gt;</span></code>) as an array,
or as arguments to the method.</p>
<p>This documentation provides an overview of all aggregation operators
available for use in the aggregation pipeline as well as details
regarding their use and behavior.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../applications/aggregation.html"><span class="doc">Aggregation Framework</span></a> overview, the
<a class="reference internal" href="../aggregation.html#aggregation-framework"><span class="std std-ref">Aggregation Framework Documentation Index</span></a>, and the
<a class="reference internal" href="../tutorial/aggregation-examples.html"><span class="doc">Aggregation Framework Examples</span></a> for more information on the
aggregation functionality.</p>
</div>
<div class="contents local topic" id="aggregation-operators">
<p class="topic-title first">Aggregation Operators:</p>
<ul class="simple">
<li><a class="reference internal" href="#pipeline" id="id48">Pipeline</a></li>
<li><a class="reference internal" href="#expressions" id="id49">Expressions</a><ul>
<li><a class="reference internal" href="#group-operators" id="id50"><code class="docutils literal"><span class="pre">$group</span></code> Operators</a></li>
<li><a class="reference internal" href="#boolean-operators" id="id51">Boolean Operators</a></li>
<li><a class="reference internal" href="#comparison-operators" id="id52">Comparison Operators</a></li>
<li><a class="reference internal" href="#arithmetic-operators" id="id53">Arithmetic Operators</a></li>
<li><a class="reference internal" href="#string-operators" id="id54">String Operators</a></li>
<li><a class="reference internal" href="#date-operators" id="id55">Date Operators</a></li>
<li><a class="reference internal" href="#conditional-expressions" id="id56">Conditional Expressions</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="pipeline">
<span id="aggregation-pipeline-operator-reference"></span><h2>Pipeline<a class="headerlink" href="#pipeline" title="Permalink to this headline">&para;</a></h2>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The pipeline cannot operate on values of the following types:
<code class="docutils literal"><span class="pre">Binary</span></code>, <code class="docutils literal"><span class="pre">Symbol</span></code>, <code class="docutils literal"><span class="pre">MinKey</span></code>, <code class="docutils literal"><span class="pre">MaxKey</span></code>, <code class="docutils literal"><span class="pre">DBRef</span></code>,
<code class="docutils literal"><span class="pre">Code</span></code>, and <code class="docutils literal"><span class="pre">CodeWScope</span></code>.</p>
</div>
<p>Pipeline operators appear in an array. Conceptually, documents pass through
these operators in a sequence. All examples in this section assume that the
aggregation pipeline begins with a collection named <code class="docutils literal"><span class="pre">article</span></code> that
contains documents that resemble the following:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nx">title</span> <span class="o">:</span> <span class="s2">&#34;this is my title&#34;</span> <span class="p">,</span>
  <span class="nx">author</span> <span class="o">:</span> <span class="s2">&#34;bob&#34;</span> <span class="p">,</span>
  <span class="nx">posted</span> <span class="o">:</span> <span class="k">new</span> <span class="nb">Date</span><span class="p">()</span> <span class="p">,</span>
  <span class="nx">pageViews</span> <span class="o">:</span> <span class="mi">5</span> <span class="p">,</span>
  <span class="nx">tags</span> <span class="o">:</span> <span class="p">[</span> <span class="s2">&#34;fun&#34;</span> <span class="p">,</span> <span class="s2">&#34;good&#34;</span> <span class="p">,</span> <span class="s2">&#34;fun&#34;</span> <span class="p">]</span> <span class="p">,</span>
  <span class="nx">comments</span> <span class="o">:</span> <span class="p">[</span>
      <span class="p">{</span> <span class="nx">author</span> <span class="o">:</span><span class="s2">&#34;joe&#34;</span> <span class="p">,</span> <span class="nx">text</span> <span class="o">:</span> <span class="s2">&#34;this is cool&#34;</span> <span class="p">}</span> <span class="p">,</span>
      <span class="p">{</span> <span class="nx">author</span> <span class="o">:</span><span class="s2">&#34;sam&#34;</span> <span class="p">,</span> <span class="nx">text</span> <span class="o">:</span> <span class="s2">&#34;this is bad&#34;</span> <span class="p">}</span>
  <span class="p">],</span>
  <span class="nx">other</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">foo</span> <span class="o">:</span> <span class="mi">5</span> <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>The current pipeline operators are:</p>
<dl class="pipeline">
<dt id="pipe._S_project">
<code class="descname">$project</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-107"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-177"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#pipe._S_project" title="Permalink to this definition">&para;</a></dt>
<dd><p>Reshapes a document stream by renaming, adding, or removing
fields. Also use <a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> to create computed values or
sub-documents. Use <a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> to:</p>
<ul class="simple">
<li>Include fields from the original document.</li>
<li>Insert computed fields.</li>
<li>Rename fields.</li>
<li>Create and populate fields that hold sub-documents.</li>
</ul>
<p>Use <a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> to quickly select the fields that you
want to include or exclude from the response. Consider the
following aggregation framework operation.</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$project</span> <span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">,</span>
        <span class="nx">author</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">,</span>
    <span class="p">}}</span>
 <span class="p">);</span>
</pre></div>
</div>
</div>
<p>This operation includes the <code class="docutils literal"><span class="pre">title</span></code> field and the <code class="docutils literal"><span class="pre">author</span></code>
field in the document that returns from the aggregation
<a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <code class="docutils literal"><span class="pre">_id</span></code> field is always included by default. You may
explicitly exclude <code class="docutils literal"><span class="pre">_id</span></code> as follows:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$project</span> <span class="o">:</span> <span class="p">{</span>
        <span class="nx">_id</span> <span class="o">:</span> <span class="mi">0</span> <span class="p">,</span>
        <span class="nx">title</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">,</span>
        <span class="nx">author</span> <span class="o">:</span> <span class="mi">1</span>
    <span class="p">}}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p class="last">Here, the projection excludes the <code class="docutils literal"><span class="pre">_id</span></code> field but includes the
<code class="docutils literal"><span class="pre">title</span></code> and <code class="docutils literal"><span class="pre">author</span></code> fields.</p>
</div>
<p>Projections can also add computed fields to the document stream
passing through the pipeline. A computed field can use any of the
<a class="reference internal" href="#aggregation-expression-operators"><span class="std std-ref">expression operators</span></a>.
Consider the following example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$project</span> <span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span> <span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="nx">doctoredPageViews</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">$add</span><span class="o">:</span><span class="p">[</span><span class="s2">&#34;$pageViews&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="p">}</span>
    <span class="p">}}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>Here, the field <code class="docutils literal"><span class="pre">doctoredPageViews</span></code> represents the value of the
<code class="docutils literal"><span class="pre">pageViews</span></code> field after adding 10 to the original field using the
<a class="reference internal" href="operator/aggregation/add.html#exp._S_add" title="$add"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$add</span></code></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must enclose the expression that defines the computed field
in braces, so that the expression is a valid object.</p>
</div>
<p>You may also use <a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> to rename fields. Consider
the following example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$project</span> <span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">,</span>
        <span class="nx">page_views</span> <span class="o">:</span> <span class="s2">&#34;$pageViews&#34;</span> <span class="p">,</span>
        <span class="nx">bar</span> <span class="o">:</span> <span class="s2">&#34;$other.foo&#34;</span>
    <span class="p">}}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This operation renames the <code class="docutils literal"><span class="pre">pageViews</span></code> field to <code class="docutils literal"><span class="pre">page_views</span></code>,
and renames the <code class="docutils literal"><span class="pre">foo</span></code> field in the <code class="docutils literal"><span class="pre">other</span></code> sub-document as
the top-level field <code class="docutils literal"><span class="pre">bar</span></code>. The field references used for
renaming fields are direct expressions and do not use an operator
or surrounding braces. All aggregation field references can use
dotted paths to refer to fields in nested documents.</p>
<p>Finally, you can use the <a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> to create and
populate new sub-documents. Consider the following example that
creates a new object-valued field named <code class="docutils literal"><span class="pre">stats</span></code> that holds a number
of values:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$project</span> <span class="o">:</span> <span class="p">{</span>
        <span class="nx">title</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">,</span>
        <span class="nx">stats</span> <span class="o">:</span> <span class="p">{</span>
            <span class="nx">pv</span> <span class="o">:</span> <span class="s2">&#34;$pageViews&#34;</span><span class="p">,</span>
            <span class="nx">foo</span> <span class="o">:</span> <span class="s2">&#34;$other.foo&#34;</span><span class="p">,</span>
            <span class="nx">dpv</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">$add</span><span class="o">:</span><span class="p">[</span><span class="s2">&#34;$pageViews&#34;</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span> <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This projection includes the <code class="docutils literal"><span class="pre">title</span></code> field and places
<a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> into &ldquo;inclusive&rdquo; mode. Then, it creates the
<code class="docutils literal"><span class="pre">stats</span></code> documents with the following fields:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">pv</span></code> which includes and renames the <code class="docutils literal"><span class="pre">pageViews</span></code> from the
top level of the original documents.</li>
<li><code class="docutils literal"><span class="pre">foo</span></code> which includes the value of <code class="docutils literal"><span class="pre">other.foo</span></code> from the
original documents.</li>
<li><code class="docutils literal"><span class="pre">dpv</span></code> which is a computed field that adds 10 to the value of
the <code class="docutils literal"><span class="pre">pageViews</span></code> field in the original document using the
<a class="reference internal" href="operator/aggregation/add.html#exp._S_add" title="$add"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$add</span></code></a> aggregation expression.</li>
</ul>
</dd></dl>

<dl class="pipeline">
<dt id="pipe._S_match">
<code class="descname">$match</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-108"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-178"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#pipe._S_match" title="Permalink to this definition">&para;</a></dt>
<dd><p>Provides a query-like interface to filter documents out of the
aggregation <a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a>. The <a class="reference internal" href="operator/aggregation/match.html#pipe._S_match" title="$match"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$match</span></code></a> drops
documents that do not match the condition from the aggregation
pipeline, and it passes documents that match along the pipeline
unaltered.</p>
<p>The syntax passed to the <a class="reference internal" href="operator/aggregation/match.html#pipe._S_match" title="$match"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$match</span></code></a> is identical
to the <a class="reference internal" href="glossary.html#term-query"><span class="xref std std-term">query</span></a> syntax. Consider the following prototype form:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$match</span> <span class="o">:</span> <span class="o">&lt;</span><span class="nx">match</span><span class="o">-</span><span class="nx">predicate</span><span class="o">&gt;</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>The following example performs a simple field equality test:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$match</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">author</span> <span class="o">:</span> <span class="s2">&#34;dave&#34;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This operation only returns documents where the <code class="docutils literal"><span class="pre">author</span></code> field
holds the value <code class="docutils literal"><span class="pre">dave</span></code>. Consider the following example,
which performs a range test:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$match</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">score</span>  <span class="o">:</span> <span class="p">{</span> <span class="nx">$gt</span> <span class="o">:</span> <span class="mi">50</span><span class="p">,</span> <span class="nx">$lte</span> <span class="o">:</span> <span class="mi">90</span> <span class="p">}</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>Here, all documents return when the <code class="docutils literal"><span class="pre">score</span></code> field holds a value
that is greater than 50 and less than or equal to 90.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Place the <a class="reference internal" href="operator/aggregation/match.html#pipe._S_match" title="$match"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$match</span></code></a> as early in the aggregation
<a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a> as possible. Because <a class="reference internal" href="operator/aggregation/match.html#pipe._S_match" title="$match"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$match</span></code></a>
limits the total number of documents in the aggregation
pipeline, earlier <a class="reference internal" href="operator/aggregation/match.html#pipe._S_match" title="$match"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$match</span></code></a> operations minimize the
amount of later processing. If you place a <a class="reference internal" href="operator/aggregation/match.html#pipe._S_match" title="$match"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$match</span></code></a>
at the very beginning of a pipeline, the query can take
advantage of <a class="reference internal" href="glossary.html#term-index"><span class="xref std std-term">indexes</span></a> like any other
<a class="reference internal" href="method/db.collection.find.html#db.collection.find" title="db.collection.find()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.find()</span></code></a> or <a class="reference internal" href="method/db.collection.findOne.html#db.collection.findOne" title="db.collection.findOne()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.findOne()</span></code></a>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">You cannot use <a class="reference internal" href="operator/query/where.html#op._S_where" title="$where"><code class="xref mongodb mongodb-query docutils literal"><span class="pre">$where</span></code></a> or <a class="reference internal" href="operators.html#geospatial-query-operators"><span class="std std-ref">geospatial
operations</span></a> in <a class="reference internal" href="operator/aggregation/match.html#pipe._S_match" title="$match"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$match</span></code></a>
queries as part of the aggregation pipeline.</p>
</div>
</dd></dl>

<dl class="pipeline">
<dt id="pipe._S_limit">
<code class="descname">$limit</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-109"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-179"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#pipe._S_limit" title="Permalink to this definition">&para;</a></dt>
<dd><p>Restricts the number of <a class="reference internal" href="glossary.html#term-document"><span class="xref std std-term">documents</span></a> that
pass through the <a class="reference internal" href="operator/aggregation/limit.html#pipe._S_limit" title="$limit"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$limit</span></code></a> in the <a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a>.</p>
<p><a class="reference internal" href="operator/aggregation/limit.html#pipe._S_limit" title="$limit"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$limit</span></code></a> takes a single numeric (positive whole number)
value as a parameter. Once the specified number of documents pass
through the pipeline operator, no more will. Consider the following
example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$limit</span> <span class="o">:</span> <span class="mi">5</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This operation returns only the first 5 documents passed to it from
by the pipeline. <a class="reference internal" href="operator/aggregation/limit.html#pipe._S_limit" title="$limit"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$limit</span></code></a> has no effect on the content
of the documents it passes.</p>
</dd></dl>

<dl class="pipeline">
<dt id="pipe._S_skip">
<code class="descname">$skip</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-110"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-180"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#pipe._S_skip" title="Permalink to this definition">&para;</a></dt>
<dd><p>Skips over the specified number of <a class="reference internal" href="glossary.html#term-document"><span class="xref std std-term">documents</span></a>
that pass through the <a class="reference internal" href="operator/aggregation/skip.html#pipe._S_skip" title="$skip"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$skip</span></code></a> in the <a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a>
before passing all of the remaining input.</p>
<p><a class="reference internal" href="operator/aggregation/skip.html#pipe._S_skip" title="$skip"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$skip</span></code></a> takes a single numeric (positive whole number)
value as a parameter. Once the operation has skipped the specified
number of documents, it passes all the remaining documents along the
<a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a> without alteration. Consider the following
example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$skip</span> <span class="o">:</span> <span class="mi">5</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This operation skips the first 5 documents passed to it by the
pipeline. <a class="reference internal" href="operator/aggregation/skip.html#pipe._S_skip" title="$skip"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$skip</span></code></a> has no effect on the content of the
documents it passes along the pipeline.</p>
</dd></dl>

<dl class="pipeline">
<dt id="pipe._S_unwind">
<code class="descname">$unwind</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-111"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-181"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#pipe._S_unwind" title="Permalink to this definition">&para;</a></dt>
<dd><p>Peels off the elements of an array individually, and returns a
stream of documents. <a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> returns one document for
every member of the unwound array within every source
document. Take the following aggregation command:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$project</span> <span class="o">:</span> <span class="p">{</span>
        <span class="nx">author</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">,</span>
        <span class="nx">title</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">,</span>
        <span class="nx">tags</span> <span class="o">:</span> <span class="mi">1</span>
    <span class="p">}},</span>
    <span class="p">{</span> <span class="nx">$unwind</span> <span class="o">:</span> <span class="s2">&#34;$tags&#34;</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The dollar sign (i.e. <code class="docutils literal"><span class="pre">$</span></code>) must proceed the field
specification handed to the <a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> operator.</p>
</div>
<p>In the above aggregation <a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> selects
(inclusively) the <code class="docutils literal"><span class="pre">author</span></code>, <code class="docutils literal"><span class="pre">title</span></code>, and <code class="docutils literal"><span class="pre">tags</span></code> fields, as
well as the <code class="docutils literal"><span class="pre">_id</span></code> field implicitly. Then the pipeline passes the
results of the projection to the <a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> operator,
which will unwind the <code class="docutils literal"><span class="pre">tags</span></code> field. This operation may return
a sequence of documents that resemble the following for a
collection that contains one document holding a <code class="docutils literal"><span class="pre">tags</span></code> field
with an array of 3 items.</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span>
     <span class="s2">&#34;result&#34;</span> <span class="o">:</span> <span class="p">[</span>
             <span class="p">{</span>
                     <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;4e6e4ef557b77501a49233f6&#34;</span><span class="p">),</span>
                     <span class="s2">&#34;title&#34;</span> <span class="o">:</span> <span class="s2">&#34;this is my title&#34;</span><span class="p">,</span>
                     <span class="s2">&#34;author&#34;</span> <span class="o">:</span> <span class="s2">&#34;bob&#34;</span><span class="p">,</span>
                     <span class="s2">&#34;tags&#34;</span> <span class="o">:</span> <span class="s2">&#34;fun&#34;</span>
             <span class="p">},</span>
             <span class="p">{</span>
                     <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;4e6e4ef557b77501a49233f6&#34;</span><span class="p">),</span>
                     <span class="s2">&#34;title&#34;</span> <span class="o">:</span> <span class="s2">&#34;this is my title&#34;</span><span class="p">,</span>
                     <span class="s2">&#34;author&#34;</span> <span class="o">:</span> <span class="s2">&#34;bob&#34;</span><span class="p">,</span>
                     <span class="s2">&#34;tags&#34;</span> <span class="o">:</span> <span class="s2">&#34;good&#34;</span>
             <span class="p">},</span>
             <span class="p">{</span>
                     <span class="s2">&#34;_id&#34;</span> <span class="o">:</span> <span class="nx">ObjectId</span><span class="p">(</span><span class="s2">&#34;4e6e4ef557b77501a49233f6&#34;</span><span class="p">),</span>
                     <span class="s2">&#34;title&#34;</span> <span class="o">:</span> <span class="s2">&#34;this is my title&#34;</span><span class="p">,</span>
                     <span class="s2">&#34;author&#34;</span> <span class="o">:</span> <span class="s2">&#34;bob&#34;</span><span class="p">,</span>
                     <span class="s2">&#34;tags&#34;</span> <span class="o">:</span> <span class="s2">&#34;fun&#34;</span>
             <span class="p">}</span>
     <span class="p">],</span>
     <span class="s2">&#34;OK&#34;</span> <span class="o">:</span> <span class="mi">1</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>A single document becomes 3 documents: each document is identical
except for the value of the <code class="docutils literal"><span class="pre">tags</span></code> field. Each value of <code class="docutils literal"><span class="pre">tags</span></code>
is one of the values in the original &ldquo;tags&rdquo; array.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> has the following behaviors:</p>
<ul class="last simple">
<li><a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> is most useful in combination
with <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a>.</li>
<li>You may undo the effects of unwind operation with the
<a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> pipeline operator.</li>
<li>If you specify a target field for <a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> that
does not exist in an input document, the pipeline ignores the
input document, and will generate no result documents.</li>
<li>If you specify a target field for <a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> that is
not an array, <a class="reference internal" href="method/db.collection.aggregate.html#db.collection.aggregate" title="db.collection.aggregate()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.collection.aggregate()</span></code></a> generates an error.</li>
<li>If you specify a target field for <a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a> that
holds an empty array (<code class="docutils literal"><span class="pre">[]</span></code>) in an input document, the
pipeline ignores the input document, and will generates no
result documents.</li>
</ul>
</div>
</dd></dl>

<dl class="pipeline">
<dt id="pipe._S_group">
<code class="descname">$group</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-112"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-182"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#pipe._S_group" title="Permalink to this definition">&para;</a></dt>
<dd><p>Groups documents together for the purpose of calculating aggregate
values based on a collection of documents. Practically, group often
supports tasks such as average page views for each page in a
website on a daily basis.</p>
<p>The output of <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> depends on how you define
groups. Begin by specifying an identifier (i.e. a <code class="docutils literal"><span class="pre">_id</span></code> field)
for the group you&rsquo;re creating with this pipeline. You can specify a
single field from the documents in the pipeline, a previously
computed value, or an aggregate key made up from several incoming
fields. Aggregate keys may resemble the following document:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nx">_id</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">author</span><span class="o">:</span> <span class="s1">&#39;$author&#39;</span><span class="p">,</span> <span class="nx">pageViews</span><span class="o">:</span> <span class="s1">&#39;$pageViews&#39;</span><span class="p">,</span> <span class="nx">posted</span><span class="o">:</span> <span class="s1">&#39;$posted&#39;</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>With the exception of the <code class="docutils literal"><span class="pre">_id</span></code> field, <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> cannot
output nested documents.</p>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">The output of <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> is not ordered.</p>
</div>
<p>Every group expression must specify an <code class="docutils literal"><span class="pre">_id</span></code> field.
You may specify the <code class="docutils literal"><span class="pre">_id</span></code> field as a dotted
field path reference, a document with multiple fields enclosed in
braces (i.e. <code class="docutils literal"><span class="pre">{</span></code> and <code class="docutils literal"><span class="pre">}</span></code>), or a constant value.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Use <a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a> as needed to rename the grouped field
after an <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> operation, if necessary.</p>
</div>
<p>Consider the following example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">article</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$group</span> <span class="o">:</span> <span class="p">{</span>
        <span class="nx">_id</span> <span class="o">:</span> <span class="s2">&#34;$author&#34;</span><span class="p">,</span>
        <span class="nx">docsPerAuthor</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">$sum</span> <span class="o">:</span> <span class="mi">1</span> <span class="p">},</span>
        <span class="nx">viewsPerAuthor</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">$sum</span> <span class="o">:</span> <span class="s2">&#34;$pageViews&#34;</span> <span class="p">}</span>
    <span class="p">}}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This groups by the <code class="docutils literal"><span class="pre">author</span></code> field and computes two fields, the
first <code class="docutils literal"><span class="pre">docsPerAuthor</span></code> is a counter field that adds one for
each document with a given author field using the <a class="reference internal" href="operator/aggregation/sum.html#grp._S_sum" title="$sum"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$sum</span></code></a>
function. The <code class="docutils literal"><span class="pre">viewsPerAuthor</span></code> field is the sum of
all of the <code class="docutils literal"><span class="pre">pageViews</span></code> fields in the documents for each group.</p>
<p>Each field defined for the <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> must use one of the group
aggregation function listed below to generate its composite value:</p>
<ul class="simple">
<li><a class="reference internal" href="operator/aggregation/addToSet.html#grp._S_addToSet" title="$addToSet"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$addToSet</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/first.html#grp._S_first" title="$first"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$first</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/last.html#grp._S_last" title="$last"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$last</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/max.html#grp._S_max" title="$max"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$max</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/min.html#grp._S_min" title="$min"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$min</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/avg.html#grp._S_avg" title="$avg"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$avg</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/push.html#grp._S_push" title="$push"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$push</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/sum.html#grp._S_sum" title="$sum"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$sum</span></code></a></li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The aggregation system currently stores <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> operations in
memory, which may cause problems when processing a larger number
of groups.</p>
</div>
</dd></dl>

<dl class="pipeline">
<dt id="pipe._S_sort">
<code class="descname">$sort</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-113"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-183"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#pipe._S_sort" title="Permalink to this definition">&para;</a></dt>
<dd><p>The <a class="reference internal" href="operator/aggregation/sort.html#pipe._S_sort" title="$sort"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$sort</span></code></a> <a class="reference internal" href="glossary.html#term-pipeline"><span class="xref std std-term">pipeline</span></a> operator sorts all input
documents and returns them to the pipeline in sorted
order. Consider the following prototype form:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="o">&lt;</span><span class="nx">collection</span><span class="o">-</span><span class="nx">name</span><span class="o">&gt;</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$sort</span> <span class="o">:</span> <span class="p">{</span> <span class="o">&lt;</span><span class="nx">sort</span><span class="o">-</span><span class="nx">key</span><span class="o">&gt;</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This sorts the documents in the collection named
<code class="docutils literal"><span class="pre">&lt;collection-name&gt;</span></code>, according to the key and specification in
the <code class="docutils literal"><span class="pre">{</span> <span class="pre">&lt;sort-key&gt;</span> <span class="pre">}</span></code> document.</p>
<p>Specify the sort in a document with a field or fields that you want
to sort by and a value of <code class="docutils literal"><span class="pre">1</span></code> or <code class="docutils literal"><span class="pre">-1</span></code> to specify an ascending
or descending sort respectively, as in the following example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">users</span><span class="p">.</span><span class="nx">aggregate</span><span class="p">(</span>
    <span class="p">{</span> <span class="nx">$sort</span> <span class="o">:</span> <span class="p">{</span> <span class="nx">age</span> <span class="o">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nx">posts</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">}</span>
<span class="p">);</span>
</pre></div>
</div>
</div>
<p>This operation sorts the documents in the <code class="docutils literal"><span class="pre">users</span></code> collection,
in descending order according by the <code class="docutils literal"><span class="pre">age</span></code> field and then in
ascending order according to the value in the <code class="docutils literal"><span class="pre">posts</span></code> field.</p>
<p>When comparing values of different <a class="reference internal" href="glossary.html#term-bson"><span class="xref std std-term">BSON</span></a> types, MongoDB uses the following
comparison order, from lowest to highest:</p>
<ol class="arabic simple">
<li>MinKey (internal type)</li>
<li>Null</li>
<li>Numbers (ints, longs, doubles)</li>
<li>Symbol, String</li>
<li>Object</li>
<li>Array</li>
<li>BinData</li>
<li>ObjectID</li>
<li>Boolean</li>
<li>Date, Timestamp</li>
<li>Regular Expression</li>
<li>MaxKey (internal type)</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">MongoDB treats some types as equivalent for comparison purposes.
For instance, numeric types undergo conversion before comparison.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The <a class="reference internal" href="operator/aggregation/sort.html#pipe._S_sort" title="$sort"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$sort</span></code></a> cannot begin sorting documents until
previous operators in the pipeline have returned all output.</p>
<ul class="last simple">
<li><a class="reference internal" href="operator/aggregation/skip.html#pipe._S_skip" title="$skip"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$skip</span></code></a></li>
</ul>
</div>
<p><a class="reference internal" href="operator/aggregation/sort.html#pipe._S_sort" title="$sort"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$sort</span></code></a> operator can take advantage of an index when
placed at the <strong>beginning</strong> of the pipeline or placed <strong>before</strong>
the following aggregation operators:</p>
<ul class="simple">
<li><a class="reference internal" href="operator/aggregation/project.html#pipe._S_project" title="$project"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$project</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/unwind.html#pipe._S_unwind" title="$unwind"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$unwind</span></code></a></li>
<li><a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a>.</li>
</ul>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Unless the <a class="reference internal" href="operator/aggregation/sort.html#pipe._S_sort" title="$sort"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$sort</span></code></a> operator can use an index,
in the current release, the sort must fit within memory. This
may cause problems when sorting large numbers of documents.</p>
</div>
</dd></dl>

</div>
<div class="section" id="expressions">
<span id="aggregation-expression-operators"></span><h2>Expressions<a class="headerlink" href="#expressions" title="Permalink to this headline">&para;</a></h2>
<p>These operators calculate values within the <a class="reference internal" href="glossary.html#term-aggregation-framework"><span class="xref std std-term">aggregation
framework</span></a>.</p>
<div class="section" id="group-operators">
<h3><code class="docutils literal"><span class="pre">$group</span></code> Operators<a class="headerlink" href="#group-operators" title="Permalink to this headline">&para;</a></h3>
<p>The <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> pipeline stage provides the following
operations:</p>
<dl class="group">
<dt id="grp._S_addToSet">
<code class="descname">$addToSet</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-114"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-184"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_addToSet" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns an array of all the values found in the selected field
among the documents in that group. <em>Every unique value only
appears once</em> in the result set. There is no ordering guarantee
for the output documents.</p>
</dd></dl>

<dl class="group">
<dt id="grp._S_first">
<code class="descname">$first</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-115"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-185"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_first" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns the first value it encounters for its group .</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only use <a class="reference internal" href="operator/aggregation/first.html#grp._S_first" title="$first"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$first</span></code></a> when the <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a> follows
an <a class="reference internal" href="operator/aggregation/sort.html#pipe._S_sort" title="$sort"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$sort</span></code></a> operation. Otherwise, the result of this
operation is unpredictable.</p>
</div>
</dd></dl>

<dl class="group">
<dt id="grp._S_last">
<code class="descname">$last</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-116"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-186"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_last" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns the last value it encounters for its group.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Only use <a class="reference internal" href="operator/aggregation/last.html#grp._S_last" title="$last"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$last</span></code></a> when the <a class="reference internal" href="operator/aggregation/group.html#pipe._S_group" title="$group"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$group</span></code></a>
follows an <a class="reference internal" href="operator/aggregation/sort.html#pipe._S_sort" title="$sort"><code class="xref mongodb mongodb-pipeline docutils literal"><span class="pre">$sort</span></code></a> operation. Otherwise, the
result of this operation is unpredictable.</p>
</div>
</dd></dl>

<dl class="group">
<dt id="grp._S_max">
<code class="descname">$max</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-117"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-187"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_max" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns the highest value among all values of the field in all
documents selected by this group.</p>
</dd></dl>

<dl class="group">
<dt id="grp._S_min">
<code class="descname">$min</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-118"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-188"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_min" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns the lowest value among all values of the field in all
documents selected by this group.</p>
</dd></dl>

<dl class="group">
<dt id="grp._S_avg">
<code class="descname">$avg</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-119"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-189"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_avg" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns the average of all the values of the field in all documents
selected by this group.</p>
</dd></dl>

<dl class="group">
<dt id="grp._S_push">
<code class="descname">$push</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-120"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-190"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_push" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns an array of all the values found in the selected field
among the documents in that group. <em>A value may appear more than
once</em> in the result set if more than one field in the grouped
documents has that value.</p>
</dd></dl>

<dl class="group">
<dt id="grp._S_sum">
<code class="descname">$sum</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-121"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-191"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#grp._S_sum" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns the sum of all the values for a specified
field in the grouped documents, as in the second use above.</p>
<p>Alternately, if you specify a value as an argument,
<a class="reference internal" href="operator/aggregation/sum.html#grp._S_sum" title="$sum"><code class="xref mongodb mongodb-group docutils literal"><span class="pre">$sum</span></code></a> will increment this field by the specified value
for every document in the grouping. Typically, as in the first
use above, specify a value of <code class="docutils literal"><span class="pre">1</span></code> in order to count members of the
group.</p>
</dd></dl>

</div>
<div class="section" id="boolean-operators">
<h3>Boolean Operators<a class="headerlink" href="#boolean-operators" title="Permalink to this headline">&para;</a></h3>
<p>The three boolean operators accept Booleans as arguments and
return Booleans as results.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">These operators convert non-booleans to Boolean values according to
the BSON standards. Here, <code class="docutils literal"><span class="pre">null</span></code>, <code class="docutils literal"><span class="pre">undefined</span></code>, and <code class="docutils literal"><span class="pre">0</span></code> values
become <code class="docutils literal"><span class="pre">false</span></code>, while non-zero numeric values, and all other types,
such as strings, dates, objects become <code class="docutils literal"><span class="pre">true</span></code>.</p>
</div>
<dl class="expression">
<dt id="exp._S_and">
<code class="descname">$and</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-122"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-192"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_and" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes an array one or more values and returns <code class="docutils literal"><span class="pre">true</span></code> if <em>all</em> of
the values in the array are <code class="docutils literal"><span class="pre">true</span></code>. Otherwise <a class="reference internal" href="operator/aggregation/and.html#exp._S_and" title="$and"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$and</span></code></a>
returns <code class="docutils literal"><span class="pre">false</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="operator/aggregation/and.html#exp._S_and" title="$and"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$and</span></code></a> uses short-circuit logic: the operation
stops evaluation after encountering the first <code class="docutils literal"><span class="pre">false</span></code>
expression.</p>
</div>
</dd></dl>

<dl class="expression">
<dt id="exp._S_or">
<code class="descname">$or</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-123"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-193"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_or" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes an array of one or more values and returns <code class="docutils literal"><span class="pre">true</span></code> if <em>any</em> of the values in the
array are <code class="docutils literal"><span class="pre">true</span></code>. Otherwise <a class="reference internal" href="operator/aggregation/or.html#exp._S_or" title="$or"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$or</span></code></a> returns false.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="operator/aggregation/or.html#exp._S_or" title="$or"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$or</span></code></a> uses short-circuit logic: the operation
stops evaluation after encountering the first <code class="docutils literal"><span class="pre">true</span></code> expression.</p>
</div>
</dd></dl>

<dl class="expression">
<dt id="exp._S_not">
<code class="descname">$not</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-124"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-194"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_not" title="Permalink to this definition">&para;</a></dt>
<dd><p>Returns the boolean opposite value passed to it. When passed a
<code class="docutils literal"><span class="pre">true</span></code> value, <a class="reference internal" href="operator/aggregation/not.html#exp._S_not" title="$not"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$not</span></code></a> returns <code class="docutils literal"><span class="pre">false</span></code>; when passed
a <code class="docutils literal"><span class="pre">false</span></code> value, <a class="reference internal" href="operator/aggregation/not.html#exp._S_not" title="$not"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$not</span></code></a> returns <code class="docutils literal"><span class="pre">true</span></code>.</p>
</dd></dl>

</div>
<div class="section" id="comparison-operators">
<h3>Comparison Operators<a class="headerlink" href="#comparison-operators" title="Permalink to this headline">&para;</a></h3>
<p>These operators perform comparisons between two values and return a
Boolean, in most cases, reflecting the result of that comparison.</p>
<p>All comparison operators take an array with a pair of values. You may
compare numbers, strings, and dates. Except for <a class="reference internal" href="operator/aggregation/cmp.html#exp._S_cmp" title="$cmp"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$cmp</span></code></a>,
all comparison operators return a Boolean value. <a class="reference internal" href="operator/aggregation/cmp.html#exp._S_cmp" title="$cmp"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$cmp</span></code></a>
returns an integer.</p>
<dl class="expression">
<dt id="exp._S_cmp">
<code class="descname">$cmp</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-125"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-195"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_cmp" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes two values in an array and returns an integer. The returned
value is:</p>
<ul class="simple">
<li>A negative number if the first value is less than the second.</li>
<li>A positive number if the first value is greater than the second.</li>
<li><code class="docutils literal"><span class="pre">0</span></code> if the two values are equal.</li>
</ul>
</dd></dl>

<dl class="expression">
<dt id="exp._S_eq">
<code class="descname">$eq</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-126"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-196"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_eq" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes two values in an array and returns a boolean. The returned
value is:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">true</span></code> when the values are equivalent.</li>
<li><code class="docutils literal"><span class="pre">false</span></code> when the values are <strong>not</strong> equivalent.</li>
</ul>
</dd></dl>

<dl class="expression">
<dt id="exp._S_gt">
<code class="descname">$gt</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-127"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-197"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_gt" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes two values in an array and returns a boolean. The returned
value is:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">true</span></code> when the first value is <em>greater than</em> the second value.</li>
<li><code class="docutils literal"><span class="pre">false</span></code> when the first value is <em>less than or equal to</em> the
second value.</li>
</ul>
</dd></dl>

<dl class="expression">
<dt id="exp._S_gte">
<code class="descname">$gte</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-128"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-198"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_gte" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes two values in an array and returns a boolean. The returned
value is:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">true</span></code> when the first value is <em>greater than or equal</em> to the
second value.</li>
<li><code class="docutils literal"><span class="pre">false</span></code> when the first value is <em>less than</em> the second value.</li>
</ul>
</dd></dl>

<dl class="expression">
<dt id="exp._S_lt">
<code class="descname">$lt</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-129"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-199"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_lt" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes two values in an array and returns a boolean. The returned
value is:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">true</span></code> when the first value is <em>less than</em> the second value.</li>
<li><code class="docutils literal"><span class="pre">false</span></code> when the first value is <em>greater than or equal to</em> the
second value.</li>
</ul>
</dd></dl>

<dl class="expression">
<dt id="exp._S_lte">
<code class="descname">$lte</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-130"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-200"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_lte" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes two values in an array and returns a boolean. The returned
value is:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">true</span></code> when the first value is <em>less than or equal to</em> the
second value.</li>
<li><code class="docutils literal"><span class="pre">false</span></code> when the first value is <em>greater than</em> the second
value.</li>
</ul>
</dd></dl>

<dl class="expression">
<dt id="exp._S_ne">
<code class="descname">$ne</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-131"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-201"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_ne" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes two values in an array returns a boolean. The returned value
is:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">true</span></code> when the values are <strong>not equivalent</strong>.</li>
<li><code class="docutils literal"><span class="pre">false</span></code> when the values are <strong>equivalent</strong>.</li>
</ul>
</dd></dl>

</div>
<div class="section" id="arithmetic-operators">
<h3>Arithmetic Operators<a class="headerlink" href="#arithmetic-operators" title="Permalink to this headline">&para;</a></h3>
<p>These operators only support numbers.</p>
<dl class="expression">
<dt id="exp._S_add">
<code class="descname">$add</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-132"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-202"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_add" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes an array of one or more numbers and adds them together,
returning the sum.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_divide">
<code class="descname">$divide</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-133"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-203"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_divide" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes an array that contains a pair of numbers and returns the
value of the first number divided by the second number.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_mod">
<code class="descname">$mod</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-134"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-204"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_mod" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes an array that contains a pair of numbers and returns the
<em>remainder</em> of the first number divided by the second number.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="operator/query/mod.html#op._S_mod" title="$mod"><code class="xref mongodb mongodb-query docutils literal"><span class="pre">$mod</span></code></a></p>
</div>
</dd></dl>

<dl class="expression">
<dt id="exp._S_multiply">
<code class="descname">$multiply</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-135"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-205"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_multiply" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes an array of one or more numbers and multiples them, returning the
resulting product.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_subtract">
<code class="descname">$subtract</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-136"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-206"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_subtract" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes an array that contains a pair of numbers and subtracts the
second from the first, returning their difference.</p>
</dd></dl>

</div>
<div class="section" id="string-operators">
<h3>String Operators<a class="headerlink" href="#string-operators" title="Permalink to this headline">&para;</a></h3>
<p>These operators manipulate strings within projection expressions.</p>
<dl class="expression">
<dt id="exp._S_strcasecmp">
<code class="descname">$strcasecmp</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-137"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-207"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_strcasecmp" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes in two strings. Returns a number. <a class="reference internal" href="operator/aggregation/strcasecmp.html#exp._S_strcasecmp" title="$strcasecmp"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$strcasecmp</span></code></a>
is positive if the first string is &ldquo;greater than&rdquo; the second and
negative if the first string is &ldquo;less than&rdquo; the
second. <a class="reference internal" href="operator/aggregation/strcasecmp.html#exp._S_strcasecmp" title="$strcasecmp"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$strcasecmp</span></code></a> returns 0 if the strings are
identical.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><a class="reference internal" href="operator/aggregation/strcasecmp.html#exp._S_strcasecmp" title="$strcasecmp"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$strcasecmp</span></code></a> may not make sense when applied to
glyphs outside the Roman alphabet.</p>
<p class="last"><a class="reference internal" href="operator/aggregation/strcasecmp.html#exp._S_strcasecmp" title="$strcasecmp"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$strcasecmp</span></code></a> internally capitalizes strings before
comparing them to provide a case-<em>insensitive</em> comparison.
Use <a class="reference internal" href="operator/aggregation/cmp.html#exp._S_cmp" title="$cmp"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$cmp</span></code></a> for a case sensitive comparison.</p>
</div>
</dd></dl>

<dl class="expression">
<dt id="exp._S_substr">
<code class="descname">$substr</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-138"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-208"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_substr" title="Permalink to this definition">&para;</a></dt>
<dd><p><a class="reference internal" href="operator/aggregation/substr.html#exp._S_substr" title="$substr"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$substr</span></code></a> takes a string and two numbers. The first
number represents the number of bytes in the string to skip,
and the second number specifies the number of bytes to return
from the string.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="operator/aggregation/substr.html#exp._S_substr" title="$substr"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$substr</span></code></a> is not encoding aware and if used
improperly may produce a result string containing an invalid UTF-8
character sequence.</p>
</div>
</dd></dl>

<dl class="expression">
<dt id="exp._S_toLower">
<code class="descname">$toLower</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-139"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-209"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_toLower" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a single string and converts that string to lowercase,
returning the result. All uppercase letters become lowercase.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="operator/aggregation/toLower.html#exp._S_toLower" title="$toLower"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$toLower</span></code></a> may not make sense when applied to glyphs outside
the Roman alphabet.</p>
</div>
</dd></dl>

<dl class="expression">
<dt id="exp._S_toUpper">
<code class="descname">$toUpper</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-140"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-210"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_toUpper" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a single string and converts that string to uppercase,
returning the result. All lowercase letters become uppercase.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><a class="reference internal" href="operator/aggregation/toUpper.html#exp._S_toUpper" title="$toUpper"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$toUpper</span></code></a> may not make sense when applied to glyphs outside
the Roman alphabet.</p>
</div>
</dd></dl>

</div>
<div class="section" id="date-operators">
<h3>Date Operators<a class="headerlink" href="#date-operators" title="Permalink to this headline">&para;</a></h3>
<p>All date operators take a &ldquo;Date&rdquo; typed value as a single
argument and return a number.</p>
<dl class="expression">
<dt id="exp._S_dayOfYear">
<code class="descname">$dayOfYear</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-141"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-211"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_dayOfYear" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the day of the year as a number
between 1 and 366.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_dayOfMonth">
<code class="descname">$dayOfMonth</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-142"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-212"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_dayOfMonth" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the day of the month as a number
between 1 and 31.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_dayOfWeek">
<code class="descname">$dayOfWeek</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-143"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-213"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_dayOfWeek" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the day of the week as a number
between 1 (Sunday) and 7 (Saturday.)</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_year">
<code class="descname">$year</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-144"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-214"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_year" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the full year.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_month">
<code class="descname">$month</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-145"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-215"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_month" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the month as a number between 1 and 12.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_week">
<code class="descname">$week</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-146"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-216"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_week" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the week of the year as a number
between 0 and 53.</p>
<p>Weeks begin on Sundays, and week 1 begins with the first Sunday
of the year. Days preceding the first Sunday of the year are in
week 0. This behavior is the same as the &ldquo;<code class="docutils literal"><span class="pre">%U</span></code>&rdquo; operator to the
<code class="docutils literal"><span class="pre">strftime</span></code> standard library function.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_hour">
<code class="descname">$hour</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-147"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-217"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_hour" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the hour between 0 and 23.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_minute">
<code class="descname">$minute</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-148"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-218"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_minute" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the minute between 0 and 59.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_second">
<code class="descname">$second</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-149"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-219"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_second" title="Permalink to this definition">&para;</a></dt>
<dd><p>Takes a date and returns the second between 0 and 59, but can be 60
to account for leap seconds.</p>
</dd></dl>

</div>
<div class="section" id="conditional-expressions">
<h3>Conditional Expressions<a class="headerlink" href="#conditional-expressions" title="Permalink to this headline">&para;</a></h3>
<dl class="expression">
<dt id="exp._S_cond">
<code class="descname">$cond</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-150"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-220"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_cond" title="Permalink to this definition">&para;</a></dt>
<dd><p>Use the <a class="reference internal" href="operator/aggregation/cond.html#exp._S_cond" title="$cond"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$cond</span></code></a> operator with the following syntax:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nx">$cond</span><span class="o">:</span> <span class="p">[</span> <span class="o">&lt;</span><span class="kr">boolean</span><span class="o">-</span><span class="nx">expression</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="kc">true</span><span class="o">-</span><span class="k">case</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="kc">false</span><span class="o">-</span><span class="k">case</span><span class="o">&gt;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>Takes an array with three expressions, where the first expression
evaluates to a Boolean value. If the first expression evaluates to true,
<a class="reference internal" href="operator/aggregation/cond.html#exp._S_cond" title="$cond"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$cond</span></code></a> returns the value of the second expression. If the
first expression evaluates to false, <a class="reference internal" href="operator/aggregation/cond.html#exp._S_cond" title="$cond"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$cond</span></code></a> evaluates and
returns the third expression.</p>
</dd></dl>

<dl class="expression">
<dt id="exp._S_ifNull">
<code class="descname">$ifNull</code><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashingAutolink" name="autolink-151"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="dashingAutolink" name="autolink-221"></a><a class="dashAnchor" name="//apple_ref/cpp/Command/%C2%B6"></a><a class="headerlink" href="#exp._S_ifNull" title="Permalink to this definition">&para;</a></dt>
<dd><p>Use the <a class="reference internal" href="operator/aggregation/ifNull.html#exp._S_ifNull" title="$ifNull"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$ifNull</span></code></a> operator with the following syntax:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="nx">$ifNull</span><span class="o">:</span> <span class="p">[</span> <span class="o">&lt;</span><span class="nx">expression</span><span class="o">&gt;</span><span class="p">,</span> <span class="o">&lt;</span><span class="nx">replacement</span><span class="o">-</span><span class="k">if</span><span class="o">-</span><span class="kc">null</span><span class="o">&gt;</span> <span class="p">]</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>Takes an array with two expressions. <a class="reference internal" href="operator/aggregation/ifNull.html#exp._S_ifNull" title="$ifNull"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$ifNull</span></code></a> returns
the first expression if it evaluates to a non-null
value. Otherwise, <a class="reference internal" href="operator/aggregation/ifNull.html#exp._S_ifNull" title="$ifNull"><code class="xref mongodb mongodb-expression docutils literal"><span class="pre">$ifNull</span></code></a> returns the second
expression&rsquo;s value.</p>
</dd></dl>

</div>
</div>
</div>

                
    <div id="btnv">
      <span class="btn-arrow-left">&larr; &nbsp;</span>
      <a class="btn-prev-text" href="../tutorial/aggregation-examples.html" title="Previous Section: Aggregation Framework Examples"><span>Aggregation Framework Examples</span></a>
      <a class="btn-next-text" href="../applications/map-reduce.html" title="Next Section: Map-Reduce"><span>Map-Reduce</span></a>
      <span class="btn-arrow-right">&nbsp;&rarr;</span>
    </div>
                  <div class="footer">
                    <div class="copyright">
                      <p>&copy; MongoDB, Inc 2008-present. MongoDB, Mongo, and the leaf logo are registered trademarks of MongoDB, Inc.</p>
                    </div>
                  </div>
              </div></div>
            </div>
        </div>
    </div>
    <div class="right-column">
      <div class="wrapper"> <div id="mongodb-docs-1">
   <script type="text/javascript">
      googletag.cmd.push(function() { googletag.display('mongodb-docs-1'); });
   </script>
</div>
            <div class="social">
               <a class="slack-icon" href="https://slackpass.io/mongo-db?jmp=docs" title="https://slackpass.io/mongo-db?jmp=docs"><i class="fab fa-slack" aria-hidden="true"></i></a>
               <a class="twitter-icon" href="https://twitter.com/MongoDB" title="https://twitter.com/MongoDB"><i class="fab fa-twitter-square"></i></a>
               <a class="youtube-icon" href="https://www.youtube.com/user/MongoDB" title="https://www.youtube.com/user/MongoDB"><i class="fab fa-youtube-square"></i></a>
               <a class="facebook-icon" href="https://www.facebook.com/mongodb" title="https://www.facebook.com/mongodb"><i class="fab fa-facebook-square"></i></a>
               <a class="stack-overflow-icon" href="https://stackoverflow.com/tags/mongodb/info" title="https://stackoverflow.com/tags/mongodb/info"><i class="fab fa-stack-overflow" aria-hidden="true"></i></a>
            </div>
        

      </div>
    </div>
    
      <div id="rating-panel"></div>
    
    <div class="clearfix"></div>
  </div>
<div id="navbar" data-navprops="{&#34;links&#34;: [{&#34;url&#34;: &#34;https://www.mongodb.com/docs/manual/&#34;,&#34;text&#34;: &#34;Server&#34;,&#34;active&#34;: true},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/drivers/&#34;,&#34;text&#34;: &#34;Drivers&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/cloud/&#34;,&#34;text&#34;: &#34;Cloud&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/tools/&#34;,&#34;text&#34;: &#34;Tools&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/guides/&#34;,&#34;text&#34;: &#34;Guides&#34;}], &#34;baseUrl&#34;: &#34;https://www.mongodb.com/docs&#34;}"></div>

  

  

  <script type="text/javascript">
  // Bootstrap array of links that should trigger a full page reload
  window.docsExcludedNav = [];
  </script>
</body></html>