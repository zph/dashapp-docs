<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>
  <link href="https://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css"/></head><body data-project="manual" data-project-title="MongoDB Manual" data-branch="v2.2" data-enable-marian="1" data-eol="True"><a class="dashingAutolink" name="autolink-12"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Replica%20Set%20Operation%20and%20Management%20%E2%80%94%20MongoDB%20Manual"></a><a class="dashingAutolink" name="autolink-83"></a><a class="dashAnchor" name="//apple_ref/cpp/Package/Replica%20Set%20Operation%20and%20Management%20%E2%80%94%20MongoDB%20Manual"></a><title>Replica Set Operation and Management &mdash; MongoDB Manual</title><link rel="shortcut icon" href="https://www.mongodb.com/docs/assets/favicon.ico"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
      <link rel="canonical" href="https://www.mongodb.com/docs/manual/administration/replica-sets/"/><meta name="robots" content="index"/>
  <meta name="release" content="2.2.7"/>
  <meta name="version" content="2.2"/>
  <meta name="DC.Source" content="https://github.com/mongodb/docs/blob/v2.2/source/administration/replica-sets.txt"/>
  <meta property="og:image" content="http://s3.amazonaws.com/info-mongodb-com/_com_assets/cms/mongodb-for-giant-ideas-bbab5c3cf8.png"/>
  <meta property="og:image:secure_url" content="https://webassets.mongodb.com/_com_assets/cms/mongodb-for-giant-ideas-bbab5c3cf8.png"/>
  
   <link rel="stylesheet" href="../_static/mongodb-docs.css" type="text/css"/>
   <link rel="stylesheet" href="../_static/pygments.css" type="text/css"/>
   <link rel="stylesheet" href="../_static/css/navbar.min.css?t=nocache" type="text/css"/>
    
    <script type="text/javascript" src="../_static/lib/jquery.min.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/lib/bootstrap.js"></script>
    <script type="text/javascript" src="../_static/lib/jquery.cookie.js"></script>
    <script type="text/javascript" src="../_static/controller.js"></script>
      <link rel="search" type="application/opensearchdescription+xml" href="https://www.mongodb.com/docs/osd.xml" title="MongoDB Help"/>
<link rel="author" title="About these documents" href="../about.html"/>
<!-- <link rel="index" title="Index" href="../genindex.html" /> -->
<link rel="search" title="Search" href="../search.html"/>
<link rel="top" title="MongoDB Manual" href="../index.html"/>
<link rel="up" title="Replication" href="../replication.html"/>
<link rel="next" title="Replica Set Architectures and Deployment Patterns" href="replica-set-architectures.html"/>
<link rel="prev" title="Replica Set Fundamental Concepts" href="../core/replication.html"/><script type="text/javascript">
   var gptadslots=[];
   var googletag = googletag || {};
   googletag.cmd = googletag.cmd || [];
   (function(){ var gads = document.createElement('script');
      gads.async = true; gads.type = 'text/javascript';
      var useSSL = 'https:' == document.location.protocol;
      gads.src = (useSSL ? 'https:' : 'http:') + '//www.googletagservices.com/tag/js/gpt.js';
      var node = document.getElementsByTagName('script')[0];
      node.parentNode.insertBefore(gads, node);
   })();
</script>

<script type="text/javascript">
   googletag.cmd.push(function() {

      var pathname = location.href;
      
      if ( (pathname.indexOf("auth") >= 0) || (pathname.indexOf("security") >= 0) ) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/security', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if ( (pathname.indexOf("crud") >= 0) ||  (pathname.indexOf("query") >= 0) || (pathname.indexOf("insert") >= 0) || (pathname.indexOf("update") >= 0) || (pathname.indexOf("remove") >= 0) || (pathname.indexOf("delete") >= 0) || (pathname.indexOf("aggregation") >= 0) ) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/crud', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("shard") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/sharding', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("replica") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/replication', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("model") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/data-modeling', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("administration") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/support', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("install-mongodb-on-windows") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/install-mongodb-on-windows', [160, 600], 'mongodb-docs-1').addService(googletag.pubads());
      } else if (pathname.indexOf("tutorial/getting-started") >= 0) {
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org/docs_server_gettingstarted', [160, 600], 'mongodb-docs-1').addService(googletag.pubads());
      } else {
         //Adslot 1 declaration
         gptadslots[1]= googletag.defineSlot('/40039723/docs.mongodb.org', [[160,600],[243,202],[293,244]],'mongodb-docs-1').addService(googletag.pubads());
      }
      googletag.pubads().enableSingleRequest();
      googletag.pubads().enableAsyncRendering();
      googletag.enableServices();
   });
</script>

  <!-- Google Tag Manager -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-GDFN"
                    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <script>
  (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push(
  {'gtm.start':new Date().getTime(),event:'gtm.js'}
  );var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-GDFN');
  </script>
  <!-- End Google Tag Manager -->
      <script>
        window.googleSearchCx = "017213726194841070573:WMX6838984"
	window.googleSearchPlaceholder = "Search Documentation"
        window.googleSearchResultsUrl = "https://www.mongodb.com/docs/manual/search/"
      </script><div class="content" style="margin-top: 0;">

   <div id="left-column">
         <aside id="sidebar" class="sidebar">
             
  <div class="sphinxsidebar" id="sphinxsidebar">
    <div id="sphinxsidebarwrapper" class="sphinxsidebarwrapper"><a href="javascript:void(0)" class="closeNav" id="closeNav">Close &times;</a>


<h3>
  <a class="index-link" href="../index.html">MongoDB Manual</a>
</h3>


    <div class="btn-group version-sidebar">
      
        <button type="button" class="version-button dropdown-toggle" data-toggle="dropdown" disabled="" aria-disabled="disabled">
          
          
          Version 2.2
        </button>
        <a href="https://www.mongodb.com/docs/legacy">&larr; Return to Documentation</a>
      
    </div>


<ul class="current"><li class="toctree-l1"><a class="reference internal" href="../installation.html">Installing MongoDB</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-red-hat-centos-or-fedora-linux.html">Install MongoDB on Red Hat Enterprise, CentOS, or Fedora</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-ubuntu.html">Install MongoDB on Ubuntu</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-debian.html">Install MongoDB on Debian</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-linux.html">Install MongoDB on Linux Systems</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-os-x.html">Install MongoDB on OS X</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/install-mongodb-on-windows.html">Install MongoDB on Windows</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/getting-started.html">Getting Started with MongoDB Development</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../administration.html">Administration</a><ul><li class="toctree-l2"><a class="reference internal" href="configuration.html">Run-time Database Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="operational-segregation.html">Operational Segregation in MongoDB Operations and Deployments</a></li><li class="toctree-l2"><a class="reference internal" href="journaling.html">Journaling</a></li><li class="toctree-l2"><a class="reference internal" href="ssl.html">Use MongoDB with SSL Connections</a></li><li class="toctree-l2"><a class="reference internal" href="snmp.html">Use MongoDB with SNMP Monitoring</a></li><li class="toctree-l2"><a class="reference internal" href="monitoring.html">Monitoring Database Systems</a></li><li class="toctree-l2"><a class="reference internal" href="import-export.html">Importing and Exporting MongoDB Data</a></li><li class="toctree-l2"><a class="reference internal" href="backups.html">Backup Strategies for MongoDB Systems</a></li><li class="toctree-l2"><a class="reference internal" href="ulimit.html">UNIX <code class="docutils literal"><span class="pre">ulimit</span></code> Settings</a></li><li class="toctree-l2"><a class="reference internal" href="production-notes.html">Production Notes</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../security.html">Security</a><ul><li class="toctree-l2"><a class="reference internal" href="security.html">Security Practices and Management</a></li><li class="toctree-l2"><a class="reference internal" href="vulnerability-notification.html">Vulnerability Notification</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-linux-iptables-firewall.html">Configure Linux <code class="docutils literal"><span class="pre">iptables</span></code> Firewall for MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-windows-netsh-firewall.html">Configure Windows <code class="docutils literal"><span class="pre">netsh</span></code> Firewall for MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/control-access-to-mongodb-with-authentication.html">Control Access to MongoDB Instances with Authentication</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../crud.html">Core MongoDB Operations (CRUD)</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/read-operations.html">Read Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../core/write-operations.html">Write Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../core/data-modeling.html">Data Modeling Considerations for MongoDB Applications</a></li><li class="toctree-l2"><a class="reference internal" href="../core/document.html">BSON Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../core/object-id.html">ObjectId</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/database-references.html">Database References</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/gridfs.html">GridFS</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/create.html">Create</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/read.html">Read</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/update.html">Update</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/delete.html">Delete</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-embedded-one-to-one-relationships-between-documents.html">Model Embedded One-to-One Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-embedded-one-to-many-relationships-between-documents.html">Model Embedded One-to-Many Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-referenced-one-to-many-relationships-between-documents.html">Model Referenced One-to-Many Relationships Between Documents</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-data-for-atomic-operations.html">Model Data for Atomic Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-parent-references.html">Model Tree Structures with Parent References</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-child-references.html">Model Tree Structures with Child References</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-ancestors-array.html">Model Tree Structures with an Array of Ancestors</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-materialized-paths.html">Model Tree Structures with Materialized Paths</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-tree-structures-with-nested-sets.html">Model Tree Structures with Nested Sets</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/model-data-for-keyword-search.html">Model Data to Support Keyword Search</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../aggregation.html">Aggregation</a><ul><li class="toctree-l2"><a class="reference internal" href="../applications/aggregation.html">Aggregation Framework</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/aggregation-examples.html">Aggregation Framework Examples</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/aggregation.html">Aggregation Framework Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/map-reduce.html">Map-Reduce</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/simple-aggregation.html">Simple Aggregation Methods and Commands</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../indexes.html">Indexes</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/indexes.html">Indexing Overview</a></li><li class="toctree-l2"><a class="reference internal" href="indexes.html">Indexing Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/indexes.html">Indexing Strategies</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/geospatial-indexes.html">Geospatial Queries with <code class="docutils literal"><span class="pre">2d</span></code> Indexes</a></li><li class="toctree-l2"><a class="reference internal" href="../core/geospatial-indexes.html"><code class="docutils literal"><span class="pre">2d</span></code> Geospatial Indexes</a></li></ul></li><li class="toctree-l1 current"><a class="reference internal" href="../replication.html">Replication</a><ul class="current"><li class="toctree-l2"><a class="reference internal" href="../core/replication.html">Replica Set Fundamental Concepts</a></li><li class="toctree-l2 current"><a class="reference internal current" href="">Replica Set Operation and Management</a></li><li class="toctree-l2"><a class="reference internal" href="replica-set-architectures.html">Replica Set Architectures and Deployment Patterns</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/replication.html">Replica Set Considerations and Behaviors for Applications and Development</a></li><li class="toctree-l2"><a class="reference internal" href="../core/replication-internals.html">Replica Set Internals and Behaviors</a></li><li class="toctree-l2"><a class="reference internal" href="master-slave.html">Master Slave Replication</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-replica-set.html">Deploy a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-standalone-to-replica-set.html">Convert a Standalone to a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/expand-replica-set.html">Add Members to a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-geographically-distributed-replica-set.html">Deploy a Geographically Distributed Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/change-oplog-size.html">Change the Size of the Oplog</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/force-member-to-be-primary.html">Force a Member to Become Primary</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/change-hostnames-in-a-replica-set.html">Change Hostnames in a Replica Set</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-secondary-into-arbiter.html">Convert a Secondary to an Arbiter</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/reconfigure-replica-set-with-unavailable-members.html">Reconfigure a Replica Set with Unavailable Members</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/recover-data-following-unexpected-shutdown.html">Recover MongoDB Data following Unexpected Shutdown</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replica-commands.html">Replica Set Commands</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/replica-set-features.html">Replica Set Features and Version Compatibility</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../sharding.html">Sharding</a><ul><li class="toctree-l2"><a class="reference internal" href="../core/sharded-clusters.html">Sharded Cluster Overview</a></li><li class="toctree-l2"><a class="reference internal" href="sharded-clusters.html">Sharded Cluster Administration</a></li><li class="toctree-l2"><a class="reference internal" href="sharded-cluster-architectures.html">Sharded Cluster Architectures</a></li><li class="toctree-l2"><a class="reference internal" href="../core/sharded-cluster-internals.html">Sharded Cluster Internals and Behaviors</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/deploy-shard-cluster.html">Deploy a Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/add-shards-to-shard-cluster.html">Add Shards to a Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/view-sharded-cluster-configuration.html">View Cluster Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-sharded-cluster-config-server.html">Manage the Config Servers</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-chunks-in-sharded-cluster.html">Manage Chunks in a Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/configure-sharded-cluster-balancer.html">Configure Behavior of Balancer Process in Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-sharded-cluster-balancer.html">Manage Sharded Cluster Balancer</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/remove-shards-from-cluster.html">Remove Shards from an Existing Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-small-sharded-cluster-with-mongodump.html">Backup a Small Sharded Cluster with <code class="docutils literal"><span class="pre">mongodump</span></code></a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-sharded-cluster-with-filesystem-snapshots.html">Create Backup of a Sharded Cluster with Filesystem Snapshots</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-sharded-cluster-with-database-dumps.html">Create Backup of a Sharded Cluster with Database Dumps</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/restore-single-shard.html">Restore a Single Shard</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/restore-sharded-cluster.html">Restore Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/schedule-backup-window-for-sharded-clusters.html">Schedule Backup Window for Sharded Clusters</a></li><li class="toctree-l2"><a class="reference internal" href="tag-aware-sharding.html">Tag Aware Sharding</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/enforce-unique-keys-for-sharded-collections.html">Enforce Unique Keys for Sharded Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-replica-set-to-replicated-shard-cluster.html">Convert a Replica Set to a Replicated Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/sharding-commands.html">Sharding Commands</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../applications.html">Application Development</a><ul><li class="toctree-l2"><a class="reference internal" href="../applications/drivers.html">MongoDB Drivers and Client Libraries</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/optimization.html">Optimization Strategies for MongoDB Applications</a></li><li class="toctree-l2"><a class="reference internal" href="../applications/server-side-javascript.html">Server-side JavaScript</a></li><li class="toctree-l2"><a class="reference internal" href="../core/capped-collections.html">Capped Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/perform-two-phase-commits.html">Perform Two Phase Commits</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/create-tailable-cursor.html">Create Tailable Cursor</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/isolate-sequence-of-operations.html">Isolate Sequence of Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/create-an-auto-incrementing-field.html">Create an Auto-Incrementing Sequence Field</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/expire-data.html">Expire Data from Collections by Setting TTL</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../mongo.html">Using the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/getting-started-with-the-mongo-shell.html">Getting Started with the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../core/shell-types.html">Data Types in the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/access-mongo-shell-help.html">Access the <code class="docutils literal"><span class="pre">mongo</span></code> Shell Help Information</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/write-scripts-for-the-mongo-shell.html">Write Scripts for the <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/mongo-shell.html"><code class="docutils literal"><span class="pre">mongo</span></code> Shell Quick Reference</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../tutorial.html">MongoDB Tutorials</a><ul><li class="toctree-l2"><a class="reference internal" href="../tutorial/use-database-commands.html">Use Database Commands</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/recover-data-following-unexpected-shutdown.html">Recover MongoDB Data following Unexpected Shutdown</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-mongodb-processes.html">Manage <code class="docutils literal"><span class="pre">mongod</span></code> Processes</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/convert-replica-set-to-replicated-shard-cluster.html">Convert a Replica Set to a Replicated Sharded Cluster</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/copy-databases-between-instances.html">Copy Databases Between Instances</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-databases-with-binary-database-dumps.html">Use <code class="docutils literal"><span class="pre">mongodump</span></code> and <code class="docutils literal"><span class="pre">mongorestore</span></code> to Backup and Restore MongoDB Databases</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/backup-databases-with-filesystem-snapshots.html">Use Filesystem Snapshots to Backup and Restore MongoDB Databases</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/manage-the-database-profiler.html">Analyze Performance of Database Operations</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/rotate-log-files.html">Rotate Log Files</a></li><li class="toctree-l2"><a class="reference internal" href="../tutorial/roll-back-to-v1.8-index.html">Build Old Style Indexes</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../faq.html">Frequently Asked Questions</a><ul><li class="toctree-l2"><a class="reference internal" href="../faq/fundamentals.html">FAQ: MongoDB Fundamentals</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/developers.html">FAQ: MongoDB for Application Developers</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/mongo.html">FAQ: The <code class="docutils literal"><span class="pre">mongo</span></code> Shell</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/concurrency.html">FAQ: Concurrency</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/sharding.html">FAQ: Sharding with MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/replica-sets.html">FAQ: Replica Sets and Replication in MongoDB</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/storage.html">FAQ: MongoDB Storage</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/indexes.html">FAQ: Indexes</a></li><li class="toctree-l2"><a class="reference internal" href="../faq/diagnostics.html">FAQ: MongoDB Diagnostics</a></li></ul></li><li class="toctree-l1"><a class="reference internal" href="../reference.html">Reference</a><ul><li class="toctree-l2"><a class="reference internal" href="../reference/operator.html">Query, Update, Projection, and Aggregation Operators</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/all.html">$all</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/and.html">$and</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/box.html">$box</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/center.html">$center</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/centerSphere.html">$centerSphere</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/elemMatch.html">$elemMatch (query)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/exists.html">$exists</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/gt.html">$gt</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/gte.html">$gte</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/in.html">$in</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/lt.html">$lt</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/lte.html">$lte</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/maxDistance.html">$maxDistance</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/mod.html">$mod</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/ne.html">$ne</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/near.html">$near</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/nearSphere.html">$nearSphere</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/nin.html">$nin</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/nor.html">$nor</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/not.html">$not</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/or.html">$or</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/polygon.html">$polygon</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/regex.html">$regex</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/size.html">$size</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/type.html">$type</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/uniqueDocs.html">$uniqueDocs</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/where.html">$where</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/query/within.html">$within</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/addToSet.html">$addToSet</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/bit.html">$bit</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/each.html">$each</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/inc.html">$inc</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/isolated.html">$isolated</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pop.html">$pop</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/positional.html">$ (update)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pull.html">$pull</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pullAll.html">$pullAll</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/push.html">$push</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/pushAll.html">$pushAll</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/rename.html">$rename</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/set.html">$set</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/update/unset.html">$unset</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/projection/elemMatch.html">$elemMatch (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/projection/positional.html">$ (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/projection/slice.html">$slice (projection)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/comment.html">$comment</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/explain.html">$explain</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/hint.html">$hint</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/max.html">$max</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/maxScan.html">$maxScan</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/min.html">$min</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/natural.html">$natural</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/orderby.html">$orderby</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/query.html">$query</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/returnKey.html">$returnKey</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/showDiskLoc.html">$showDiskLoc</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/meta/snapshot.html">$snapshot</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/add.html">$add (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/addToSet.html">$addToSet (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/and.html">$and (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/avg.html">$avg (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/cmp.html">$cmp (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/cond.html">$cond (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/dayOfMonth.html">$dayOfMonth (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/dayOfWeek.html">$dayOfWeek (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/dayOfYear.html">$dayOfYear (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/divide.html">$divide (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/eq.html">$eq (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/first.html">$first (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/group.html">$group (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/gt.html">$gt (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/gte.html">$gte (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/hour.html">$hour (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/ifNull.html">$ifNull (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/last.html">$last (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/limit.html">$limit (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/lt.html">$lt (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/lte.html">$lte (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/match.html">$match (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/max.html">$max (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/min.html">$min (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/minute.html">$minute (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/mod.html">$mod (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/month.html">$month (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/multiply.html">$multiply (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/ne.html">$ne (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/not.html">$not (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/or.html">$or (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/project.html">$project (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/push.html">$push (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/second.html">$second (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/skip.html">$skip (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/sort.html">$sort (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/strcasecmp.html">$strcasecmp (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/substr.html">$substr (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/subtract.html">$subtract (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/sum.html">$sum (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/toLower.html">$toLower (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/toUpper.html">$toUpper (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/unwind.html">$unwind (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/week.html">$week (aggregation)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/operator/aggregation/year.html">$year (aggregation)</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/command.html">Database Commands</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/command/addShard.html">addShard</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/aggregate.html">aggregate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/applyOps.html">applyOps (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/authenticate.html">authenticate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/availableQueryOptions.html">availableQueryOptions (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/buildInfo.html">buildInfo</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/checkShardingIndex.html">checkShardingIndex (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/clean.html">clean (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/clone.html">clone</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/cloneCollection.html">cloneCollection</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/cloneCollectionAsCapped.html">cloneCollectionAsCapped</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/closeAllDatabases.html">closeAllDatabases (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/collMod.html">collMod</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/collStats.html">collStats</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/compact.html">compact</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/connPoolStats.html">connPoolStats</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/connPoolSync.html">connPoolSync (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/convertToCapped.html">convertToCapped</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/copydb.html">copydb</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/copydbgetnonce.html">copydbgetnonce (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/count.html">count</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/create.html">create</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/cursorInfo.html">cursorInfo</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dataSize.html">dataSize</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dbHash.html">dbHash (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dbStats.html">dbStats</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/diagLogging.html">diagLogging (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/distinct.html">distinct</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/driverOIDTest.html">driverOIDTest (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/drop.html">drop</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dropDatabase.html">dropDatabase</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/dropIndexes.html">dropIndexes</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/enableSharding.html">enableSharding</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/eval.html">eval</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/features.html">features (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/filemd5.html">filemd5</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/findAndModify.html">findAndModify</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/flushRouterConfig.html">flushRouterConfig</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/fsync.html">fsync</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/geoNear.html">geoNear</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/geoSearch.html">geoSearch</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/geoWalk.html">geoWalk</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getCmdLineOpts.html">getCmdLineOpts</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getLastError.html">getLastError</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getLog.html">getLog</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getParameter.html">getParameter</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getPrevError.html">getPrevError</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getShardMap.html">getShardMap (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getShardVersion.html">getShardVersion (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getnonce.html">getnonce (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/getoptime.html">getoptime (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/group.html">group</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/isMaster.html">isMaster</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/isSelf.html">isSelf (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/isdbgrid.html">isdbgrid</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/listCommands.html">listCommands</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/listDatabases.html">listDatabases</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/listShards.html">listShards</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/logRotate.html">logRotate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/logout.html">logout</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/mapReduce.html">mapReduce</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/medianKey.html">medianKey (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/moveChunk.html">moveChunk</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/movePrimary.html">movePrimary</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/netstat.html">netstat (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/ping.html">ping</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/profile.html">profile</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/reIndex.html">reIndex</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/removeShard.html">removeShard</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/renameCollection.html">renameCollection</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/repairDatabase.html">repairDatabase</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetFreeze.html">replSetFreeze</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetGetStatus.html">replSetGetStatus</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetInitiate.html">replSetInitiate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetMaintenance.html">replSetMaintenance</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetReconfig.html">replSetReconfig</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetStepDown.html">replSetStepDown</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/replSetSyncFrom.html">replSetSyncFrom</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/resetError.html">resetError</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/resync.html">resync</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/serverStatus.html">serverStatus</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/setParameter.html">setParameter</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/setShardVersion.html">setShardVersion</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/shardCollection.html">shardCollection</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/shardingState.html">shardingState</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/shutdown.html">shutdown</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/split.html">split</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/splitChunk.html">splitChunk</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/splitVector.html">splitVector</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/top.html">top</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/touch.html">touch</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/unsetSharding.html">unsetSharding (internal)</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/validate.html">validate</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/command/whatsmyuri.html">whatsmyuri (internal)</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/method.html">JavaScript Methods</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/method/Date.html">Date()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/Mongo.html">Mongo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/Mongo.getDB.html">Mongo.getDB()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ObjectId.getTimestamp.html">ObjectId.getTimestamp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ObjectId.toString.html">ObjectId.toString()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ObjectId.valueOf.html">ObjectId.valueOf()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cat.html">cat()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cd.html">cd()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/connect.html">connect()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/copyDbpath.html">copyDbpath()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.addOption.html">cursor.addOption()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.batchSize.html">cursor.batchSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.count.html">cursor.count()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.explain.html">cursor.explain()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.forEach.html">cursor.forEach()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.hasNext.html">cursor.hasNext()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.hint.html">cursor.hint()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.limit.html">cursor.limit()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.map.html">cursor.map()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.max.html">cursor.max()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.min.html">cursor.min()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.next.html">cursor.next()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.objsLeftInBatch.html">cursor.objsLeftInBatch()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.readPref.html">cursor.readPref()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.showDiskLoc.html">cursor.showDiskLoc()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.size.html">cursor.size()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.skip.html">cursor.skip()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.snapshot.html">cursor.snapshot()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.sort.html">cursor.sort()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/cursor.toArray.html">cursor.toArray()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.addUser.html">db.addUser()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.auth.html">db.auth()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.cloneCollection.html">db.cloneCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.cloneDatabase.html">db.cloneDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.aggregate.html">db.collection.aggregate()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.copyTo.html">db.collection.copyTo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.count.html">db.collection.count()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.createIndex.html">db.collection.createIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.dataSize.html">db.collection.dataSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.distinct.html">db.collection.distinct()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.drop.html">db.collection.drop()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.dropIndex.html">db.collection.dropIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.dropIndexes.html">db.collection.dropIndexes()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.ensureIndex.html">db.collection.ensureIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.find.html">db.collection.find()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.findAndModify.html">db.collection.findAndModify()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.findOne.html">db.collection.findOne()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.getIndexes.html">db.collection.getIndexes()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.getShardDistribution.html">db.collection.getShardDistribution()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.getShardVersion.html">db.collection.getShardVersion()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.group.html">db.collection.group()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.insert.html">db.collection.insert()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.isCapped.html">db.collection.isCapped()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.mapReduce.html">db.collection.mapReduce()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.reIndex.html">db.collection.reIndex()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.remove.html">db.collection.remove()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.renameCollection.html">db.collection.renameCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.save.html">db.collection.save()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.stats.html">db.collection.stats()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.storageSize.html">db.collection.storageSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.totalIndexSize.html">db.collection.totalIndexSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.totalSize.html">db.collection.totalSize()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.update.html">db.collection.update()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.collection.validate.html">db.collection.validate()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.commandHelp.html">db.commandHelp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.copyDatabase.html">db.copyDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.createCollection.html">db.createCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.currentOp.html">db.currentOp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.dropDatabase.html">db.dropDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.eval.html">db.eval()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.fsyncLock.html">db.fsyncLock()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.fsyncUnlock.html">db.fsyncUnlock()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getCollection.html">db.getCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getCollectionNames.html">db.getCollectionNames()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getLastError.html">db.getLastError()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getLastErrorObj.html">db.getLastErrorObj()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getMongo.html">db.getMongo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getName.html">db.getName()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getPrevError.html">db.getPrevError()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getProfilingLevel.html">db.getProfilingLevel()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getProfilingStatus.html">db.getProfilingStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getReplicationInfo.html">db.getReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.getSiblingDB.html">db.getSiblingDB()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.help.html">db.help()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.isMaster.html">db.isMaster()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.killOp.html">db.killOp()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.listCommands.html">db.listCommands()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.loadServerScripts.html">db.loadServerScripts()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.logout.html">db.logout()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printCollectionStats.html">db.printCollectionStats()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printReplicationInfo.html">db.printReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printShardingStatus.html">db.printShardingStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.printSlaveReplicationInfo.html">db.printSlaveReplicationInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.removeUser.html">db.removeUser()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.repairDatabase.html">db.repairDatabase()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.resetError.html">db.resetError()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.runCommand.html">db.runCommand()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.serverBuildInfo.html">db.serverBuildInfo()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.serverStatus.html">db.serverStatus()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.setProfilingLevel.html">db.setProfilingLevel()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.shutdownServer.html">db.shutdownServer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.stats.html">db.stats()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/db.version.html">db.version()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/fuzzFile.html">fuzzFile()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/getHostName.html">getHostName()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/getMemInfo.html">getMemInfo</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/hostname.html">hostname()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/isWindows.html">_isWindows()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/listFiles.html">listFiles()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/load.html">load()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/ls.html">ls()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/md5sumFile.html">md5sumFile()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/mkdir.html">mkdir()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/pwd.html">pwd()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/quit.html">quit()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rand.html">rand()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/removeFile.html">removeFile()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/resetDbpath.html">resetDbpath()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.add.html">rs.add()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.addArb.html">rs.addArb()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.conf.html">rs.conf()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.freeze.html">rs.freeze()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.help.html">rs.help()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.initiate.html">rs.initiate()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.reconfig.html">rs.reconfig()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.remove.html">rs.remove()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.status.html">rs.status()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.stepDown.html">rs.stepDown()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/rs.syncFrom.html">rs.syncFrom()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.addShard.html">sh.addShard()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.addShardTag.html">sh.addShardTag()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.addTagRange.html">sh.addTagRange()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.disableBalancing.html">sh.disableBalancing()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.enableBalancing.html">sh.enableBalancing()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.enableSharding.html">sh.enableSharding()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.getBalancerHost.html">sh.getBalancerHost()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.getBalancerState.html">sh.getBalancerState()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.help.html">sh.help()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.isBalancerRunning.html">sh.isBalancerRunning()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.moveChunk.html">sh.moveChunk()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.removeShardTag.html">sh.removeShardTag()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.setBalancerState.html">sh.setBalancerState()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.shardCollection.html">sh.shardCollection()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.splitAt.html">sh.splitAt()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.splitFind.html">sh.splitFind()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.startBalancer.html">sh.startBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.status.html">sh.status()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.stopBalancer.html">sh.stopBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.waitForBalancer.html">sh.waitForBalancer()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.waitForBalancerOff.html">sh.waitForBalancerOff()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/sh.waitForPingChange.html">sh.waitForPingChange()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/srand.html">_srand()</a></li><li class="toctree-l3"><a class="reference internal" href="../reference/method/version.html">version()</a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/sql-comparison.html">SQL to MongoDB Mapping Chart</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/sql-aggregation-comparison.html">SQL to Aggregation Mapping Chart</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/operators.html">Query, Update, and Projection Operators Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/meta-query-operators.html">Meta Query Operator Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/commands.html">Database Commands Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/javascript.html"><code class="docutils literal"><span class="pre">mongo</span></code> Shell JavaScript Quick Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/components.html">MongoDB Package Components</a><ul><li class="toctree-l3"><a class="reference internal" href="../reference/mongod.html"><code class="docutils literal"><span class="pre">mongod</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongos.html"><code class="docutils literal"><span class="pre">mongos</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongo.html"><code class="docutils literal"><span class="pre">mongo</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongod.exe.html"><code class="docutils literal"><span class="pre">mongod.exe</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongos.exe.html"><code class="docutils literal"><span class="pre">mongos.exe</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongodump.html"><code class="docutils literal"><span class="pre">mongodump</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongorestore.html"><code class="docutils literal"><span class="pre">mongorestore</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/bsondump.html"><code class="docutils literal"><span class="pre">bsondump</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongooplog.html"><code class="docutils literal"><span class="pre">mongooplog</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongoimport.html"><code class="docutils literal"><span class="pre">mongoimport</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongoexport.html"><code class="docutils literal"><span class="pre">mongoexport</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongostat.html"><code class="docutils literal"><span class="pre">mongostat</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongotop.html"><code class="docutils literal"><span class="pre">mongotop</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongosniff.html"><code class="docutils literal"><span class="pre">mongosniff</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongoperf.html"><code class="docutils literal"><span class="pre">mongoperf</span></code></a></li><li class="toctree-l3"><a class="reference internal" href="../reference/mongofiles.html"><code class="docutils literal"><span class="pre">mongofiles</span></code></a></li></ul></li><li class="toctree-l2"><a class="reference internal" href="../reference/configuration-options.html">Configuration File Options</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/connection-string.html">Connection String URI Format</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/server-status-index.html">Server Status Output Index</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/server-status.html">Server Status Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/database-statistics.html">Database Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/collection-statistics.html">Collection Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/collection-validation.html">Collection Validation Data</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/connection-pool-stats.html">Connection Pool Statistics Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replica-status.html">Replica Set Status Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replica-configuration.html">Replica Set Configuration</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/replication-info.html">Replication Info Reference</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/current-op.html">Current Operation Reporting</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/database-profiler.html">Database Profiler Output</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/explain.html">Explain Output</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/exit-codes.html">Exit Codes and Statuses</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/config-database.html">Config Database Contents</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/local-database.html">The <code class="docutils literal"><span class="pre">local</span></code> Database</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/system-collections.html">System Collections</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/limits.html">MongoDB Limits and Thresholds</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/mongodb-extended-json.html">MongoDB Extended JSON</a></li><li class="toctree-l2"><a class="reference internal" href="../reference/glossary.html">Glossary</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/2.2.html">Release Notes for MongoDB 2.2</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/2.0.html">Release Notes for MongoDB 2.0</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.8.html">Release Notes for MongoDB 1.8</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.6.html">Release Notes for MongoDB 1.6</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.4.html">Release Notes for MongoDB 1.4</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/1.2.html">Release Notes for MongoDB 1.2.x</a></li><li class="toctree-l2"><a class="reference internal" href="../release-notes/drivers-write-concern.html">Default Write Concern Change</a></li></ul></li></ul>


    </div>
  </div>
           
         </aside>

   </div>

    <div id="main-column" class="main-column">

    <span id="showNav" class="showNav">Navigation</span>

      
            <div class="alert alert-warning">
              <span class="alert-message">This version of the documentation is archived and no longer supported.</span>
            </div>
      
        <div class="document">
            <div class="documentwrapper"><div class="bodywrapper">
              <div class="body" data-pagename="administration/replica-sets">
                   <a class="edit-link" href="https://github.com/mongodb/docs/blob/v2.2/source/administration/replica-sets.txt" target="_blank" title="Edit administration/replica-sets.txt on GitHub">
    
      <span class="icon-edit"></span>
    
  </a>
                

                
  <div class="bc">
    
      <ul>
          <li><a href="../replication.html">Replication</a><span class="bcpoint"> &gt; </span></li>
            <li>Replica Set Operation and Management</li> 
      </ul>
    
    
  </div>
                
                  <div class="section" id="replica-set-operation-and-management">
<h1>Replica Set Operation and Management<a class="headerlink" href="#replica-set-operation-and-management" title="Permalink to this headline">&para;</a></h1>
<div class="contents singlecol local topic" id="on-this-page">
<p class="topic-title first">On this page</p>
<ul class="simple">
<li><a class="reference internal" href="#member-configurations" id="id1">Member Configurations</a></li>
<li><a class="reference internal" href="#procedures" id="id2">Procedures</a></li>
<li><a class="reference internal" href="#security-considerations-for-replica-sets" id="id3">Security Considerations for Replica Sets</a></li>
<li><a class="reference internal" href="#troubleshooting-replica-sets" id="id4">Troubleshooting Replica Sets</a></li>
</ul>
</div>
<p><a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">Replica sets</span></a> automate most administrative tasks
associated with database replication.  Nevertheless, several
operations related to deployment and systems management require
administrator intervention remain. This document provides an overview
of those tasks, in addition to a collection of troubleshooting
suggestions for administers of replica sets.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<ul class="simple">
<li><a class="reference internal" href="../reference/replica-commands.html#rs.status" title="rs.status()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.status()</span></code></a> and <a class="reference internal" href="../reference/replica-commands.html#db.isMaster" title="db.isMaster()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.isMaster()</span></code></a></li>
<li><a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">Replica Set Reconfiguration Process</span></a></li>
<li><a class="reference internal" href="../reference/replica-commands.html#rs.conf" title="rs.conf()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.conf()</span></code></a> and <a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a></li>
<li><a class="reference internal" href="../reference/replica-configuration.html"><span class="doc">Replica Set Configuration</span></a></li>
</ul>
<p>The following tutorials provide task-oriented instructions for
specific administrative tasks related to replica set operation.</p>
<ul class="last simple">
<li><a class="reference internal" href="../tutorial/deploy-replica-set.html"><span class="doc">Deploy a Replica Set</span></a></li>
<li><a class="reference internal" href="../tutorial/convert-standalone-to-replica-set.html"><span class="doc">Convert a Standalone to a Replica Set</span></a></li>
<li><a class="reference internal" href="../tutorial/expand-replica-set.html"><span class="doc">Add Members to a Replica Set</span></a></li>
<li><a class="reference internal" href="../tutorial/deploy-geographically-distributed-replica-set.html"><span class="doc">Deploy a Geographically Distributed Replica Set</span></a></li>
<li><a class="reference internal" href="../tutorial/change-oplog-size.html"><span class="doc">Change the Size of the Oplog</span></a></li>
<li><a class="reference internal" href="../tutorial/force-member-to-be-primary.html"><span class="doc">Force a Member to Become Primary</span></a></li>
<li><a class="reference internal" href="../tutorial/change-hostnames-in-a-replica-set.html"><span class="doc">Change Hostnames in a Replica Set</span></a></li>
<li><a class="reference internal" href="../tutorial/convert-secondary-into-arbiter.html"><span class="doc">Convert a Secondary to an Arbiter</span></a></li>
<li><a class="reference internal" href="../tutorial/reconfigure-replica-set-with-unavailable-members.html"><span class="doc">Reconfigure a Replica Set with Unavailable Members</span></a></li>
<li><a class="reference internal" href="../tutorial/recover-data-following-unexpected-shutdown.html"><span class="doc">Recover MongoDB Data following Unexpected Shutdown</span></a></li>
</ul>
</div>
<div class="section" id="member-configurations">
<span id="replica-set-member-configurations"></span><span id="replica-set-node-configurations"></span><h2>Member Configurations<a class="headerlink" href="#member-configurations" title="Permalink to this headline">&para;</a></h2>
<p>All <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica sets</span></a> have a single <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> and one or more
<a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondaries</span></a>. Replica sets allow you to configure
secondary members in a variety of ways. This section describes these
configurations.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">A replica set can have up to 12 members, but only 7 members can have
votes. For configuration information regarding non-voting members, see
<a class="reference internal" href="#replica-set-non-voting-members"><span class="std std-ref">Non-Voting Members</span></a>.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The <a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a> shell method can force the current
primary to step down, which causes an <a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">election</span></a>.
When the primary steps down, the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> closes all client
connections. While this typically takes 10-20 seconds, attempt to
make these changes during scheduled maintenance periods. To
successfully reconfigure a replica set, a majority of the members
must be accessible.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">Elections</span></a> section in the
<a class="reference internal" href="../core/replication.html"><span class="doc">Replica Set Fundamental Concepts</span></a> document, and the
<a class="reference internal" href="../core/replication-internals.html#replica-set-election-internals"><span class="std std-ref">Election Internals</span></a> section in the
<a class="reference internal" href="../core/replication-internals.html"><span class="doc">Replica Set Internals and Behaviors</span></a> document.</p>
</div>
<div class="section" id="secondary-only-members">
<span id="replica-set-secondary-only-configuration"></span><span id="replica-set-secondary-only-members"></span><span id="index-0"></span><h3>Secondary-Only Members<a class="headerlink" href="#secondary-only-members" title="Permalink to this headline">&para;</a></h3>
<p>The secondary-only configuration prevents a <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> member in a
<a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> from ever becoming a <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> in a
<a class="reference internal" href="../reference/glossary.html#term-failover"><span class="xref std std-term">failover</span></a>. You can set secondary-only mode for any member of
the set except the current primary.</p>
<p>For example, you may want to configure all members of a replica sets
located outside of the main data centers as secondary-only to prevent
these members from ever becoming primary.</p>
<p>To configure a member as secondary-only, set its
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> value to <code class="docutils literal"><span class="pre">0</span></code>. Any member with a
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> equal to <code class="docutils literal"><span class="pre">0</span></code> will never seek
<a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">election</span></a> and cannot become primary in any
situation. For more information on priority levels, see
<a class="reference internal" href="../core/replication.html#replica-set-node-priority"><span class="std std-ref">Member Priority</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When updating the replica configuration object, address all members
of the set using the index value in the array. The array index
begins with <code class="docutils literal"><span class="pre">0</span></code>. Do not confuse this index value with the value
of the <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n]._id" title="local.system.replset.members[n]._id"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">_id</span></code></a> field in each document in the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members" title="local.system.replset.members"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">members</span></code></a> array.</p>
<p class="last">The <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n]._id" title="local.system.replset.members[n]._id"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">_id</span></code></a> rarely corresponds to the array
index.</p>
</div>
<p>As an example of modifying member priorities, assume a four-member
replica set. Use the following sequence of operations in the
<a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell to modify member priorities:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mi">1</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This reconfigures the set, with the following priority settings:</p>
<ul class="simple">
<li>Member <code class="docutils literal"><span class="pre">0</span></code> to a priority of <code class="docutils literal"><span class="pre">2</span></code> so that it becomes primary, under
most circumstances.</li>
<li>Member <code class="docutils literal"><span class="pre">1</span></code> to a priority of <code class="docutils literal"><span class="pre">1</span></code>, which is the default value.
Member <code class="docutils literal"><span class="pre">1</span></code> becomes primary if no member with a <em>higher</em> priority is
eligible.</li>
<li>Member <code class="docutils literal"><span class="pre">2</span></code> to a priority of <code class="docutils literal"><span class="pre">0.5</span></code>, which makes it less likely to
become primary than other members but doesn&rsquo;t prohibit the
possibility.</li>
<li>Member <code class="docutils literal"><span class="pre">3</span></code> to a priority of <code class="docutils literal"><span class="pre">0</span></code>.
Member <code class="docutils literal"><span class="pre">3</span></code> cannot become the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> member under any
circumstances.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If your replica set has an even number of members, add an
<a class="reference internal" href="#replica-set-arbiters"><span class="std std-ref">arbiter</span></a> to ensure that
members can quickly obtain a majority of votes in an
election for primary.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">MongoDB does not permit the current <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> to have a
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> of <code class="docutils literal"><span class="pre">0</span></code>.  If you
want to prevent the current primary from becoming primary, first
use <a class="reference internal" href="../reference/replica-commands.html#rs.stepDown" title="rs.stepDown()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.stepDown()</span></code></a> to step down the current primary, and
then <a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">reconfigure the replica set</span></a> with <a class="reference internal" href="../reference/replica-commands.html#rs.conf" title="rs.conf()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.conf()</span></code></a> and
<a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a>.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> and
<a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">Replica Set Reconfiguration</span></a>.</p>
</div>
</div>
<div class="section" id="hidden-members">
<span id="replica-set-hidden-configuration"></span><span id="replica-set-hidden-members"></span><span id="index-1"></span><h3>Hidden Members<a class="headerlink" href="#hidden-members" title="Permalink to this headline">&para;</a></h3>
<p>Hidden members are part of a replica set but cannot become
primary and are invisible to client applications. <em>However,</em>
hidden members <strong>do</strong> vote in <a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">elections</span></a>.</p>
<p>Hidden members are ideal for instances that will have significantly
different usage patterns than the other members and require separation
from normal traffic. Typically, hidden members provide reporting,
dedicated backups, and dedicated read-only testing and integration
support.</p>
<p>Hidden members have <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> set
<code class="docutils literal"><span class="pre">0</span></code> and have <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].hidden" title="local.system.replset.members[n].hidden"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">hidden</span></code></a> set to <code class="docutils literal"><span class="pre">true</span></code>.</p>
<p>To configure a <a class="reference internal" href="../reference/glossary.html#term-hidden-member"><span class="xref std std-term">hidden member</span></a>, use the following sequence of
operations in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">hidden</span> <span class="o">=</span> <span class="kc">true</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After re-configuring the set, the first member of the set in the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members" title="local.system.replset.members"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">members</span></code></a> array will have a priority of <code class="docutils literal"><span class="pre">0</span></code>
so that it cannot become primary. The other members in the set will
not advertise the hidden member in the <a class="reference internal" href="../reference/replica-commands.html#dbcmd.isMaster" title="isMaster"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">isMaster</span></code></a> or
<a class="reference internal" href="../reference/replica-commands.html#db.isMaster" title="db.isMaster()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.isMaster()</span></code></a> output.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You must send the <a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a> command to a set member
that <em>can</em> become <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. In the above example, if you
issue the <a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a> operation to a member with a
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> of <code class="docutils literal"><span class="pre">0</span></code> the operation will
fail.</p>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.0.</span></p>
</div>
<p class="last">For <a class="reference internal" href="../reference/glossary.html#term-sharded-cluster"><span class="xref std std-term">sharded clusters</span></a> running with replica sets before 2.0 if
you reconfigured a member as hidden, you <em>had</em> to restart
<a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> to prevent queries from reaching the hidden
member.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../applications/replication.html#replica-set-read-preference"><span class="std std-ref">Replica Set Read Preference</span></a>
and <a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">Replica Set Reconfiguration</span></a>.</p>
</div>
</div>
<div class="section" id="delayed-members">
<span id="replica-set-delayed-configuration"></span><span id="replica-set-delayed-members"></span><span id="index-2"></span><h3>Delayed Members<a class="headerlink" href="#delayed-members" title="Permalink to this headline">&para;</a></h3>
<p>Delayed members copy and apply operations from the primary&rsquo;s <a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a> with
a specified delay. If a member has a delay of one hour, then
the latest entry in this member&rsquo;s oplog will not be more recent than
one hour old, and the state of data for the member will reflect the state of the
set an hour earlier.</p>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p class="last">If the current time is 09:52 and the secondary is a
delayed by an hour, no operation will be more recent than 08:52.</p>
</div>
<p>Delayed members may help recover from various kinds of human error. Such
errors may include inadvertently deleted databases or botched
application upgrades. Consider the following factors when determining
the amount of slave delay to apply:</p>
<ul class="simple">
<li>Ensure that the length of the delay is equal to or greater than your
maintenance windows.</li>
<li>The size of the oplog is sufficient to capture <em>more than</em> the
number of operations that typically occur in that period of
time. For more information on oplog size, see the
<a class="reference internal" href="../core/replication.html#replica-set-oplog-sizing"><span class="std std-ref">Oplog</span></a> topic in the <a class="reference internal" href="../core/replication.html"><span class="doc">Replica Set Fundamental Concepts</span></a> document.</li>
</ul>
<p>Delayed members must have a <a class="reference internal" href="../reference/glossary.html#term-priority"><span class="xref std std-term">priority</span></a> set to <code class="docutils literal"><span class="pre">0</span></code> to prevent
them from becoming primary in their replica sets. Also these members
should be <a class="reference internal" href="#replica-set-hidden-members"><span class="std std-ref">hidden</span></a> to prevent your
application from seeing or querying this member.</p>
<p>To configure a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> member with a one hour delay, use the
following sequence of operations in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">slaveDelay</span> <span class="o">=</span> <span class="mi">3600</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>After the replica set reconfigures, the first member of the set in the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members" title="local.system.replset.members"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">members</span></code></a> array will have a priority
of <code class="docutils literal"><span class="pre">0</span></code> and cannot become <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. The
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].slaveDelay" title="local.system.replset.members[n].slaveDelay"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">slaveDelay</span></code></a> value
delays both replication and the member&rsquo;s <a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a> by 3600 seconds (1
hour). Setting <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].slaveDelay" title="local.system.replset.members[n].slaveDelay"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">slaveDelay</span></code></a> to a
non-zero value also sets <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].hidden" title="local.system.replset.members[n].hidden"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">hidden</span></code></a> to
<code class="docutils literal"><span class="pre">true</span></code> for this replica set so that it does not receive application
queries in normal operations.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The length of the secondary
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].slaveDelay" title="local.system.replset.members[n].slaveDelay"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">slaveDelay</span></code></a> must
fit within the window of the oplog. If the oplog is shorter than
the <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].slaveDelay" title="local.system.replset.members[n].slaveDelay"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">slaveDelay</span></code></a>
window, the delayed member cannot successfully replicate
operations.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].slaveDelay" title="local.system.replset.members[n].slaveDelay"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">slaveDelay</span></code></a>, <a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">Replica Set Reconfiguration</span></a>, <a class="reference internal" href="../core/replication.html#replica-set-oplog-sizing"><span class="std std-ref">Oplog</span></a>,
<a class="reference internal" href="#replica-set-procedure-change-oplog-size"><span class="std std-ref">Changing Oplog Size</span></a> in this document,
and the <a class="reference internal" href="../tutorial/change-oplog-size.html"><span class="doc">Change the Size of the Oplog</span></a> tutorial.</p>
</div>
</div>
<div class="section" id="arbiters">
<span id="replica-set-arbiter-configuration"></span><span id="replica-set-arbiters"></span><span id="index-3"></span><h3>Arbiters<a class="headerlink" href="#arbiters" title="Permalink to this headline">&para;</a></h3>
<p>Arbiters are special <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instances that do not hold a
copy of the data and thus cannot become primary. Arbiters exist solely
to participate in <a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">elections</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Because of their minimal system requirements, you may safely deploy an
arbiter on a system with another workload, such as an application
server or monitoring member.</p>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Do not run arbiter processes on a system that is an active
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> of its <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>.</p>
</div>
<p>Arbiters never receive the contents of any collection but do have the
following interactions with the rest of the replica set:</p>
<ul>
<li><p class="first">Credential exchanges that authenticate the arbiter with
the replica set. All MongoDB processes within a replica set use
keyfiles. These exchanges are encrypted.</p>
<p>MongoDB only transmits the authentication credentials in a
cryptographically secure exchange, and encrypts no other
exchange.</p>
</li>
<li><p class="first">Exchanges of replica set configuration data and of votes. These are
not encrypted.</p>
</li>
</ul>
<p>If your MongoDB deployment uses SSL, then all communications between
arbiters and the other members of the replica set are secure. See the
documentation for <a class="reference internal" href="ssl.html"><span class="doc">Use MongoDB with SSL Connections</span></a> for more information.
As with all MongoDB components, run arbiters on secure networks.</p>
<p>To add an arbiter, see <a class="reference internal" href="#replica-set-procedure-add-arbiter"><span class="std std-ref">Adding an Arbiter</span></a>.</p>
</div>
<div class="section" id="non-voting-members">
<span id="replica-set-non-voting-members"></span><span id="replica-set-non-voting-configuration"></span><span id="index-4"></span><h3>Non-Voting Members<a class="headerlink" href="#non-voting-members" title="Permalink to this headline">&para;</a></h3>
<p>You may choose to change the number of votes that each member has in
<a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">elections</span></a> for <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. In general, all
members should have only 1 vote to prevent intermittent ties, deadlock,
or the wrong members from becoming <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. Use <a class="reference internal" href="../core/replication.html#replica-set-node-priority"><span class="std std-ref">replica
set priorities</span></a> to control which members
are more likely to become primary.</p>
<p>To disable a member&rsquo;s ability to vote in elections, use the following
command sequence in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell.</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">votes</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">4</span><span class="p">].</span><span class="nx">votes</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">5</span><span class="p">].</span><span class="nx">votes</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This sequence gives <code class="docutils literal"><span class="pre">0</span></code> votes to the fourth, fifth, and sixth
members of the set according to the order of the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members" title="local.system.replset.members"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">members</span></code></a> array in the output of
<a class="reference internal" href="../reference/replica-commands.html#rs.conf" title="rs.conf()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.conf()</span></code></a>.  This setting allows the set to elect these
members as <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> but does not allow them to vote in
elections. If you have three non-voting members, you can add three
additional voting members to your set. Place voting members so that
your designated primary or primaries can reach a majority of votes in
the event of a network partition.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In general and when possible, all members should have only 1 vote. This
prevents intermittent ties, deadlocks, or the wrong members from
becoming primary. Use <a class="reference internal" href="../core/replication.html#replica-set-node-priority"><span class="std std-ref">Replica Set Priorities</span></a> to control which members are more
likely to become primary.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].votes" title="local.system.replset.members[n].votes"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">votes</span></code></a> and <a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">Replica Set
Reconfiguration</span></a>.</p>
</div>
</div>
<div class="section" id="chained-replication">
<span id="replica-set-chained-replication"></span><h3>Chained Replication<a class="headerlink" href="#chained-replication" title="Permalink to this headline">&para;</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.0.</span></p>
</div>
<p>Chained replication occurs when a <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> member replicates
from another secondary member instead of from the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. This
might be the case, for example, if a secondary selects its replication
target based on ping time and if the closest member is another secondary.</p>
<p>Chained replication can reduce load on the primary. But chained
replication can also result in increased replication lag, depending on
the topology of the network.</p>
<p>Beginning with version 2.2.4, you can use the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.chainingAllowed" title="local.system.replset.settings.chainingAllowed"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">chainingAllowed</span></code></a> setting in
<a class="reference internal" href="../reference/replica-configuration.html"><span class="doc">Replica Set Configuration</span></a> to disable chained replication
for situations where chained replication is causing lag. For details,
see <a class="reference internal" href="#replica-set-chained-replication"><span class="std std-ref">Chained Replication</span></a>.</p>
</div>
</div>
<div class="section" id="procedures">
<h2>Procedures<a class="headerlink" href="#procedures" title="Permalink to this headline">&para;</a></h2>
<p>This section gives overview information on a number of replica set
administration procedures. You can find documentation of additional
procedures in the <a class="reference internal" href="../replication.html#replica-set-tutorials-list"><span class="std std-ref">replica set tutorials</span></a> section.</p>
<div class="section" id="adding-members">
<span id="replica-set-admin-procedure-add-member"></span><h3>Adding Members<a class="headerlink" href="#adding-members" title="Permalink to this headline">&para;</a></h3>
<p>Before adding a new member to an existing <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>, do one of
the following to prepare the new member&rsquo;s <a class="reference internal" href="../reference/glossary.html#term-dbpath"><span class="xref std std-term">data directory</span></a>:</p>
<ul>
<li><p class="first">Make sure the new member&rsquo;s data directory <em>does not</em> contain data. The
new member will copy the data from an existing member.</p>
<p>If the new member is in a <a class="reference internal" href="../reference/glossary.html#term-recovering"><span class="xref std std-term">recovering</span></a> state, it must exit and
become a <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> before MongoDB
can copy all data as part of the replication process. This process
takes time but does not require administrator intervention.</p>
</li>
<li><p class="first">Manually copy the data directory from an existing member. The new
member becomes a secondary member and will catch up to the current
state of the replica set after a short interval. Copying the data over
manually shortens the amount of time for the new member to become
current.</p>
<p>Ensure that you can copy the data directory to the new member and
begin replication within the <a class="reference internal" href="../core/replication.html#replica-set-oplog-sizing"><span class="std std-ref">window allowed by the oplog</span></a>. If the
difference in the amount of time between the most recent operation and
the most recent operation to the database exceeds the length of the
<a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a> on the existing members, then the new instance will have
to perform an initial sync, which completely resynchronizes the data, as described in
<a class="reference internal" href="#replica-set-resync-stale-member"><span class="std std-ref">Resyncing a Member of a Replica Set</span></a>.</p>
<blockquote>
<div><p>Use <a class="reference internal" href="../reference/method/db.printReplicationInfo.html#db.printReplicationInfo" title="db.printReplicationInfo()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.printReplicationInfo()</span></code></a> to check the current state of
replica set members with regards to the oplog.</p>
</div></blockquote>
</li>
</ul>
<p>For the procedure to add a member to a replica set, see
<a class="reference internal" href="../tutorial/expand-replica-set.html"><span class="doc">Add Members to a Replica Set</span></a>.</p>
</div>
<div class="section" id="removing-members">
<span id="replica-set-admin-procedure-remove-members"></span><h3>Removing Members<a class="headerlink" href="#removing-members" title="Permalink to this headline">&para;</a></h3>
<p>You may remove a member of a replica set at any time; <em>however</em>, for best
results always <em>shut down</em> the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance before
removing it from a  replica set.</p>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 2.2: </span>Before 2.2, you <em>had</em> to shut down the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance
before removing it. While 2.2 removes this  requirement, it remains
good practice.</p>
</div>
<p>To remove a member, use the
<a class="reference internal" href="../reference/replica-commands.html#rs.remove" title="rs.remove()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.remove()</span></code></a> method in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell while
connected to the current <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. Issue the
<a class="reference internal" href="../reference/replica-commands.html#db.isMaster" title="db.isMaster()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.isMaster()</span></code></a> command when connected to <em>any</em> member of the
set to determine the current primary. Use a command in either
of the following forms to remove the member:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">rs</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&#34;mongo2.example.net:27017&#34;</span><span class="p">)</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">remove</span><span class="p">(</span><span class="s2">&#34;mongo3.example.net&#34;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This operation disconnects the shell briefly and forces a
re-connection as the <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> renegotiates which member
will be primary. The shell displays an error even if this
command succeeds.</p>
<p>You can re-add a removed member to a replica set at any time using the
<a class="reference internal" href="#replica-set-admin-procedure-add-member"><span class="std std-ref">procedure for adding replica set members</span></a>.
Additionally, consider using the <a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">replica set reconfiguration procedure</span></a> to change the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].host" title="local.system.replset.members[n].host"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">host</span></code></a> value to rename a member in a replica set
directly.</p>
</div>
<div class="section" id="replacing-a-member">
<span id="replica-set-admin-procedure-replace-member"></span><h3>Replacing a Member<a class="headerlink" href="#replacing-a-member" title="Permalink to this headline">&para;</a></h3>
<p>Use this procedure to replace a member of a replica set when the hostname
has changed. This procedure preserves all existing configuration
for a member, except its hostname/location.</p>
<p>You may need to replace a replica set member if you want to replace an
existing system and only need to change the hostname rather than
completely replace all configured options related to the previous
member.</p>
<p>Use <a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a> to change the value of the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].host" title="local.system.replset.members[n].host"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">host</span></code></a> field to reflect the new hostname or port
number. <a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a> will not change the value of
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n]._id" title="local.system.replset.members[n]._id"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">_id</span></code></a>.</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">host</span> <span class="o">=</span> <span class="s2">&#34;mongo2.example.net:27019&#34;</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Any replica set configuration change can trigger the current
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> to step down, which forces an <a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">election</span></a>. This
causes the current shell session, and clients connected to this replica set,
to produce an error even when the operation succeeds.</p>
</div>
</div>
<div class="section" id="adjusting-priority">
<span id="replica-set-member-priority-configuration"></span><span id="replica-set-node-priority-configuration"></span><h3>Adjusting Priority<a class="headerlink" href="#adjusting-priority" title="Permalink to this headline">&para;</a></h3>
<p>To change the value of the <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> in the
replica set configuration, use the following sequence of commands in
the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">conf</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mf">0.5</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">members</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">priority</span> <span class="o">=</span> <span class="mi">2</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The first operation uses <a class="reference internal" href="../reference/replica-commands.html#rs.conf" title="rs.conf()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.conf()</span></code></a> to set the local variable
<code class="docutils literal"><span class="pre">cfg</span></code> to the contents of the current replica set configuration, which
is a <a class="reference internal" href="../reference/glossary.html#term-document"><span class="xref std std-term">document</span></a>. The next three operations change the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> value in the <code class="docutils literal"><span class="pre">cfg</span></code> document for the
first three members configured in the <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members" title="local.system.replset.members"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">members</span></code></a> array. The final operation
calls <a class="reference internal" href="../reference/replica-commands.html#rs.reconfig" title="rs.reconfig()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.reconfig()</span></code></a> with the argument of <code class="docutils literal"><span class="pre">cfg</span></code> to initialize
the new configuration.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>When updating the replica configuration object, address all members
of the set using the index value in the array. The array index
begins with <code class="docutils literal"><span class="pre">0</span></code>. Do not confuse this index value with the value
of the <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n]._id" title="local.system.replset.members[n]._id"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">_id</span></code></a> field in each document in the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members" title="local.system.replset.members"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">members</span></code></a> array.</p>
<p class="last">The <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n]._id" title="local.system.replset.members[n]._id"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">_id</span></code></a> rarely corresponds to the array
index.</p>
</div>
<p>If a member has <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> set to <code class="docutils literal"><span class="pre">0</span></code>, it is
ineligible to become <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> and will not seek
election. <a class="reference internal" href="#replica-set-hidden-members"><span class="std std-ref">Hidden members</span></a>,
<a class="reference internal" href="#replica-set-delayed-members"><span class="std std-ref">delayed members</span></a>, and
<a class="reference internal" href="#replica-set-arbiters"><span class="std std-ref">arbiters</span></a> all have <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a>
set to <code class="docutils literal"><span class="pre">0</span></code>.</p>
<p>All members have a <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> equal to <code class="docutils literal"><span class="pre">1</span></code> by default.</p>
<p>The value of <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> can be any floating point
(i.e. decimal) number between <code class="docutils literal"><span class="pre">0</span></code> and <code class="docutils literal"><span class="pre">1000</span></code>. Priorities
are only used to determine the preference in election. The priority
value is used only in relation to other members. With the exception of
members with a priority of <code class="docutils literal"><span class="pre">0</span></code>, the absolute value of the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> value is irrelevant.</p>
<p>Replica sets will preferentially elect and maintain the primary status
of the member with the highest <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members[n].priority" title="local.system.replset.members[n].priority"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code></a> setting.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>Replica set reconfiguration can force the current primary to step
down, leading to an election for primary in the replica
set. Elections cause the current primary to close all open
<a class="reference internal" href="../reference/glossary.html#term-client"><span class="xref std std-term">client</span></a> connections.</p>
<p class="last">Perform routine replica set reconfiguration during scheduled
maintenance windows.</p>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="../reference/replica-configuration.html#replica-set-reconfiguration-usage"><span class="std std-ref">Replica Reconfiguration Usage</span></a> example revolves around
changing the priorities of the <a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.members" title="local.system.replset.members"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">members</span></code></a> of a replica set.</p>
</div>
</div>
<div class="section" id="adding-an-arbiter">
<span id="replica-set-procedure-add-arbiter"></span><h3>Adding an Arbiter<a class="headerlink" href="#adding-an-arbiter" title="Permalink to this headline">&para;</a></h3>
<p>For a description of <a class="reference internal" href="../reference/glossary.html#term-arbiter"><span class="xref std std-term">arbiters</span></a> and their purpose in
<a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica sets</span></a>, see <a class="reference internal" href="#replica-set-arbiters"><span class="std std-ref">Arbiters</span></a>.</p>
<p>To prevent tied <a class="reference internal" href="../reference/glossary.html#term-election"><span class="xref std std-term">elections</span></a>, do not add an arbiter to a
set if the set already has an odd number of voting members.</p>
<p>Because arbiters do not hold a copies of collection data, they have minimal
resource requirements and do not require dedicated hardware.</p>
<ol class="arabic">
<li><p class="first">Create a data directory for the arbiter. The <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> uses
this directory for
configuration information. It <em>will not</em> hold database collection data.
The following example creates the <code class="docutils literal"><span class="pre">/data/arb</span></code> data directory:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-sh"><div class="highlight"><pre><span></span>mkdir /data/arb
</pre></div>
</div>
</div>
</li>
<li><p class="first">Start the arbiter, making sure to specify the replica set name and
the data directory. Consider the following example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-sh"><div class="highlight"><pre><span></span>mongod --port <span class="m">30000</span> --dbpath /data/arb --replSet rs
</pre></div>
</div>
</div>
</li>
<li><p class="first">In a <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell connected to the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>, add the
arbiter to the replica set by issuing the <a class="reference internal" href="../reference/replica-commands.html#rs.addArb" title="rs.addArb()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.addArb()</span></code></a>
method, which uses the following syntax:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">rs</span><span class="p">.</span><span class="nx">addArb</span><span class="p">(</span><span class="s2">&#34;&lt;hostname&gt;&lt;:port&gt;&#34;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>For example, if the arbiter runs on <code class="docutils literal"><span class="pre">m1.example.net:30000</span></code>, you
would issue this command:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">rs</span><span class="p">.</span><span class="nx">addArb</span><span class="p">(</span><span class="s2">&#34;m1.example.net:30000&#34;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
</ol>
</div>
<div class="section" id="manually-configure-a-secondary-s-sync-target">
<span id="replica-set-configure-sync-target"></span><h3>Manually Configure a Secondary&rsquo;s Sync Target<a class="headerlink" href="#manually-configure-a-secondary-s-sync-target" title="Permalink to this headline">&para;</a></h3>
<p>To override the default sync target selection logic, you may manually
configure a <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> member&rsquo;s sync target for pulling
<a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a> entries temporarily. The following operations provide
access to this functionality:</p>
<ul class="simple">
<li><a class="reference internal" href="../reference/replica-commands.html#dbcmd.replSetSyncFrom" title="replSetSyncFrom"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">replSetSyncFrom</span></code></a> command, or</li>
<li><a class="reference internal" href="../reference/replica-commands.html#rs.syncFrom" title="rs.syncFrom()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.syncFrom()</span></code></a> helper in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell</li>
</ul>
<p>Only modify the default sync logic as needed, and always exercise
caution.  <a class="reference internal" href="../reference/replica-commands.html#rs.syncFrom" title="rs.syncFrom()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.syncFrom()</span></code></a> will not affect an in-progress
initial sync operation. To affect the sync target for the initial sync, run
<a class="reference internal" href="../reference/replica-commands.html#rs.syncFrom" title="rs.syncFrom()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.syncFrom()</span></code></a> operation <em>before</em> initial sync.</p>
<p>If you run <a class="reference internal" href="../reference/replica-commands.html#rs.syncFrom" title="rs.syncFrom()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.syncFrom()</span></code></a> during initial sync, MongoDB
produces no error messages, but the sync target will not change until
after the initial sync operation.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p><a class="reference internal" href="../reference/replica-commands.html#dbcmd.replSetSyncFrom" title="replSetSyncFrom"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">replSetSyncFrom</span></code></a> and <a class="reference internal" href="../reference/replica-commands.html#rs.syncFrom" title="rs.syncFrom()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.syncFrom()</span></code></a> provide a
temporary override of default behavior. If:</p>
<ul class="simple">
<li>the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance restarts or</li>
<li>the connection to the sync target closes;</li>
</ul>
<p class="last">then, the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance will revert to the default sync
logic and target.</p>
</div>
</div>
<div class="section" id="manage-chained-replication">
<span id="replica-set-config-chained-replication"></span><h3>Manage Chained Replication<a class="headerlink" href="#manage-chained-replication" title="Permalink to this headline">&para;</a></h3>
<div class="versionadded">
<p><span class="versionmodified">New in version 2.2.4.</span></p>
</div>
<p>MongoDB enables <a class="reference internal" href="#replica-set-chained-replication"><span class="std std-ref">chained replication</span></a> by default. This procedure
describes how to disable it and how to re-enable it.</p>
<p>To disable chained replication, set the
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.chainingAllowed" title="local.system.replset.settings.chainingAllowed"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">chainingAllowed</span></code></a>
field in <a class="reference internal" href="../reference/replica-configuration.html"><span class="doc">Replica Set Configuration</span></a> to <code class="docutils literal"><span class="pre">false</span></code>.</p>
<p>You can use the following sequence of commands to set
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.chainingAllowed" title="local.system.replset.settings.chainingAllowed"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">chainingAllowed</span></code></a> to
<code class="docutils literal"><span class="pre">false</span></code>:</p>
<ol class="arabic">
<li><p class="first">Copy the configuration settings into the <code class="docutils literal"><span class="pre">cfg</span></code> object:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">config</span><span class="p">()</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Take note of whether the current configuration settings contain the
<code class="docutils literal"><span class="pre">settings</span></code> sub-document. If they do, skip this step.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">To avoid data loss, skip this step if the configuration
settings contain the <code class="docutils literal"><span class="pre">settings</span></code> sub-document.</p>
</div>
<p>If the current configuration settings <strong>do not</strong> contain the
<code class="docutils literal"><span class="pre">settings</span></code> sub-document, create the sub-document by issuing the
following command:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span> <span class="o">=</span> <span class="p">{</span> <span class="p">}</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Issue the following sequence of commands to set
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.chainingAllowed" title="local.system.replset.settings.chainingAllowed"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">chainingAllowed</span></code></a> to
<code class="docutils literal"><span class="pre">false</span></code>:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">chainingAllowed</span> <span class="o">=</span> <span class="kc">false</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
</li>
</ol>
<p>To re-enable chained replication, set
<a class="reference internal" href="../reference/replica-configuration.html#local.system.replset.settings.chainingAllowed" title="local.system.replset.settings.chainingAllowed"><code class="xref mongodb mongodb-data docutils literal"><span class="pre">chainingAllowed</span></code></a> to <code class="docutils literal"><span class="pre">true</span></code>.
You can use the following sequence of commands:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">cfg</span> <span class="o">=</span> <span class="nx">rs</span><span class="p">.</span><span class="nx">config</span><span class="p">()</span>
<span class="nx">cfg</span><span class="p">.</span><span class="nx">settings</span><span class="p">.</span><span class="nx">chainingAllowed</span> <span class="o">=</span> <span class="kc">true</span>
<span class="nx">rs</span><span class="p">.</span><span class="nx">reconfig</span><span class="p">(</span><span class="nx">cfg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If chained replication is disabled, you still can use
<a class="reference internal" href="../reference/replica-commands.html#dbcmd.replSetSyncFrom" title="replSetSyncFrom"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">replSetSyncFrom</span></code></a> to specify that a secondary replicates
from another secondary. But that configuration will last only until the
secondary recalculates which member to sync from.</p>
</div>
</div>
<div class="section" id="changing-oplog-size">
<span id="replica-set-procedure-change-oplog-size"></span><h3>Changing Oplog Size<a class="headerlink" href="#changing-oplog-size" title="Permalink to this headline">&para;</a></h3>
<p>The following is an overview of the procedure for changing the size of
the oplog. For a detailed procedure, see
<a class="reference internal" href="../tutorial/change-oplog-size.html"><span class="doc">Change the Size of the Oplog</span></a>.</p>
<ol class="arabic simple">
<li>Shut down the current <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> instance in the
<a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> and then restart it on a different port
and in &ldquo;standalone&rdquo; mode.</li>
<li>Create a backup of the old (current) oplog. This is optional.</li>
<li>Save the last entry from the old oplog.</li>
<li>Drop the old oplog.</li>
<li>Create a new oplog of a different size.</li>
<li>Insert the previously saved last entry from the old oplog into the
new oplog.</li>
<li>Restart the server as a member of the replica set on its usual
port.</li>
<li>Apply this procedure to any other member of the replica set that
<em>could become</em> primary.</li>
</ol>
</div>
<div class="section" id="resyncing-a-member-of-a-replica-set">
<span id="replica-set-resync-stale-member"></span><h3>Resyncing a Member of a Replica Set<a class="headerlink" href="#resyncing-a-member-of-a-replica-set" title="Permalink to this headline">&para;</a></h3>
<p>When a secondary&rsquo;s replication process falls behind so far that
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> overwrites oplog entries that the secondary has not
yet replicated, that secondary cannot catch up and becomes &ldquo;stale.&rdquo;
When that occurs, you must completely resynchronize the member by removing its data and
performing an initial sync.</p>
<p>To do so, use one of the following approaches:</p>
<ul>
<li><p class="first">Restart the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> with an empty data directory and let
MongoDB&rsquo;s normal initial syncing feature restore the data. This
is the more simple option, but may take longer to replace the data.</p>
<p>See <a class="reference internal" href="#replica-set-auto-resync-stale-member"><span class="std std-ref">Automatically Resync a Stale Member</span></a>.</p>
</li>
<li><p class="first">Restart the machine with a copy of a recent data directory from
another member in the <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>. This procedure can replace
the data more quickly but requires more manual steps.</p>
<p>See <a class="reference internal" href="#replica-set-resync-by-copying"><span class="std std-ref">Resync by Copying All Datafiles from Another Member</span></a>.</p>
</li>
</ul>
<div class="section" id="automatically-resync-a-stale-member">
<span id="replica-set-auto-resync-stale-member"></span><span id="index-5"></span><h4>Automatically Resync a Stale Member<a class="headerlink" href="#automatically-resync-a-stale-member" title="Permalink to this headline">&para;</a></h4>
<p>This procedure relies on MongoDB&rsquo;s regular process for initial
sync. This will restore the data on the stale member to reflect the
current state of the set. For an overview of MongoDB initial sync
process, see the <a class="reference internal" href="../core/replication-internals.html#replica-set-syncing"><span class="std std-ref">Syncing</span></a> section.</p>
<p>To resync the stale member:</p>
<ol class="arabic">
<li><p class="first">Stop the stale member&rsquo;s <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance. On Linux
systems you can use <a class="reference internal" href="../reference/mongod.html#cmdoption-mongod-shutdown"><code class="xref std std-option docutils literal"><span class="pre">mongod</span> <span class="pre">--shutdown</span></code></a> Set
<a class="reference internal" href="../reference/mongod.html#cmdoption-mongod-dbpath"><code class="xref std std-option docutils literal"><span class="pre">--dbpath</span></code></a> to the member&rsquo;s data
directory, as in the following:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-sh"><div class="highlight"><pre><span></span>mongod --dbpath /data/db/ --shutdown
</pre></div>
</div>
</div>
</li>
<li><p class="first">Delete all data and sub-directories from the member&rsquo;s data
directory.  By removing the data <a class="reference internal" href="../reference/configuration-options.html#dbpath" title="dbpath"><code class="xref mongodb mongodb-setting docutils literal"><span class="pre">dbpath</span></code></a>, MongoDB will
perform a complete resync. Consider making a backup first.</p>
</li>
<li><p class="first">Restart the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance on the member.  For example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-sh"><div class="highlight"><pre><span></span>mongod --dbpath /data/db/ --replSet rsProduction
</pre></div>
</div>
</div>
<p>At this point, the <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> will perform an initial
sync. The length of the initial sync may process depends on the
size of the database and network connection between members of the
replica set.</p>
<p>Initial sync operations can impact the other members of the set and
create additional traffic to the primary, and can only occur if
another member of the set is accessible and up to date.</p>
</li>
</ol>
</div>
<div class="section" id="resync-by-copying-all-datafiles-from-another-member">
<span id="replica-set-resync-by-copying"></span><span id="index-6"></span><h4>Resync by Copying All Datafiles from Another Member<a class="headerlink" href="#resync-by-copying-all-datafiles-from-another-member" title="Permalink to this headline">&para;</a></h4>
<p>This approach uses a copy of the data files from an existing member of
the replica set, or a back of the data files to &ldquo;seed&rdquo; the stale member.</p>
<p>The copy or backup of the data files <strong>must</strong> be sufficiently recent
to allow the new member to catch up with the <a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a>, otherwise
the member would need to perform an initial sync.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In most cases you cannot copy data files from a running
<a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance to another, because the data files will
change during the file copy operation. Consider the
<a class="reference internal" href="backups.html"><span class="doc">Backup Strategies for MongoDB Systems</span></a> documentation for several methods
that you can use to capture a consistent snapshot of a running
<a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance.</p>
</div>
<p>After you have copied the data files from the &ldquo;seed&rdquo; source, start the
<a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instance and allow it to apply all operations from
the oplog until it reflects the current state of the replica set.</p>
</div>
</div>
</div>
<div class="section" id="security-considerations-for-replica-sets">
<span id="replica-set-security"></span><h2>Security Considerations for Replica Sets<a class="headerlink" href="#security-considerations-for-replica-sets" title="Permalink to this headline">&para;</a></h2>
<p>In most cases, the most effective ways to control access and to secure
the connection between members of a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> depend on
network-level access control. Use your environment&rsquo;s firewall and
network routing to ensure that traffic <em>only</em> from clients and other
replica set members can reach your <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> instances. If needed,
use virtual private networks (VPNs) to ensure secure connections
over wide area networks (WANs.)</p>
<p>Additionally, MongoDB provides an authentication mechanism for
<a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> and <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a> instances connecting to
replica sets. These instances enable authentication but specify a
shared key file that serves as a shared password.</p>
<div class="versionadded">
<p><span class="versionmodified">New in version 1.8: </span>Added support authentication in replica set deployments.</p>
</div>
<div class="versionchanged">
<p><span class="versionmodified">Changed in version 1.9.1: </span>Added support authentication in sharded replica set deployments.</p>
</div>
<p>To enable authentication add the following option to your configuration file:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-cfg"><div class="highlight"><pre><span></span><span class="na">keyFile</span> <span class="o">=</span> <span class="s">/srv/mongodb/keyfile</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You may chose to set these run-time configuration options using the
<a class="reference internal" href="../reference/mongod.html#cmdoption-mongod-keyfile"><code class="xref std std-option docutils literal"><span class="pre">--keyFile</span></code></a> (or <a class="reference internal" href="../reference/mongos.html#cmdoption-mongos-keyfile"><code class="xref std std-option docutils literal"><span class="pre">mongos</span> <span class="pre">--keyFile</span></code></a>)
options on the command line.</p>
</div>
<p>Setting <a class="reference internal" href="../reference/configuration-options.html#keyFile" title="keyFile"><code class="xref mongodb mongodb-setting docutils literal"><span class="pre">keyFile</span></code></a> enables authentication and specifies a key
file for the replica set members to use when authenticating to each
other. The content of the key file is arbitrary but must be the same
on all members of the replica set and on all <a class="reference internal" href="../reference/mongos.html#bin.mongos" title="bin.mongos"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongos</span></code></a>
instances that connect to the set.</p>
<p>The key file must be less one kilobyte in size and may only contain
characters in the base64 set. The key file must not have group or &ldquo;world&rdquo;
permissions on UNIX systems. Use the following command to use the
OpenSSL package to generate &ldquo;random&rdquo; content for use in a key file:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-bash"><div class="highlight"><pre><span></span>openssl rand -base64 <span class="m">753</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Key file permissions are not checked on Windows systems.</p>
</div>
</div>
<div class="section" id="troubleshooting-replica-sets">
<span id="replica-set-troubleshooting"></span><h2>Troubleshooting Replica Sets<a class="headerlink" href="#troubleshooting-replica-sets" title="Permalink to this headline">&para;</a></h2>
<p>This section describes common strategies for troubleshooting
<a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica sets</span></a>.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="monitoring.html"><span class="doc">Monitoring Database Systems</span></a>.</p>
</div>
<div class="section" id="check-replica-set-status">
<span id="replica-set-troubleshooting-check-replication-status"></span><h3>Check Replica Set Status<a class="headerlink" href="#check-replica-set-status" title="Permalink to this headline">&para;</a></h3>
<p>To display the current state of the replica set and current state of
each member, run the <a class="reference internal" href="../reference/replica-commands.html#rs.status" title="rs.status()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.status()</span></code></a> method in a <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a>
shell connected to the replica set&rsquo;s <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>. For descriptions
of the information displayed by <a class="reference internal" href="../reference/replica-commands.html#rs.status" title="rs.status()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.status()</span></code></a>, see
<a class="reference internal" href="../reference/replica-status.html"><span class="doc">Replica Set Status Reference</span></a>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="../reference/replica-commands.html#rs.status" title="rs.status()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.status()</span></code></a> method is a wrapper that runs the
<a class="reference internal" href="../reference/replica-commands.html#dbcmd.replSetGetStatus" title="replSetGetStatus"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">replSetGetStatus</span></code></a> database command.</p>
</div>
</div>
<div class="section" id="check-the-replication-lag">
<span id="replica-set-replication-lag"></span><h3>Check the Replication Lag<a class="headerlink" href="#check-the-replication-lag" title="Permalink to this headline">&para;</a></h3>
<p>Replication lag is a delay between an operation on the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>
and the application of that operation from the <a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a> to the
<a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a>. Replication lag can be a significant issue and can
seriously affect MongoDB <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> deployments. Excessive
replication lag makes &ldquo;lagged&rdquo; members ineligible to quickly become
primary and increases the possibility that distributed
read operations will be inconsistent.</p>
<p>To check the current length of replication lag:</p>
<ul>
<li><p class="first">In a <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell connected to the primary, call the
<a class="reference internal" href="../reference/method/db.printSlaveReplicationInfo.html#db.printSlaveReplicationInfo" title="db.printSlaveReplicationInfo()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.printSlaveReplicationInfo()</span></code></a> method.</p>
<p>The returned document displays the <code class="docutils literal"><span class="pre">syncedTo</span></code> value for each member,
which shows you when each member last read from the oplog, as shown in the following
example:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">source</span><span class="o">:</span>   <span class="nx">m1</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">net</span><span class="o">:</span><span class="mi">30001</span>
    <span class="nx">syncedTo</span><span class="o">:</span> <span class="nx">Tue</span> <span class="nx">Oct</span> <span class="mi">02</span> <span class="mi">2012</span> <span class="mi">11</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="mi">40</span> <span class="nx">GMT</span><span class="o">-</span><span class="mi">0400</span> <span class="p">(</span><span class="nx">EDT</span><span class="p">)</span>
        <span class="o">=</span> <span class="mi">7475</span> <span class="nx">secs</span> <span class="nx">ago</span> <span class="p">(</span><span class="mf">2.08</span><span class="nx">hrs</span><span class="p">)</span>
<span class="nx">source</span><span class="o">:</span>   <span class="nx">m2</span><span class="p">.</span><span class="nx">example</span><span class="p">.</span><span class="nx">net</span><span class="o">:</span><span class="mi">30002</span>
    <span class="nx">syncedTo</span><span class="o">:</span> <span class="nx">Tue</span> <span class="nx">Oct</span> <span class="mi">02</span> <span class="mi">2012</span> <span class="mi">11</span><span class="o">:</span><span class="mi">33</span><span class="o">:</span><span class="mi">40</span> <span class="nx">GMT</span><span class="o">-</span><span class="mi">0400</span> <span class="p">(</span><span class="nx">EDT</span><span class="p">)</span>
        <span class="o">=</span> <span class="mi">7475</span> <span class="nx">secs</span> <span class="nx">ago</span> <span class="p">(</span><span class="mf">2.08</span><span class="nx">hrs</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The <a class="reference internal" href="../reference/replica-commands.html#rs.status" title="rs.status()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">rs.status()</span></code></a> method is a wrapper around the
<a class="reference internal" href="../reference/replica-commands.html#dbcmd.replSetGetStatus" title="replSetGetStatus"><code class="xref mongodb mongodb-dbcommand docutils literal"><span class="pre">replSetGetStatus</span></code></a> database command.</p>
</div>
</li>
<li><p class="first">Monitor the rate of replication by watching the oplog time in the
&ldquo;replica&rdquo; graph in the <a class="reference external" href="http://mms.mongodb.com/">MongoDB Monitoring Service</a>. For more
information see the <a class="reference external" href="http://mms.mongodb.com/help/">documentation for MMS</a>.</p>
</li>
</ul>
<p>Possible causes of replication lag include:</p>
<ul>
<li><p class="first"><strong>Network Latency</strong></p>
<p>Check the network routes between the members of your set to ensure
that there is no packet loss or network routing issue.</p>
<p>Use tools including <code class="docutils literal"><span class="pre">ping</span></code> to test latency between set
members and <code class="docutils literal"><span class="pre">traceroute</span></code> to expose the routing of packets
network endpoints.</p>
</li>
<li><p class="first"><strong>Disk Throughput</strong></p>
<p>If the file system and disk device on the secondary is
unable to flush data to disk as quickly as the primary, then
the secondary will have difficulty keeping state. Disk-related
issues are incredibly prevalent on multi-tenant systems, including
vitalized instances, and can be transient if the system accesses
disk devices over an IP network (as is the case with Amazon&rsquo;s
EBS system.)</p>
<p>Use system-level tools to assess disk status, including
<code class="docutils literal"><span class="pre">iostat</span></code> or <code class="docutils literal"><span class="pre">vmstat</span></code>.</p>
</li>
<li><p class="first"><strong>Concurrency</strong></p>
<p>In some cases, long-running operations on the primary can block
replication on secondaries. For best results, configure <a class="reference internal" href="../core/write-operations.html#write-concern"><span class="std std-ref">write concern</span></a>
to require confirmation of replication to secondaries, as described in <a class="reference internal" href="../applications/replication.html#replica-set-write-concern"><span class="std std-ref">Write Concern</span></a>.
This prevents write operations from returning if replication cannot keep up
with the write load.</p>
<p>Use the <a class="reference internal" href="../reference/glossary.html#term-database-profiler"><span class="xref std std-term">database profiler</span></a> to see if there are slow queries
or long-running operations that correspond to the incidences of lag.</p>
</li>
<li><p class="first"><strong>Appropriate Write Concern</strong></p>
<p>If you are performing a large data ingestion or bulk load operation
that requires a large number of writes to the primary, particularly
with <a class="reference internal" href="../core/write-operations.html#write-concern-considerations"><span class="std std-ref">unacknowledged write concern</span></a>, the
secondaries will not be able to read the oplog fast enough to keep
up with changes.</p>
<p>To prevent this, require <a class="reference internal" href="../core/write-operations.html#write-concern-considerations"><span class="std std-ref">write acknowledgment or journaled
write concern</span></a> after every 100,
1,000, or an another interval to provide an opportunity for
secondaries to catch up with the primary.</p>
<p>For more information see:</p>
<ul class="simple">
<li><a class="reference internal" href="../applications/replication.html#replica-set-write-concern"><span class="std std-ref">Write Concern</span></a></li>
<li><a class="reference internal" href="../core/replication.html#replica-set-oplog-sizing"><span class="std std-ref">Oplog</span></a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="test-connections-between-all-members">
<span id="replica-set-troubleshooting-check-connection"></span><h3>Test Connections Between all Members<a class="headerlink" href="#test-connections-between-all-members" title="Permalink to this headline">&para;</a></h3>
<p>All members of a <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> must be able to connect to every
other member of the set to support replication. Always verify
connections in both &ldquo;directions.&rdquo;  Networking topologies and firewall
configurations prevent normal and required connectivity, which can
block replication.</p>
<p>Consider the following example of a bidirectional test of networking:</p>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p>Given a replica set with three members running on three separate
hosts:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">m1.example.net</span></code></li>
<li><code class="docutils literal"><span class="pre">m2.example.net</span></code></li>
<li><code class="docutils literal"><span class="pre">m3.example.net</span></code></li>
</ul>
<ol class="arabic">
<li><p class="first">Test the connection from <code class="docutils literal"><span class="pre">m1.example.net</span></code> to the other hosts
with the following operation set <code class="docutils literal"><span class="pre">m1.example.net</span></code>:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-sh"><div class="highlight"><pre><span></span>mongo --host m2.example.net --port <span class="m">27017</span>

mongo --host m3.example.net --port <span class="m">27017</span>
</pre></div>
</div>
</div>
</li>
<li><p class="first">Test the connection from <code class="docutils literal"><span class="pre">m2.example.net</span></code> to the other two
hosts with the following operation set from <code class="docutils literal"><span class="pre">m2.example.net</span></code>,
as in:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-sh"><div class="highlight"><pre><span></span>mongo --host m1.example.net --port <span class="m">27017</span>

mongo --host m3.example.net --port <span class="m">27017</span>
</pre></div>
</div>
</div>
<p>You have now tested the connection between
<code class="docutils literal"><span class="pre">m2.example.net</span></code> and <code class="docutils literal"><span class="pre">m1.example.net</span></code> in both directions.</p>
</li>
<li><p class="first">Test the connection from <code class="docutils literal"><span class="pre">m3.example.net</span></code> to the other two
hosts with the following operation set from the
<code class="docutils literal"><span class="pre">m3.example.net</span></code> host, as in:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-sh"><div class="highlight"><pre><span></span>mongo --host m1.example.net --port <span class="m">27017</span>

mongo --host m2.example.net --port <span class="m">27017</span>
</pre></div>
</div>
</div>
</li>
</ol>
<p class="last">If any connection, in any direction fails, check your networking
and firewall configuration and reconfigure your environment to
allow these connections.</p>
</div>
</div>
<div class="section" id="check-the-size-of-the-oplog">
<span id="replica-set-troubleshooting-check-oplog-size"></span><h3>Check the Size of the Oplog<a class="headerlink" href="#check-the-size-of-the-oplog" title="Permalink to this headline">&para;</a></h3>
<p>A larger <a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a> can give a replica set a greater tolerance for
lag, and make the set more resilient.</p>
<p>To check the size of the oplog for a given <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a> member,
connect to the member in a <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell and run the
<a class="reference internal" href="../reference/method/db.printReplicationInfo.html#db.printReplicationInfo" title="db.printReplicationInfo()"><code class="xref mongodb mongodb-method docutils literal"><span class="pre">db.printReplicationInfo()</span></code></a> method.</p>
<p>The output displays the size of the oplog and the date ranges of the
operations contained in the oplog. In the following example, the oplog
is about 10MB and is able to fit about 26 hours (94400 seconds) of
operations:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">configured</span> <span class="nx">oplog</span> <span class="nx">size</span><span class="o">:</span>   <span class="mf">10.10546875</span><span class="nx">MB</span>
<span class="nx">log</span> <span class="nx">length</span> <span class="nx">start</span> <span class="nx">to</span> <span class="nx">end</span><span class="o">:</span> <span class="mi">94400</span> <span class="p">(</span><span class="mf">26.22</span><span class="nx">hrs</span><span class="p">)</span>
<span class="nx">oplog</span> <span class="nx">first</span> <span class="nx">event</span> <span class="nx">time</span><span class="o">:</span>  <span class="nx">Mon</span> <span class="nx">Mar</span> <span class="mi">19</span> <span class="mi">2012</span> <span class="mi">13</span><span class="o">:</span><span class="mi">50</span><span class="o">:</span><span class="mi">38</span> <span class="nx">GMT</span><span class="o">-</span><span class="mi">0400</span> <span class="p">(</span><span class="nx">EDT</span><span class="p">)</span>
<span class="nx">oplog</span> <span class="nx">last</span> <span class="nx">event</span> <span class="nx">time</span><span class="o">:</span>   <span class="nx">Wed</span> <span class="nx">Oct</span> <span class="mi">03</span> <span class="mi">2012</span> <span class="mi">14</span><span class="o">:</span><span class="mi">59</span><span class="o">:</span><span class="mi">10</span> <span class="nx">GMT</span><span class="o">-</span><span class="mi">0400</span> <span class="p">(</span><span class="nx">EDT</span><span class="p">)</span>
<span class="nx">now</span><span class="o">:</span>                     <span class="nx">Wed</span> <span class="nx">Oct</span> <span class="mi">03</span> <span class="mi">2012</span> <span class="mi">15</span><span class="o">:</span><span class="mi">00</span><span class="o">:</span><span class="mi">21</span> <span class="nx">GMT</span><span class="o">-</span><span class="mi">0400</span> <span class="p">(</span><span class="nx">EDT</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The oplog should be long enough to hold all transactions for the
longest downtime you expect on a secondary. At a minimum, an oplog
should be able to hold minimum 24 hours of operations; however, many
users prefer to have 72 hours or even a week&rsquo;s work of operations.</p>
<p>For more information on how oplog size affects operations, see:</p>
<ul class="simple">
<li>The <a class="reference internal" href="../core/replication.html#replica-set-oplog-sizing"><span class="std std-ref">Oplog</span></a> topic in the <a class="reference internal" href="../core/replication.html"><span class="doc">Replica Set Fundamental Concepts</span></a> document.</li>
<li>The <a class="reference internal" href="#replica-set-delayed-members"><span class="std std-ref">Delayed Members</span></a> topic in this document.</li>
<li>The <a class="reference internal" href="#replica-set-replication-lag"><span class="std std-ref">Check the Replication Lag</span></a> topic in this document.</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">You normally want the oplog to be the same size on all
members. If you resize the oplog, resize it on all members.</p>
</div>
<p>To change oplog size, see <a class="reference internal" href="#replica-set-procedure-change-oplog-size"><span class="std std-ref">Changing Oplog Size</span></a>
in this document or see the <a class="reference internal" href="../tutorial/change-oplog-size.html"><span class="doc">Change the Size of the Oplog</span></a> tutorial.</p>
</div>
<div class="section" id="failover-and-recovery">
<span id="failover"></span><span id="replica-set-failover"></span><span id="index-7"></span><h3>Failover and Recovery<a class="headerlink" href="#failover-and-recovery" title="Permalink to this headline">&para;</a></h3>
<p>Replica sets feature automated failover. If the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a>
goes offline or becomes unresponsive and a majority of the original
set members can still connect to each other, the set will elect a new
primary.</p>
<p>While <a class="reference internal" href="../reference/glossary.html#term-failover"><span class="xref std std-term">failover</span></a> is automatic, <a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>
administrators should still understand exactly how this process
works. This section below describe failover in detail.</p>
<p>In most cases, failover occurs without administrator intervention
seconds after the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> either steps down, becomes inaccessible,
or becomes otherwise ineligible to act as primary. If your MongoDB deployment
does not failover according to expectations, consider the following
operational errors:</p>
<ul class="simple">
<li>No remaining member is able to form a majority. This can happen as a
result of network partitions that render some members
inaccessible. Design your deployment to ensure that a majority of
set members can elect a primary in the same facility as core
application systems.</li>
<li>No member is eligible to become primary. Members must have a
<code class="xref mongodb mongodb-data docutils literal"><span class="pre">priority</span></code> setting greater than <code class="docutils literal"><span class="pre">0</span></code>, have a state
that is less than ten seconds behind the last operation to the
<a class="reference internal" href="../reference/glossary.html#term-replica-set"><span class="xref std std-term">replica set</span></a>, and generally be <em>more</em> up to date than the
voting members.</li>
</ul>
<p>In many senses, <a class="reference internal" href="../core/replication.html#replica-set-rollbacks"><span class="std std-ref">rollbacks</span></a> represent a
graceful recovery from an impossible failover and recovery situation.</p>
<p>Rollbacks occur when
a primary accepts writes that other members of
the set do not successfully replicate before the primary steps
down. When the former primary begins replicating again it performs a
&ldquo;rollback.&rdquo; Rollbacks remove those operations from the instance that
were never replicated to the set so that the data set is in a
consistent state. The <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> program writes rolled back
data to a <a class="reference internal" href="../reference/glossary.html#term-bson"><span class="xref std std-term">BSON</span></a> file that you can view using
<a class="reference internal" href="../reference/bsondump.html#bin.bsondump" title="bin.bsondump"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">bsondump</span></code></a>, applied manually using <a class="reference internal" href="../reference/mongorestore.html#bin.mongorestore" title="bin.mongorestore"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongorestore</span></code></a>.</p>
<p>You can prevent rollbacks using a <a class="reference internal" href="../core/write-operations.html#write-concern-replica-acknowledged"><span class="std std-ref">replica acknowledged</span></a> write concern. These write
operations require not only the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> to acknowledge the
write operation, sometimes even the majority of the set to confirm the
write operation before returning.</p>
<blockquote>
<div>enabling <a class="reference internal" href="../reference/glossary.html#term-write-concern"><span class="xref std std-term">write concern</span></a>.</div></blockquote>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">The <a class="reference internal" href="../core/replication.html#replica-set-elections"><span class="std std-ref">Elections</span></a> section in the
<a class="reference internal" href="../core/replication.html"><span class="doc">Replica Set Fundamental Concepts</span></a> document, and the
<a class="reference internal" href="../core/replication-internals.html#replica-set-election-internals"><span class="std std-ref">Election Internals</span></a> section in the
<a class="reference internal" href="../core/replication-internals.html"><span class="doc">Replica Set Internals and Behaviors</span></a> document.</p>
</div>
</div>
<div class="section" id="oplog-entry-timestamp-error">
<h3>Oplog Entry Timestamp Error<a class="headerlink" href="#oplog-entry-timestamp-error" title="Permalink to this headline">&para;</a></h3>
<p>Consider the following error in <a class="reference internal" href="../reference/mongod.html#bin.mongod" title="bin.mongod"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongod</span></code></a> output and logs:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span>replSet error fatal couldn&#39;t query the local local.oplog.rs collection.  Terminating mongod after 30 seconds.
&lt;timestamp&gt; [rsStart] bad replSet oplog entry?
</pre></div>
</div>
</div>
<p>Often, an incorrectly typed value in the <code class="docutils literal"><span class="pre">ts</span></code> field in the last
<a class="reference internal" href="../reference/glossary.html#term-oplog"><span class="xref std std-term">oplog</span></a> entry causes this error. The correct data type is
Timestamp.</p>
<p>Check the type of the <code class="docutils literal"><span class="pre">ts</span></code> value using the following two queries
against the oplog collection:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span> <span class="o">=</span> <span class="nx">db</span><span class="p">.</span><span class="nx">getSiblingDB</span><span class="p">(</span><span class="s2">&#34;local&#34;</span><span class="p">)</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">oplog</span><span class="p">.</span><span class="nx">rs</span><span class="p">.</span><span class="nx">find</span><span class="p">().</span><span class="nx">sort</span><span class="p">({</span><span class="nx">$natural</span><span class="o">:-</span><span class="mi">1</span><span class="p">}).</span><span class="nx">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">oplog</span><span class="p">.</span><span class="nx">rs</span><span class="p">.</span><span class="nx">find</span><span class="p">({</span><span class="nx">ts</span><span class="o">:</span><span class="p">{</span><span class="nx">$type</span><span class="o">:</span><span class="mi">17</span><span class="p">}}).</span><span class="nx">sort</span><span class="p">({</span><span class="nx">$natural</span><span class="o">:-</span><span class="mi">1</span><span class="p">}).</span><span class="nx">limit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The first query returns the last document in the oplog, while the
second returns the last document in the oplog where the <code class="docutils literal"><span class="pre">ts</span></code> value
is a Timestamp. The <a class="reference internal" href="../reference/operator/query/type.html#op._S_type" title="$type"><code class="xref mongodb mongodb-query docutils literal"><span class="pre">$type</span></code></a> operator allows you to select
<a class="reference internal" href="../reference/glossary.html#term-bson-types"><span class="xref std std-term">BSON type</span></a> 17, is the Timestamp data type.</p>
<p>If the queries don&rsquo;t return the same document, then the last document in
the oplog has the wrong data type in the <code class="docutils literal"><span class="pre">ts</span></code> field.</p>
<div class="admonition-example admonition">
<p class="first admonition-title">Example</p>
<p>If the first query returns this as the last oplog entry:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;ts&#34;</span> <span class="o">:</span> <span class="p">{</span><span class="nx">t</span><span class="o">:</span> <span class="mi">1347982456000</span><span class="p">,</span> <span class="nx">i</span><span class="o">:</span> <span class="mi">1</span><span class="p">},</span>
  <span class="s2">&#34;h&#34;</span> <span class="o">:</span> <span class="nx">NumberLong</span><span class="p">(</span><span class="s2">&#34;8191276672478122996&#34;</span><span class="p">),</span>
  <span class="s2">&#34;op&#34;</span> <span class="o">:</span> <span class="s2">&#34;n&#34;</span><span class="p">,</span>
  <span class="s2">&#34;ns&#34;</span> <span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
  <span class="s2">&#34;o&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="s2">&#34;msg&#34;</span> <span class="o">:</span> <span class="s2">&#34;Reconfig set&#34;</span><span class="p">,</span> <span class="s2">&#34;version&#34;</span> <span class="o">:</span> <span class="mi">4</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p>And the second query returns this as the last entry where <code class="docutils literal"><span class="pre">ts</span></code>
has the <code class="docutils literal"><span class="pre">Timestamp</span></code> type:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="p">{</span> <span class="s2">&#34;ts&#34;</span> <span class="o">:</span> <span class="nx">Timestamp</span><span class="p">(</span><span class="mi">1347982454000</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span>
  <span class="s2">&#34;h&#34;</span> <span class="o">:</span> <span class="nx">NumberLong</span><span class="p">(</span><span class="s2">&#34;6188469075153256465&#34;</span><span class="p">),</span>
  <span class="s2">&#34;op&#34;</span> <span class="o">:</span> <span class="s2">&#34;n&#34;</span><span class="p">,</span>
  <span class="s2">&#34;ns&#34;</span> <span class="o">:</span> <span class="s2">&#34;&#34;</span><span class="p">,</span>
  <span class="s2">&#34;o&#34;</span> <span class="o">:</span> <span class="p">{</span> <span class="s2">&#34;msg&#34;</span> <span class="o">:</span> <span class="s2">&#34;Reconfig set&#34;</span><span class="p">,</span> <span class="s2">&#34;version&#34;</span> <span class="o">:</span> <span class="mi">3</span> <span class="p">}</span> <span class="p">}</span>
</pre></div>
</div>
</div>
<p class="last">Then the value for the <code class="docutils literal"><span class="pre">ts</span></code> field in the last oplog entry is of the
wrong data type.</p>
</div>
<p>To set the proper type for this value and resolve this issue,
use an update operation that resembles the following:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">db</span><span class="p">.</span><span class="nx">oplog</span><span class="p">.</span><span class="nx">rs</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span> <span class="p">{</span> <span class="nx">ts</span><span class="o">:</span> <span class="p">{</span> <span class="nx">t</span><span class="o">:</span><span class="mi">1347982456000</span><span class="p">,</span> <span class="nx">i</span><span class="o">:</span><span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
                    <span class="p">{</span> <span class="nx">$set</span><span class="o">:</span> <span class="p">{</span> <span class="nx">ts</span><span class="o">:</span> <span class="k">new</span> <span class="nx">Timestamp</span><span class="p">(</span><span class="mi">1347982456000</span><span class="p">,</span> <span class="mi">1</span><span class="p">)}})</span>
</pre></div>
</div>
</div>
<p>Modify the timestamp values as needed based on your oplog entry. This
operation may take some period to complete because the update must
scan and pull the entire oplog into memory.</p>
</div>
<div class="section" id="duplicate-key-error-on-local-slaves">
<h3>Duplicate Key Error on <code class="docutils literal"><span class="pre">local.slaves</span></code><a class="headerlink" href="#duplicate-key-error-on-local-slaves" title="Permalink to this headline">&para;</a></h3>
<p>The <em>duplicate key on local.slaves</em> error, occurs when a
<a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-slave"><span class="xref std std-term">slave</span></a> changes its hostname and the
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-master"><span class="xref std std-term">master</span></a> tries to update its <code class="docutils literal"><span class="pre">local.slaves</span></code>
collection with the new name. The update fails because it contains the
same <code class="docutils literal"><span class="pre">_id</span></code> value as the document containing the previous hostname. The
error itself will resemble the following.</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-none"><div class="highlight"><pre><span></span>exception 11000 E11000 duplicate key error index: local.slaves.$_id_  dup key: { : ObjectId(&#39;&lt;object ID&gt;&#39;) } 0ms
</pre></div>
</div>
</div>
<p>This is a benign error and does not affect replication operations on
the <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-slave"><span class="xref std std-term">slave</span></a>.</p>
<p>To prevent the error from appearing, drop the <code class="docutils literal"><span class="pre">local.slaves</span></code>
collection from the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-master"><span class="xref std std-term">master</span></a>, with the
following sequence of operations in the <a class="reference internal" href="../reference/mongo.html#bin.mongo" title="bin.mongo"><code class="xref mongodb mongodb-binary docutils literal"><span class="pre">mongo</span></code></a> shell:</p>
<div class="button-code-block">
<div class="button-row">
<a class="code-button--copy code-button" role="button">
copy</a>
</div>
<div class="copyable-code-block highlight-javascript"><div class="highlight"><pre><span></span><span class="nx">use</span> <span class="nx">local</span>
<span class="nx">db</span><span class="p">.</span><span class="nx">slaves</span><span class="p">.</span><span class="nx">drop</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The next time a <a class="reference internal" href="../reference/glossary.html#term-secondary"><span class="xref std std-term">secondary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-slave"><span class="xref std std-term">slave</span></a> polls the
<a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-master"><span class="xref std std-term">master</span></a>, the <a class="reference internal" href="../reference/glossary.html#term-primary"><span class="xref std std-term">primary</span></a> or <a class="reference internal" href="../reference/glossary.html#term-master"><span class="xref std std-term">master</span></a>
recreates the <code class="docutils literal"><span class="pre">local.slaves</span></code> collection.</p>
<span class="target" id="index-9"></span></div>
<div class="section" id="elections-and-network-partitions">
<span id="replica-set-elections-and-network-partitions"></span><span id="index-10"></span><h3>Elections and Network Partitions<a class="headerlink" href="#elections-and-network-partitions" title="Permalink to this headline">&para;</a></h3>
<p>Members on either side of a network partition cannot see each other when
determining whether a majority is available to hold an election.</p>
<p>That means that if a primary steps down and neither side of the
partition has a majority on its own, the set will not elect a new
primary and the set will become read only.</p>
<div class="admonition-see admonition">
<p class="first admonition-title">See</p>
<p class="last"><a class="reference internal" href="../core/replication-internals.html#replica-set-election-internals"><span class="std std-ref">Election Internals</span></a>.</p>
</div>
</div>
</div>
</div>

                
    <div id="btnv">
      <span class="btn-arrow-left">&larr; &nbsp;</span>
      <a class="btn-prev-text" href="../core/replication.html" title="Previous Section: Replica Set Fundamental Concepts"><span>Replica Set Fundamental Concepts</span></a>
      <a class="btn-next-text" href="replica-set-architectures.html" title="Next Section: Replica Set Architectures and Deployment Patterns"><span>Replica Set Architectures and Deployment Patterns</span></a>
      <span class="btn-arrow-right">&nbsp;&rarr;</span>
    </div>
                  <div class="footer">
                    <div class="copyright">
                      <p>&copy; MongoDB, Inc 2008-present. MongoDB, Mongo, and the leaf logo are registered trademarks of MongoDB, Inc.</p>
                    </div>
                  </div>
              </div></div>
            </div>
        </div>
    </div>
    <div class="right-column">
      <div class="wrapper"> <div id="mongodb-docs-1">
   <script type="text/javascript">
      googletag.cmd.push(function() { googletag.display('mongodb-docs-1'); });
   </script>
</div>
            <div class="social">
               <a class="slack-icon" href="https://slackpass.io/mongo-db?jmp=docs" title="https://slackpass.io/mongo-db?jmp=docs"><i class="fab fa-slack" aria-hidden="true"></i></a>
               <a class="twitter-icon" href="https://twitter.com/MongoDB" title="https://twitter.com/MongoDB"><i class="fab fa-twitter-square"></i></a>
               <a class="youtube-icon" href="https://www.youtube.com/user/MongoDB" title="https://www.youtube.com/user/MongoDB"><i class="fab fa-youtube-square"></i></a>
               <a class="facebook-icon" href="https://www.facebook.com/mongodb" title="https://www.facebook.com/mongodb"><i class="fab fa-facebook-square"></i></a>
               <a class="stack-overflow-icon" href="https://stackoverflow.com/tags/mongodb/info" title="https://stackoverflow.com/tags/mongodb/info"><i class="fab fa-stack-overflow" aria-hidden="true"></i></a>
            </div>
        

      </div>
    </div>
    
      <div id="rating-panel"></div>
    
    <div class="clearfix"></div>
  </div>
<div id="navbar" data-navprops="{&#34;links&#34;: [{&#34;url&#34;: &#34;https://www.mongodb.com/docs/manual/&#34;,&#34;text&#34;: &#34;Server&#34;,&#34;active&#34;: true},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/drivers/&#34;,&#34;text&#34;: &#34;Drivers&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/cloud/&#34;,&#34;text&#34;: &#34;Cloud&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/tools/&#34;,&#34;text&#34;: &#34;Tools&#34;},{&#34;url&#34;: &#34;https://www.mongodb.com/docs/guides/&#34;,&#34;text&#34;: &#34;Guides&#34;}], &#34;baseUrl&#34;: &#34;https://www.mongodb.com/docs&#34;}"></div>

  

  

  <script type="text/javascript">
  // Bootstrap array of links that should trigger a full page reload
  window.docsExcludedNav = [];
  </script>
</body></html>